XILINX_LOC=/proj/xbuilds/2024.2_INT_daily_latest/installs/lin64/Vitis/2024.2
SHELL=/bin/csh
MYXILINX_VER=2024.2
HISTCONTROL=ignoreboth:erasedups
TERM_PROGRAM_VERSION=3.4
GROUP=newhiredefaultgrp
MACHTYPE=x86_64
TMUX=/tmp/tmux-50093633/default,4103737,0
AIETOOLS_ROOT=/proj/xbuilds/2024.2_INT_daily_latest/installs/lin64/Vitis/2024.2/aietools
XILINX_XRT=/opt/xilinx/xrt
n_aie_cols=8
PWD=/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array
LOGNAME=lromeror
NPU2=1
XDG_SESSION_TYPE=tty
MLIR_AIE_INSTALL_DIR=/scratch/luisr/mlir-aie/install
N=4352
M=4352
K=4352
n=32
m=32
k=32
HOME=/home/lromeror
LANG=en_US.UTF-8
PEANO_INSTALL_DIR=/scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie
VIRTUAL_ENV=/scratch/luisr/mlir-aie/ironenv
OSTYPE=linux
SSH_CONNECTION=172.21.39.59 51040 172.20.10.58 22
XDG_SESSION_CLASS=user
PYTHONPATH=/scratch/luisr/mlir-aie/install/python:/opt/xilinx/xrt/python
TERM=tmux-256color
HOST=xcoradaie213
USER=lromeror
TMUX_PANE=%0
emulate_bfloat16_mmul_with_bfp16=1
SHLVL=2
XDG_SESSION_ID=779
VIRTUAL_ENV_PROMPT=(ironenv) 
LM_LICENSE_FILE=2100@aiengine
LD_LIBRARY_PATH=/scratch/luisr/mlir-aie/install/lib:/opt/xilinx/xrt/lib
XDG_RUNTIME_DIR=/run/user/50093633
MYXILINX_BASE=/proj/xbuilds/2024.2_INT_daily_latest
dtype_out=bf16
PS1=(ironenv) \[\033[0;32m\]\u\[\033[0m\]@\[\033[0;34m\]\h\[\033[0m\]:\[\033[0;35m\]\w\[\033[0m\]$ 
SSH_CLIENT=172.21.39.59 51040 22
NLSPATH=/usr/share/locale/%L/LC_MESSAGES/%N.cat:/usr/share/locale/%l/LC_MESSAGES/%N.cat
VENDOR=unknown
PATH=/scratch/luisr/mlir-aie/install/bin:/scratch/luisr/mlir-aie/ironenv/bin:/opt/xilinx/xrt/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/proj/xbuilds/2024.2_INT_daily_latest/installs/lin64/Vitis/2024.2/aietools/bin:/proj/xbuilds/2024.2_INT_daily_latest/installs/lin64/Vitis/2024.2/bin
dtype_in=bf16
DBUS_SESSION_BUS_ADDRESS=unix:path=/run/user/50093633/bus
SSH_TTY=/dev/pts/6
HOSTTYPE=x86_64-linux
REMOTEHOST=172.21.39.59
OLDPWD=/scratch/luisr/mlir-aie
TERM_PROGRAM=tmux
_=/usr/bin/env
##===- Makefile -----------------------------------------------------------===##
# 
# This file licensed under the Apache License v2.0 with LLVM Exceptions.
# See https://llvm.org/LICENSE.txt for license information.
# SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
#
# Copyright (C) 2025, Advanced Micro Devices, Inc.
# 
##===----------------------------------------------------------------------===##
srcdir := $(shell dirname $(realpath $(firstword $(MAKEFILE_LIST))))
subdir=whole_array
targetname=whole_array


# M, K, N: final GEMM dimensions
M?=512
K?=512
N?=512

# m, k, n: single AIE core GEMM dimensions
m?=32
k?=32
n?=32

n_aie_cols?=4
b_col_maj?=0

kernels=mm_${m}x${k}x${n}
aieargs+=-m $m -k $k -n $n --n-aie-cols ${n_aie_cols} --b-col-maj ${b_col_maj}
runargs+=--b_col_maj ${b_col_maj}
target_suffix=${M}x${K}x${N}_${m}x${k}x${n}_${n_aie_cols}c
use_placed?=0
use_iron?=0

# set this flag to 1 for linear buffer allocation
# else, 0 for bank-aware
use_linear_buf_alloc?=1

ifeq (${use_linear_buf_alloc}, 1)
buffer_aloc_flag=basic-sequential
else
buffer_aloc_flag=bank-aware
endif

ifeq (${use_placed}, 1)
aie_py_src=${targetname}_placed.py
ifeq (${use_iron}, 1)
$(error Cannot specify both placed design and IRON)
endif
endif

ifeq (${use_iron}, 1)
aie_py_src=${targetname}_iron.py
endif

KERNEL_DEFINES=-D${dtype_in}_${dtype_out}_ONLY -DDIM_M=${m} -DDIM_K=${k} -DDIM_N=${n}
ifeq (${b_col_maj}, 1)
	KERNEL_DEFINES+=-DB_COL_MAJ
endif

include ${srcdir}/../makefile-common

build/mm_${m}x${k}x${n}.o: ${kernels_dir}/mm.cc
	mkdir -p ${@D}
	cd ${@D} && ${KERNEL_CC} ${KERNEL_CFLAGS} ${KERNEL_DEFINES} -c $< -o ${@F}
rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 256 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x256x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x256x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x256x256_32x32x32_8c.txt ../build/aie_256x256x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x256x256_32x32x32_8c.xclbin -i build/insts_256x256x256_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 256 -N 256 --b_col_maj 0

Avg NPU matmul time: 2795us.
Avg NPU gflops: 12.0052

Min NPU matmul time: 2795us.
Max NPU gflops: 12.0052

Max NPU matmul time: 2795us.
Min NPU gflops: 12.0052

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 256 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x256x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x256x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x256x1280_32x32x32_8c.txt ../build/aie_256x256x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x256x1280_32x32x32_8c.xclbin -i build/insts_256x256x1280_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 256 -N 1280 --b_col_maj 0

Avg NPU matmul time: 2950us.
Avg NPU gflops: 56.8719

Min NPU matmul time: 2950us.
Max NPU gflops: 56.8719

Max NPU matmul time: 2950us.
Min NPU gflops: 56.8719

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 256 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x256x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x256x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x256x2304_32x32x32_8c.txt ../build/aie_256x256x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x256x2304_32x32x32_8c.xclbin -i build/insts_256x256x2304_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 256 -N 2304 --b_col_maj 0

Avg NPU matmul time: 3024us.
Avg NPU gflops: 99.8644

Min NPU matmul time: 3024us.
Max NPU gflops: 99.8644

Max NPU matmul time: 3024us.
Min NPU gflops: 99.8644

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 256 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x256x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x256x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x256x3328_32x32x32_8c.txt ../build/aie_256x256x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x256x3328_32x32x32_8c.xclbin -i build/insts_256x256x3328_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 256 -N 3328 --b_col_maj 0

Avg NPU matmul time: 3606us.
Avg NPU gflops: 120.967

Min NPU matmul time: 3606us.
Max NPU gflops: 120.967

Max NPU matmul time: 3606us.
Min NPU gflops: 120.967

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 256 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x256x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x256x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x256x4352_32x32x32_8c.txt ../build/aie_256x256x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x256x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x256x4352_32x32x32_8c.xclbin -i build/insts_256x256x4352_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 256 -N 4352 --b_col_maj 0

Avg NPU matmul time: 4566us.
Avg NPU gflops: 124.929

Min NPU matmul time: 4566us.
Max NPU gflops: 124.929

Max NPU matmul time: 4566us.
Min NPU gflops: 124.929

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 1280 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x1280x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x1280x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x1280x256_32x32x32_8c.txt ../build/aie_256x1280x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x1280x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 1280 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x1280x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x1280x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x1280x1280_32x32x32_8c.txt ../build/aie_256x1280x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x1280x1280_32x32x32_8c.xclbin -i build/insts_256x1280x1280_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 1280 -N 1280 --b_col_maj 0

Avg NPU matmul time: 4392us.
Avg NPU gflops: 190.997

Min NPU matmul time: 4392us.
Max NPU gflops: 190.997

Max NPU matmul time: 4392us.
Min NPU gflops: 190.997

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 1280 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x1280x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x1280x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x1280x2304_32x32x32_8c.txt ../build/aie_256x1280x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x1280x2304_32x32x32_8c.xclbin -i build/insts_256x1280x2304_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 1280 -N 2304 --b_col_maj 0

Avg NPU matmul time: 5868us.
Avg NPU gflops: 257.319

Min NPU matmul time: 5868us.
Max NPU gflops: 257.319

Max NPU matmul time: 5868us.
Min NPU gflops: 257.319

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 1280 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x1280x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x1280x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x1280x3328_32x32x32_8c.txt ../build/aie_256x1280x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x1280x3328_32x32x32_8c.xclbin -i build/insts_256x1280x3328_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 1280 -N 3328 --b_col_maj 0


Avg NPU matmul time: 4405us.
Avg NPU gflops: 495.128

Min NPU matmul time: 4405us.
Max NPU gflops: 495.128

Max NPU matmul time: 4405us.
Min NPU gflops: 495.128

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 1280 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x1280x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x1280x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x1280x4352_32x32x32_8c.txt ../build/aie_256x1280x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x1280x4352_32x32x32_8c.xclbin -i build/insts_256x1280x4352_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 1280 -N 4352 --b_col_maj 0


Avg NPU matmul time: 5310us.
Avg NPU gflops: 537.124

Min NPU matmul time: 5310us.
Max NPU gflops: 537.124

Max NPU matmul time: 5310us.
Min NPU gflops: 537.124

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 2304 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x2304x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x2304x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x2304x256_32x32x32_8c.txt ../build/aie_256x2304x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x2304x256_32x32x32_8c.xclbin -i build/insts_256x2304x256_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 2304 -N 256 --b_col_maj 0
[    9,    32] 27075473833984.00 =!= 29961691856896.00
[   14,    82] 41781441855488.00 =!= 46179488366592.00
[   32,    67] 90159953477632.00 =!= 100055558127616.00
[   36,   143] 102254581383168.00 =!= 113799453474816.00
[   38,    32] 108301895335936.00 =!= 119846767427584.00
[   57,   210] 163827232538624.00 =!= 181419418583040.00
[   57,   243] 166026255794176.00 =!= 183618441838592.00
[   58,    82] 167125767421952.00 =!= 184717953466368.00
[   60,   104] 172623325560832.00 =!= 191315023233024.00
[   61,   191] 177021372071936.00 =!= 195713069744128.00
[   62,    32] 175921860444160.00 =!= 194613558116352.00
[   62,   106] 174822348816384.00 =!= 193514046488576.00
[   62,   136] 177021372071936.00 =!= 195713069744128.00
[   66,    49] 186916976721920.00 =!= 206708186021888.00
[   69,    37] 194613558116352.00 =!= 215504279044096.00
[   69,   244] 197912092999680.00 =!= 218802813927424.00
[   73,   143] 205608674394112.00 =!= 228698418577408.00
[   73,   249] 208907209277440.00 =!= 230897441832960.00
[   77,    32] 217703302299648.00 =!= 240793046482944.00
[   78,    32] 218802813927424.00 =!= 244091581366272.00
[  114,    78] 327654465077248.00 =!= 362838837166080.00
[  115,   243] 334251534843904.00 =!= 369435906932736.00
[  116,    58] 334251534843904.00 =!= 369435906932736.00
[  116,    82] 332052511588352.00 =!= 367236883677184.00
[  116,   210] 332052511588352.00 =!= 367236883677184.00
[  116,   241] 327654465077248.00 =!= 362838837166080.00
[  116,   243] 334251534843904.00 =!= 371634930188288.00
[  119,    24] 347445674377216.00 =!= 384829069721600.00
[  121,    12] 354042744143872.00 =!= 391426139488256.00
[  121,   161] 334251534843904.00 =!= 369435906932736.00
[  123,    80] 349644697632768.00 =!= 387028092977152.00
[  123,   103] 349644697632768.00 =!= 387028092977152.00
...and 67 further errors.
Maximum relative error:  10%

Reference:
 2104533975040.00   2130303778816.00   2061584302080.00   2104533975040.00   2070174236672.00   ...  2121713844224.00   2044404432896.00   2095944040448.00   2044404432896.00   2095944040448.00  
 5257039970304.00   5325759447040.00   5153960755200.00   5257039970304.00   5188320493568.00   ...  5291399708672.00   5119601016832.00   5222680231936.00   5119601016832.00   5257039970304.00  
 8418135900160.00   8486855376896.00   8280696946688.00   8383776161792.00   8315056685056.00   ...  8452495638528.00   8211977469952.00   8383776161792.00   8177617731584.00   8383776161792.00  
11544872091648.00  11682311045120.00  11338713661440.00  11544872091648.00  11407433138176.00   ... 11613591568384.00  11269994184704.00  11544872091648.00  11269994184704.00  11544872091648.00  
14705968021504.00  14843406974976.00  14499809591296.00  14705968021504.00  14568529068032.00   ... 14843406974976.00  14362370637824.00  14637248544768.00  14362370637824.00  14705968021504.00  
             ...                ...                ...                ...                ...    ...              ...                ...                ...                ...                ...   
796046418509824.00  800444465020928.00  782852278976512.00  791648371998720.00  787250325487616.00   ... 800444465020928.00  778454232465408.00  791648371998720.00  774056185954304.00  791648371998720.00  
796046418509824.00  804842511532032.00  782852278976512.00  796046418509824.00  787250325487616.00   ... 800444465020928.00  778454232465408.00  791648371998720.00  774056185954304.00  796046418509824.00  
800444465020928.00  809240558043136.00  787250325487616.00  800444465020928.00  791648371998720.00   ... 804842511532032.00  782852278976512.00  800444465020928.00  778454232465408.00  800444465020928.00  
800444465020928.00  809240558043136.00  787250325487616.00  800444465020928.00  791648371998720.00   ... 804842511532032.00  782852278976512.00  800444465020928.00  782852278976512.00  800444465020928.00  
809240558043136.00  813638604554240.00  796046418509824.00  804842511532032.00  800444465020928.00   ... 813638604554240.00  787250325487616.00  804842511532032.00  787250325487616.00  804842511532032.00  

Output:
 1975684956160.00   2010044694528.00   1941325217792.00   1967095021568.00   1958505086976.00   ...  2010044694528.00   1915555414016.00   1975684956160.00   1915555414016.00   1975684956160.00  
 4913442586624.00   4947802324992.00   4810363371520.00   4913442586624.00   4844723109888.00   ...  4982162063360.00   4741643894784.00   4810363371520.00   4776003633152.00   4879082848256.00  
 7834020347904.00   7868380086272.00   7627861917696.00   7730941132800.00   7730941132800.00   ...  7937099563008.00   7627861917696.00   7765300871168.00   7662221656064.00   7799660609536.00  
10651518894080.00  10720238370816.00  10445360463872.00  10720238370816.00  10651518894080.00   ... 10651518894080.00  10514079940608.00  10582799417344.00  10514079940608.00  10720238370816.00  
13537736916992.00  13675175870464.00  13400297963520.00  13606456393728.00  13469017440256.00   ... 13881334300672.00  13331578486784.00  13812614823936.00  13400297963520.00  13606456393728.00  
             ...                ...                ...                ...                ...    ...              ...                ...                ...                ...                ...   
734473767354368.00  738871813865472.00  716881581309952.00  734473767354368.00  734473767354368.00   ... 747667906887680.00  721279627821056.00  721279627821056.00  721279627821056.00  734473767354368.00  
738871813865472.00  743269860376576.00  716881581309952.00  734473767354368.00  738871813865472.00   ... 747667906887680.00  725677674332160.00  721279627821056.00  725677674332160.00  734473767354368.00  
738871813865472.00  743269860376576.00  716881581309952.00  734473767354368.00  738871813865472.00   ... 747667906887680.00  725677674332160.00  721279627821056.00  725677674332160.00  734473767354368.00  
738871813865472.00  743269860376576.00  716881581309952.00  734473767354368.00  738871813865472.00   ... 747667906887680.00  725677674332160.00  721279627821056.00  725677674332160.00  734473767354368.00  
738871813865472.00  743269860376576.00  738871813865472.00  743269860376576.00  738871813865472.00   ... 752065953398784.00  734473767354368.00  743269860376576.00  730075720843264.00  738871813865472.00  

Avg NPU matmul time: 2991.00us.
Avg NPU gflops: 100.97

Min NPU matmul time: 2991.00us.
Max NPU gflops: 100.97

Max NPU matmul time: 2991.00us.
Min NPU gflops: 100.97

Error count: 99


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 2304 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x2304x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x2304x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x2304x1280_32x32x32_8c.txt ../build/aie_256x2304x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x2304x1280_32x32x32_8c.xclbin -i build/insts_256x2304x1280_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 2304 -N 1280 --b_col_maj 0
[    5,  1182] 80814104641536.00 =!= 89610197663744.00
[    7,   387] 109401406963712.00 =!= 120946279055360.00
[   11,   334] 163827232538624.00 =!= 181419418583040.00
[   11,   534] 167125767421952.00 =!= 184717953466368.00
[   11,   926] 164926744166400.00 =!= 182518930210816.00
[   12,   430] 177021372071936.00 =!= 195713069744128.00
[   14,   197] 206708186021888.00 =!= 228698418577408.00
[   14,   250] 212205744160768.00 =!= 235295488344064.00
[   14,   831] 208907209277440.00 =!= 230897441832960.00
[   14,  1238] 207807697649664.00 =!= 229797930205184.00
[   15,   393] 216603790671872.00 =!= 239693534855168.00
[   21,   852] 312261302288384.00 =!= 345246651121664.00
[   23,   990] 334251534843904.00 =!= 369435906932736.00
[   24,    84] 351843720888320.00 =!= 389227116232704.00
[   24,   196] 351843720888320.00 =!= 389227116232704.00
[   25,   995] 362838837166080.00 =!= 402421255766016.00
[   26,   737] 369435906932736.00 =!= 409018325532672.00
[   27,   135] 393625162743808.00 =!= 435406604599296.00
[   27,   721] 393625162743808.00 =!= 435406604599296.00
[   28,     2] 404620279021568.00 =!= 448600744132608.00
[   28,   974] 406819302277120.00 =!= 450799767388160.00
[   29,   509] 406819302277120.00 =!= 450799767388160.00
[   30,    84] 437605627854848.00 =!= 483785116221440.00
[   32,   911] 459595860410368.00 =!= 507974372032512.00
[   43,  1168] 620124558065664.00 =!= 686095255732224.00
[   46,   403] 650910883643392.00 =!= 725677674332160.00
[   46,   409] 668503069687808.00 =!= 738871813865472.00
[   46,   528] 659706976665600.00 =!= 730075720843264.00
[   46,   645] 659706976665600.00 =!= 730075720843264.00
[   48,    69] 708085488287744.00 =!= 782852278976512.00
[   49,     2] 703687441776640.00 =!= 778454232465408.00
[   49,   592] 703687441776640.00 =!= 778454232465408.00
...and 362 further errors.
Maximum relative error:  10%

Reference:
 10514079940608.00   10307921510400.00   10376640987136.00   10788957847552.00   10582799417344.00   ...  10307921510400.00   10582799417344.00   10376640987136.00   10239202033664.00   10582799417344.00  
 26388279066624.00   25838523252736.00   25975962206208.00   26938034880512.00   26525718020096.00   ...  25838523252736.00   26388279066624.00   25975962206208.00   25701084299264.00   26388279066624.00  
 42056319762432.00   41231686041600.00   41781441855488.00   43155831390208.00   42331197669376.00   ...  41506563948544.00   42056319762432.00   41506563948544.00   40956808134656.00   42331197669376.00  
 57999238365184.00   56624848830464.00   57449482551296.00   59373627899904.00   58274116272128.00   ...  56899726737408.00   57999238365184.00   57174604644352.00   56624848830464.00   58274116272128.00  
 73667279060992.00   72018011619328.00   73117523247104.00   75316546502656.00   74217034874880.00   ...  72567767433216.00   73667279060992.00   72567767433216.00   72018011619328.00   74217034874880.00  
              ...                 ...                 ...                 ...                 ...    ...               ...                 ...                 ...                 ...                 ...   
3975834046038016.00  3887873115815936.00  3940649673949184.00  4063794976260096.00  4011018418126848.00   ... 3905465301860352.00  3975834046038016.00  3923057487904768.00  3887873115815936.00  3993426232082432.00  
3993426232082432.00  3905465301860352.00  3940649673949184.00  4081387162304512.00  4028610604171264.00   ... 3923057487904768.00  3993426232082432.00  3940649673949184.00  3887873115815936.00  3993426232082432.00  
4011018418126848.00  3923057487904768.00  3975834046038016.00  4098979348348928.00  4046202790215680.00   ... 3940649673949184.00  4011018418126848.00  3958241859993600.00  3923057487904768.00  4028610604171264.00  
4011018418126848.00  3923057487904768.00  3975834046038016.00  4116571534393344.00  4046202790215680.00   ... 3940649673949184.00  4011018418126848.00  3958241859993600.00  3923057487904768.00  4028610604171264.00  
4046202790215680.00  3958241859993600.00  4011018418126848.00  4134163720437760.00  4081387162304512.00   ... 3975834046038016.00  4046202790215680.00  3993426232082432.00  3940649673949184.00  4063794976260096.00  

Output:
  9895604649984.00    9758165696512.00    9689446219776.00   10239202033664.00    9964324126720.00   ...   9758165696512.00    9826885173248.00    9758165696512.00    9620726743040.00    9826885173248.00  
 24464133718016.00   24051816857600.00   24326694764544.00   25013889531904.00   24739011624960.00   ...  23776938950656.00   24601572671488.00   24051816857600.00   24051816857600.00   24876450578432.00  
 39032662786048.00   38208029065216.00   38482906972160.00   40132174413824.00   39032662786048.00   ...  38208029065216.00   39032662786048.00   38757784879104.00   37933151158272.00   39582418599936.00  
 53876069761024.00   53051436040192.00   53601191854080.00   54425825574912.00   54700703481856.00   ...  52776558133248.00   53326313947136.00   53051436040192.00   51951924412416.00   53326313947136.00  
 67894843015168.00   67070209294336.00   68169720922112.00   70093866270720.00   68719476736000.00   ...  66795331387392.00   68719476736000.00   67619965108224.00   66795331387392.00   69269232549888.00  
              ...                 ...                 ...                 ...                 ...    ...               ...                 ...                 ...                 ...                 ...   
3711951255371776.00  3606398139105280.00  3659174697238528.00  3782319999549440.00  3747135627460608.00   ... 3571213767016448.00  3676766883282944.00  3623990325149696.00  3606398139105280.00  3694359069327360.00  
3711951255371776.00  3623990325149696.00  3676766883282944.00  3817504371638272.00  3747135627460608.00   ... 3588805953060864.00  3694359069327360.00  3641582511194112.00  3623990325149696.00  3711951255371776.00  
3711951255371776.00  3623990325149696.00  3676766883282944.00  3817504371638272.00  3747135627460608.00   ... 3588805953060864.00  3694359069327360.00  3641582511194112.00  3623990325149696.00  3711951255371776.00  
3711951255371776.00  3623990325149696.00  3676766883282944.00  3817504371638272.00  3747135627460608.00   ... 3588805953060864.00  3694359069327360.00  3641582511194112.00  3623990325149696.00  3711951255371776.00  
3747135627460608.00  3659174697238528.00  3729543441416192.00  3870280929771520.00  3764727813505024.00   ... 3659174697238528.00  3729543441416192.00  3694359069327360.00  3659174697238528.00  3729543441416192.00  

Avg NPU matmul time: 4361.00us.
Avg NPU gflops: 346.24

Min NPU matmul time: 4361.00us.
Max NPU gflops: 346.24

Max NPU matmul time: 4361.00us.
Min NPU gflops: 346.24

Error count: 394


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 2304 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x2304x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x2304x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x2304x2304_32x32x32_8c.txt ../build/aie_256x2304x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x2304x2304_32x32x32_8c.xclbin -i build/insts_256x2304x2304_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 2304 -N 2304 --b_col_maj 0

[  236,  1457] 6016527627190272.00 =!= 6649846324789248.00
Maximum relative error:  10%

Avg NPU matmul time: 5527us.
Avg NPU gflops: 492

Min NPU matmul time: 5527us.
Max NPU gflops: 492

Max NPU matmul time: 5527us.
Min NPU gflops: 492

Error count: 1 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 2304 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x2304x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x2304x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x2304x3328_32x32x32_8c.txt ../build/aie_256x2304x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x2304x3328_32x32x32_8c.xclbin -i build/insts_256x2304x3328_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 2304 -N 3328 --b_col_maj 0


Avg NPU matmul time: 5230us.
Avg NPU gflops: 750.644

Min NPU matmul time: 5230us.
Max NPU gflops: 750.644

Max NPU matmul time: 5230us.
Min NPU gflops: 750.644

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 2304 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x2304x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x2304x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x2304x4352_32x32x32_8c.txt ../build/aie_256x2304x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x2304x4352_32x32x32_8c.xclbin -i build/insts_256x2304x4352_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 2304 -N 4352 --b_col_maj 0


Avg NPU matmul time: 6558us.
Avg NPU gflops: 782.834

Min NPU matmul time: 6558us.
Max NPU gflops: 782.834

Max NPU matmul time: 6558us.
Min NPU gflops: 782.834

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 3328 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x3328x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x3328x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x3328x256_32x32x32_8c.txt ../build/aie_256x3328x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x3328x256_32x32x32_8c.xclbin -i build/insts_256x3328x256_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 3328 -N 256 --b_col_maj 0
[    0,    22] 5738076307456.00 =!= 6390911336448.00
[    0,    30] 5806795784192.00 =!= 6425271074816.00
[    0,    50] 5634997092352.00 =!= 6253472382976.00
[    0,    54] 5669356830720.00 =!= 6287832121344.00
[    0,   105] 5669356830720.00 =!= 6287832121344.00
[    0,   124] 5806795784192.00 =!= 6425271074816.00
[    0,   126] 5738076307456.00 =!= 6356551598080.00
[    0,   147] 5531917877248.00 =!= 6184752906240.00
[    0,   222] 5497558138880.00 =!= 6081673691136.00
[    1,     1] 14224931684352.00 =!= 15736760172544.00
[    1,     2] 14293651161088.00 =!= 15805479649280.00
[    1,     7] 14018773254144.00 =!= 15599321219072.00
[    1,     8] 14018773254144.00 =!= 15530601742336.00
[    1,    17] 13881334300672.00 =!= 15599321219072.00
[    1,    18] 13950053777408.00 =!= 15530601742336.00
[    1,    19] 14362370637824.00 =!= 15942918602752.00
[    1,    27] 14087492730880.00 =!= 15805479649280.00
[    1,    28] 14224931684352.00 =!= 15805479649280.00
[    1,    29] 13950053777408.00 =!= 15461882265600.00
[    1,    31] 14293651161088.00 =!= 15805479649280.00
[    1,    38] 14087492730880.00 =!= 15668040695808.00
[    1,    39] 14431090114560.00 =!= 16011638079488.00
[    1,    40] 14018773254144.00 =!= 15530601742336.00
[    1,    41] 14156212207616.00 =!= 15668040695808.00
[    1,    43] 14018773254144.00 =!= 15599321219072.00
[    1,    45] 14224931684352.00 =!= 15736760172544.00
[    1,    46] 14293651161088.00 =!= 15805479649280.00
[    1,    47] 14018773254144.00 =!= 15736760172544.00
[    1,    48] 14224931684352.00 =!= 15736760172544.00
[    1,    49] 14224931684352.00 =!= 15805479649280.00
[    1,    50] 14087492730880.00 =!= 15668040695808.00
[    1,    54] 14156212207616.00 =!= 15736760172544.00
...and 51686 further errors.
Maximum relative error:  13%

Reference:
  6390911336448.00    6287832121344.00    6322191859712.00    6459630813184.00    6287832121344.00   ...   6322191859712.00    6219112644608.00    6390911336448.00    6081673691136.00    6219112644608.00  
 15942918602752.00   15736760172544.00   15805479649280.00   16149077032960.00   15668040695808.00   ...  15805479649280.00   15530601742336.00   15942918602752.00   15255723835392.00   15599321219072.00  
 25426206392320.00   25151328485376.00   25288767438848.00   25701084299264.00   25151328485376.00   ...  25288767438848.00   24876450578432.00   25563645345792.00   24464133718016.00   25013889531904.00  
 35046933135360.00   34634616274944.00   34772055228416.00   35459249995776.00   34497177321472.00   ...  34772055228416.00   34222299414528.00   35046933135360.00   33535104647168.00   34359738368000.00  
 44530220924928.00   44255343017984.00   44255343017984.00   45079976738816.00   43980465111040.00   ...  44255343017984.00   43430709297152.00   44805098831872.00   42880953483264.00   43705587204096.00  
              ...                 ...                 ...                 ...                 ...    ...               ...                 ...                 ...                 ...                 ...   
2410129488084992.00  2374945115996160.00  2374945115996160.00  2427721674129408.00  2374945115996160.00   ... 2392537302040576.00  2339760743907328.00  2410129488084992.00  2304576371818496.00  2357352929951744.00  
2410129488084992.00  2392537302040576.00  2392537302040576.00  2427721674129408.00  2374945115996160.00   ... 2392537302040576.00  2357352929951744.00  2410129488084992.00  2322168557862912.00  2357352929951744.00  
2427721674129408.00  2392537302040576.00  2392537302040576.00  2445313860173824.00  2392537302040576.00   ... 2410129488084992.00  2357352929951744.00  2427721674129408.00  2322168557862912.00  2374945115996160.00  
2427721674129408.00  2410129488084992.00  2410129488084992.00  2462906046218240.00  2392537302040576.00   ... 2427721674129408.00  2374945115996160.00  2445313860173824.00  2339760743907328.00  2392537302040576.00  
2445313860173824.00  2427721674129408.00  2427721674129408.00  2462906046218240.00  2410129488084992.00   ... 2427721674129408.00  2392537302040576.00  2445313860173824.00  2339760743907328.00  2392537302040576.00  

Output:
  5841155522560.00    5738076307456.00    5806795784192.00    5944234737664.00    5772436045824.00   ...   5806795784192.00    5669356830720.00    5841155522560.00    5600637353984.00    5703716569088.00  
 14431090114560.00   14224931684352.00   14293651161088.00   14637248544768.00   14224931684352.00   ...  14293651161088.00   14224931684352.00   14293651161088.00   13743895347200.00   14224931684352.00  
 23089744183296.00   22677427322880.00   23089744183296.00   23364622090240.00   22677427322880.00   ...  22814866276352.00   22402549415936.00   23364622090240.00   21990232555520.00   22539988369408.00  
 31336081391616.00   31748398252032.00   31198642438144.00   32160715112448.00   31336081391616.00   ...  31061203484672.00   31061203484672.00   31748398252032.00   29686813949952.00   31198642438144.00  
 39857296506880.00   40407052320768.00   39857296506880.00   40407052320768.00   39857296506880.00   ...  39857296506880.00   39032662786048.00   40681930227712.00   38482906972160.00   39307540692992.00  
              ...                 ...                 ...                 ...                 ...    ...               ...                 ...                 ...                 ...                 ...   
2146246697418752.00  2163838883463168.00  2137450604396544.00  2172634976485376.00  2119858418352128.00   ... 2137450604396544.00  2119858418352128.00  2172634976485376.00  2084674046263296.00  2128654511374336.00  
2146246697418752.00  2172634976485376.00  2137450604396544.00  2172634976485376.00  2119858418352128.00   ... 2137450604396544.00  2119858418352128.00  2172634976485376.00  2084674046263296.00  2128654511374336.00  
2190227162529792.00  2181431069507584.00  2163838883463168.00  2190227162529792.00  2128654511374336.00   ... 2163838883463168.00  2155042790440960.00  2190227162529792.00  2111062325329920.00  2137450604396544.00  
2190227162529792.00  2181431069507584.00  2163838883463168.00  2190227162529792.00  2128654511374336.00   ... 2163838883463168.00  2155042790440960.00  2190227162529792.00  2111062325329920.00  2137450604396544.00  
2190227162529792.00  2199023255552000.00  2172634976485376.00  2251799813685248.00  2172634976485376.00   ... 2207819348574208.00  2163838883463168.00  2199023255552000.00  2119858418352128.00  2163838883463168.00  

Avg NPU matmul time: 3633.00us.
Avg NPU gflops: 120.07

Min NPU matmul time: 3633.00us.
Max NPU gflops: 120.07

Max NPU matmul time: 3633.00us.
Min NPU gflops: 120.07

Error count: 51718


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 3328 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x3328x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x3328x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x3328x1280_32x32x32_8c.txt ../build/aie_256x3328x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x3328x1280_32x32x32_8c.xclbin -i build/insts_256x3328x1280_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 3328 -N 1280 --b_col_maj 0

[    2,     2] 113249697660928.00 =!= 125344325566464.00
[    4,  1031] 194613558116352.00 =!= 217703302299648.00
[    5,  1244] 239693534855168.00 =!= 264982302294016.00
[    6,     6] 280375465082880.00 =!= 312261302288384.00
[    9,     9] 406819302277120.00 =!= 452998790643712.00
[   10,  1277] 455197813899264.00 =!= 503576325521408.00
[   11,    11] 501377302265856.00 =!= 556352883654656.00
[   13,    13] 580542139465728.00 =!= 642114790621184.00
[   16,    16] 708085488287744.00 =!= 782852278976512.00
[   17,    17] 752065953398784.00 =!= 840026883620864.00
[   18,    18] 787250325487616.00 =!= 879609302220800.00
[   19,  1119] 835628837109760.00 =!= 936783906865152.00
[   20,    20] 875211255709696.00 =!= 971968278953984.00
[   21,    21] 919191720820736.00 =!= 1033540930109440.00
[   22,    22] 949978046398464.00 =!= 1068725302198272.00
[   23,    23] 993958511509504.00 =!= 1108307720798208.00
[   24,    24] 1055531162664960.00 =!= 1169880371953664.00
[   25,    25] 1103909674287104.00 =!= 1222656930086912.00
[   27,    27] 1169880371953664.00 =!= 1293025674264576.00
[   28,    28] 1187472557998080.00 =!= 1328210046353408.00
[   29,    29] 1257841302175744.00 =!= 1407374883553280.00
[   30,    30] 1275433488220160.00 =!= 1416170976575488.00
[   31,    31] 1345802232397824.00 =!= 1495335813775360.00
[   32,    32] 1354598325420032.00 =!= 1521724092841984.00
[   33,  1062] 1416170976575488.00 =!= 1592092837019648.00
[   34,    34] 1477743627730944.00 =!= 1653665488175104.00
[   35,    35] 1512927999819776.00 =!= 1688849860263936.00
[   36,    36] 1530520185864192.00 =!= 1697645953286144.00
[   37,  1078] 1548112371908608.00 =!= 1732830325374976.00
[   38,    38] 1644869395152896.00 =!= 1820791255597056.00
[   40,    40] 1724034232352768.00 =!= 1926344371863552.00
[   41,    41] 1741626418397184.00 =!= 1935140464885760.00
...and 179 further errors.
Maximum relative error:  12%

Avg NPU matmul time: 4647us.
Avg NPU gflops: 469

Min NPU matmul time: 4647us.
Max NPU gflops: 469

Max NPU matmul time: 4647us.
Min NPU gflops: 469

Error count: 211 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 3328 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x3328x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x3328x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x3328x2304_32x32x32_8c.txt ../build/aie_256x3328x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x3328x2304_32x32x32_8c.xclbin -i build/insts_256x3328x2304_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 3328 -N 2304 --b_col_maj 0

[    2,  1902] 204509162766336.00 =!= 226499395321856.00
[    5,  1907] 437605627854848.00 =!= 483785116221440.00
[    8,     8] 659706976665600.00 =!= 738871813865472.00
[   10,  1277] 809240558043136.00 =!= 897201488265216.00
[   11,    11] 897201488265216.00 =!= 998356558020608.00
[   12,  2133] 958774139420672.00 =!= 1064327255687168.00
[   13,    13] 1037938976620544.00 =!= 1161084278931456.00
[   14,  1727] 1117103813820416.00 =!= 1249045209153536.00
[   15,  1147] 1196268651020288.00 =!= 1328210046353408.00
[   16,  1963] 1284229581242368.00 =!= 1424967069597696.00
[   17,    17] 1337006139375616.00 =!= 1504131906797568.00
[   18,    18] 1424967069597696.00 =!= 1583296743997440.00
[   19,  1545] 1504131906797568.00 =!= 1680053767241728.00
[   21,    21] 1662461581197312.00 =!= 1847179534663680.00
[   22,  1993] 1706442046308352.00 =!= 1926344371863552.00
[   23,  1413] 1820791255597056.00 =!= 2031897488130048.00
[   24,    24] 1873567813730304.00 =!= 2093470139285504.00
[   25,  1664] 1952732650930176.00 =!= 2172634976485376.00
[   32,  1757] 2462906046218240.00 =!= 2744381022928896.00
[   33,  1062] 2586051348529152.00 =!= 2867526325239808.00
[   34,    34] 2674012278751232.00 =!= 2955487255461888.00
[   36,    36] 2779565395017728.00 =!= 3096224743817216.00
[   37,  1078] 2797157581062144.00 =!= 3166593487994880.00
[   39,  1087] 2990671627550720.00 =!= 3342515348439040.00
[   41,  2110] 3113816929861632.00 =!= 3483252836794368.00
[   42,  1245] 3272146604261376.00 =!= 3659174697238528.00
[   43,  1486] 3377699720527872.00 =!= 3799912185593856.00
[   44,    44] 3395291906572288.00 =!= 3782319999549440.00
[   45,  1586] 3500845022838784.00 =!= 3870280929771520.00
[   46,    46] 3518437208883200.00 =!= 3958241859993600.00
[   47,  1560] 3676766883282944.00 =!= 4063794976260096.00
[   49,  1066] 3729543441416192.00 =!= 4169348092526592.00
...and 171 further errors.
Maximum relative error:  12%

Avg NPU matmul time: 6186us.
Avg NPU gflops: 635

Min NPU matmul time: 6186us.
Max NPU gflops: 635

Max NPU matmul time: 6186us.
Min NPU gflops: 635

Error count: 203 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 3328 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x3328x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x3328x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x3328x3328_32x32x32_8c.txt ../build/aie_256x3328x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x3328x3328_32x32x32_8c.xclbin -i build/insts_256x3328x3328_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 3328 -N 3328 --b_col_maj 0

[    2,  1902] 292470092988416.00 =!= 325455441821696.00
[    4,  1031] 510173395288064.00 =!= 567347999932416.00
[    5,  1907] 628920651087872.00 =!= 699289395265536.00
[    6,     6] 743269860376576.00 =!= 826832744087552.00
[    7,     7] 848822976643072.00 =!= 941181953376256.00
[    8,     8] 954376092909568.00 =!= 1059929209176064.00
[    9,     9] 1024744837087232.00 =!= 1152288185909248.00
[   11,    11] 1301821767286784.00 =!= 1451355348664320.00
[   12,  2989] 1389782697508864.00 =!= 1539316278886400.00
[   13,    13] 1486539720753152.00 =!= 1653665488175104.00
[   14,  1727] 1592092837019648.00 =!= 1768014697463808.00
[   15,  1147] 1750422511419392.00 =!= 1952732650930176.00
[   16,  2665] 1838383441641472.00 =!= 2040693581152256.00
[   17,    17] 1952732650930176.00 =!= 2172634976485376.00
[   18,    18] 2023101395107840.00 =!= 2269391999729664.00
[   20,  3279] 2339760743907328.00 =!= 2586051348529152.00
[   21,  2742] 2374945115996160.00 =!= 2638827906662400.00
[   23,  1413] 2586051348529152.00 =!= 2885118511284224.00
[   24,    24] 2656420092706816.00 =!= 2973079441506304.00
[   25,  1664] 2920302883373056.00 =!= 3254554418216960.00
[   26,  3131] 2973079441506304.00 =!= 3324923162394624.00
[   27,  2485] 3025855999639552.00 =!= 3360107534483456.00
[   28,  1943] 3166593487994880.00 =!= 3500845022838784.00
[   30,    30] 3395291906572288.00 =!= 3764727813505024.00
[   31,  3204] 3500845022838784.00 =!= 3887873115815936.00
[   33,  2490] 3782319999549440.00 =!= 4186940278571008.00
[   34,    34] 3782319999549440.00 =!= 4222124650659840.00
[   35,    35] 3993426232082432.00 =!= 4450823069237248.00
[   36,    36] 4046202790215680.00 =!= 4503599627370496.00
[   37,  1078] 4292493394837504.00 =!= 4749890231992320.00
[   38,  2268] 4257309022748672.00 =!= 4749890231992320.00
[   40,  1790] 4486007441326080.00 =!= 4960996464525312.00
...and 183 further errors.
Maximum relative error:  12%

Avg NPU matmul time: 7842us.
Avg NPU gflops: 723

Min NPU matmul time: 7842us.
Max NPU gflops: 723

Max NPU matmul time: 7842us.
Min NPU gflops: 723

Error count: 215 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 3328 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x3328x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x3328x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x3328x4352_32x32x32_8c.txt ../build/aie_256x3328x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x3328x4352_32x32x32_8c.xclbin -i build/insts_256x3328x4352_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 3328 -N 4352 --b_col_maj 0

[    3,  2573] 532163627843584.00 =!= 589338232487936.00
[    5,  4032] 826832744087552.00 =!= 914793674309632.00
[    6,     6] 949978046398464.00 =!= 1055531162664960.00
[    8,  3901] 1240249116131328.00 =!= 1372190511464448.00
[    9,     9] 1398578790531072.00 =!= 1556908464930816.00
[   11,    11] 1644869395152896.00 =!= 1838383441641472.00
[   13,  4028] 1970324836974592.00 =!= 2181431069507584.00
[   14,  1727] 2084674046263296.00 =!= 2322168557862912.00
[   15,  1147] 2286984185774080.00 =!= 2533274790395904.00
[   16,  2665] 2304576371818496.00 =!= 2586051348529152.00
[   17,  4063] 2568459162484736.00 =!= 2849934139195392.00
[   19,  1545] 2814749767106560.00 =!= 3131409115906048.00
[   20,  3279] 2937895069417472.00 =!= 3307330976350208.00
[   21,  2742] 3096224743817216.00 =!= 3483252836794368.00
[   22,  1993] 3289738790305792.00 =!= 3676766883282944.00
[   23,  4083] 3324923162394624.00 =!= 3729543441416192.00
[   24,  3773] 3641582511194112.00 =!= 4028610604171264.00
[   26,  3131] 3799912185593856.00 =!= 4239716836704256.00
[   28,  1943] 4151755906482176.00 =!= 4609152743636992.00
[   29,  4076] 4257309022748672.00 =!= 4714705859903488.00
[   31,  3204] 4486007441326080.00 =!= 5031365208702976.00
[   33,  3581] 4960996464525312.00 =!= 5488762045857792.00
[   36,    36] 5172102697058304.00 =!= 5805421394657280.00
[   37,  3733] 5488762045857792.00 =!= 6122080743456768.00
[   38,  2268] 5629499534213120.00 =!= 6227633859723264.00
[   39,  4231] 5629499534213120.00 =!= 6262818231812096.00
[   40,  1790] 5946158883012608.00 =!= 6614661952700416.00
[   42,  3821] 6157265115545600.00 =!= 6860952557322240.00
[   43,  3744] 6368371348078592.00 =!= 7072058789855232.00
[   44,    44] 6473924464345088.00 =!= 7318349394477056.00
[   45,  2765] 6509108836433920.00 =!= 7318349394477056.00
[   46,    46] 6755399441055744.00 =!= 7529455627010048.00
...and 176 further errors.
Maximum relative error:  12%

Avg NPU matmul time: 8360us.
Avg NPU gflops: 887

Min NPU matmul time: 8360us.
Max NPU gflops: 887

Max NPU matmul time: 8360us.
Min NPU gflops: 887

Error count: 208 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 4352 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x4352x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x4352x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x4352x256_32x32x32_8c.txt ../build/aie_256x4352x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x4352x256_32x32x32_8c.xclbin -i build/insts_256x4352x256_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 4352 -N 256 --b_col_maj 0
[    0,     0] 12506944765952.00 =!= 14156212207616.00
[    0,     1] 12506944765952.00 =!= 13950053777408.00
[    0,     2] 12850542149632.00 =!= 14224931684352.00
[    0,     3] 12987981103104.00 =!= 14362370637824.00
[    0,     4] 12644383719424.00 =!= 14224931684352.00
[    0,     6] 12644383719424.00 =!= 14087492730880.00
[    0,     7] 12713103196160.00 =!= 14087492730880.00
[    0,     9] 12438225289216.00 =!= 14018773254144.00
[    0,    12] 12919261626368.00 =!= 14293651161088.00
[    0,    13] 12850542149632.00 =!= 14362370637824.00
[    0,    15] 12232066859008.00 =!= 13812614823936.00
[    0,    17] 12713103196160.00 =!= 14224931684352.00
[    0,    18] 12506944765952.00 =!= 13950053777408.00
[    0,    20] 12850542149632.00 =!= 14293651161088.00
[    0,    22] 12781822672896.00 =!= 14224931684352.00
[    0,    24] 12713103196160.00 =!= 14224931684352.00
[    0,    25] 13056700579840.00 =!= 14499809591296.00
[    0,    26] 12232066859008.00 =!= 13812614823936.00
[    0,    27] 12369505812480.00 =!= 13812614823936.00
[    0,    28] 12438225289216.00 =!= 14018773254144.00
[    0,    29] 12232066859008.00 =!= 13812614823936.00
[    0,    30] 12575664242688.00 =!= 14087492730880.00
[    0,    31] 12644383719424.00 =!= 14087492730880.00
[    0,    32] 12644383719424.00 =!= 14018773254144.00
[    0,    33] 12644383719424.00 =!= 14156212207616.00
[    0,    34] 12713103196160.00 =!= 14087492730880.00
[    0,    35] 12713103196160.00 =!= 14087492730880.00
[    0,    37] 12369505812480.00 =!= 13881334300672.00
[    0,    38] 12575664242688.00 =!= 14156212207616.00
[    0,    40] 12575664242688.00 =!= 14018773254144.00
[    0,    41] 12506944765952.00 =!= 14087492730880.00
[    0,    42] 12506944765952.00 =!= 14018773254144.00
...and 65448 further errors.
Maximum relative error:  16%

Reference:
 14156212207616.00   13950053777408.00   14224931684352.00   14362370637824.00   14224931684352.00   ...  14293651161088.00   13743895347200.00   14087492730880.00   13606456393728.00   14018773254144.00  
 35459249995776.00   35046933135360.00   35459249995776.00   35734127902720.00   35459249995776.00   ...  35734127902720.00   34497177321472.00   35184372088832.00   34084860461056.00   35046933135360.00  
 56624848830464.00   56075093016576.00   56624848830464.00   57449482551296.00   56624848830464.00   ...  57174604644352.00   55250459295744.00   56624848830464.00   54425825574912.00   56075093016576.00  
 78065325572096.00   76965813944320.00   78065325572096.00   78615081385984.00   78065325572096.00   ...  78615081385984.00   75866302316544.00   77515569758208.00   74766790688768.00   76965813944320.00  
 98956046499840.00   98406290685952.00   98956046499840.00  100055558127616.00   98956046499840.00   ... 100055558127616.00   96757023244288.00   98956046499840.00   95107755802624.00   97856534872064.00  
              ...                 ...                 ...                 ...                 ...    ...               ...                 ...                 ...                 ...                 ...   
5348024557502464.00  5312840185413632.00  5348024557502464.00  5418393301680128.00  5348024557502464.00   ... 5383208929591296.00  5207287069147136.00  5348024557502464.00  5136918324969472.00  5312840185413632.00  
5348024557502464.00  5312840185413632.00  5348024557502464.00  5418393301680128.00  5348024557502464.00   ... 5418393301680128.00  5242471441235968.00  5348024557502464.00  5172102697058304.00  5312840185413632.00  
5383208929591296.00  5348024557502464.00  5383208929591296.00  5453577673768960.00  5383208929591296.00   ... 5453577673768960.00  5277655813324800.00  5383208929591296.00  5207287069147136.00  5348024557502464.00  
5383208929591296.00  5348024557502464.00  5383208929591296.00  5453577673768960.00  5383208929591296.00   ... 5453577673768960.00  5277655813324800.00  5383208929591296.00  5207287069147136.00  5348024557502464.00  
5453577673768960.00  5383208929591296.00  5418393301680128.00  5488762045857792.00  5453577673768960.00   ... 5488762045857792.00  5312840185413632.00  5418393301680128.00  5242471441235968.00  5383208929591296.00  

Output:
 12506944765952.00   12506944765952.00   12850542149632.00   12987981103104.00   12644383719424.00   ...  12919261626368.00   12232066859008.00   12644383719424.00   12094627905536.00   12575664242688.00  
 31748398252032.00   31061203484672.00   31748398252032.00   31336081391616.00   31473520345088.00   ...  31473520345088.00   30648886624256.00   31336081391616.00   30374008717312.00   30648886624256.00  
 50302656970752.00   49478023249920.00   50852412784640.00   50577534877696.00   50302656970752.00   ...  50302656970752.00   48103633715200.00   49752901156864.00   48103633715200.00   48378511622144.00  
 68994354642944.00   69544110456832.00   70093866270720.00   69818988363776.00   68719476736000.00   ...  69544110456832.00   67345087201280.00   69544110456832.00   65970697666560.00   67619965108224.00  
 86311662780416.00   85212151152640.00   85761906966528.00   86311662780416.00   85761906966528.00   ...  87411174408192.00   84662395338752.00   87411174408192.00   82463372083200.00   85761906966528.00  
              ...                 ...                 ...                 ...                 ...    ...               ...                 ...                 ...                 ...                 ...   
4749890231992320.00  4679521487814656.00  4749890231992320.00  4855443348258816.00  4679521487814656.00   ... 4714705859903488.00  4609152743636992.00  4714705859903488.00  4573968371548160.00  4609152743636992.00  
4749890231992320.00  4679521487814656.00  4749890231992320.00  4855443348258816.00  4679521487814656.00   ... 4749890231992320.00  4644337115725824.00  4714705859903488.00  4573968371548160.00  4609152743636992.00  
4749890231992320.00  4679521487814656.00  4749890231992320.00  4855443348258816.00  4679521487814656.00   ... 4749890231992320.00  4644337115725824.00  4714705859903488.00  4573968371548160.00  4609152743636992.00  
4749890231992320.00  4679521487814656.00  4749890231992320.00  4855443348258816.00  4679521487814656.00   ... 4749890231992320.00  4644337115725824.00  4714705859903488.00  4573968371548160.00  4609152743636992.00  
4855443348258816.00  4749890231992320.00  4820258976169984.00  4890627720347648.00  4785074604081152.00   ... 4785074604081152.00  4714705859903488.00  4820258976169984.00  4644337115725824.00  4714705859903488.00  

Avg NPU matmul time: 4164.00us.
Avg NPU gflops: 136.99

Min NPU matmul time: 4164.00us.
Max NPU gflops: 136.99

Max NPU matmul time: 4164.00us.
Min NPU gflops: 136.99

Error count: 65480


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 4352 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x4352x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x4352x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x4352x1280_32x32x32_8c.txt ../build/aie_256x4352x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x4352x1280_32x32x32_8c.xclbin -i build/insts_256x4352x1280_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 4352 -N 1280 --b_col_maj 0

[    0,     0] 64871186038784.00 =!= 72018011619328.00
[    1,     1] 153931627888640.00 =!= 175921860444160.00
[    2,     2] 245191092994048.00 =!= 277076930199552.00
[    3,  1103] 340848604610560.00 =!= 389227116232704.00
[    4,  1031] 426610511577088.00 =!= 490382185988096.00
[    5,  1244] 516770465054720.00 =!= 598134325510144.00
[    6,     6] 624522604576768.00 =!= 712483534798848.00
[    7,     7] 703687441776640.00 =!= 813638604554240.00
[    8,     8] 804842511532032.00 =!= 919191720820736.00
[    9,     9] 892803441754112.00 =!= 1015948744065024.00
[   10,  1277] 967570232442880.00 =!= 1112705767309312.00
[   11,    11] 1059929209176064.00 =!= 1213860837064704.00
[   12,    12] 1161084278931456.00 =!= 1328210046353408.00
[   13,    13] 1249045209153536.00 =!= 1424967069597696.00
[   14,  1196] 1363394418442240.00 =!= 1565704557953024.00
[   15,  1147] 1433763162619904.00 =!= 1644869395152896.00
[   16,    16] 1504131906797568.00 =!= 1750422511419392.00
[   17,    17] 1636073302130688.00 =!= 1891159999774720.00
[   18,    18] 1759218604441600.00 =!= 1979120929996800.00
[   19,  1119] 1811995162574848.00 =!= 2093470139285504.00
[   20,    20] 1908752185819136.00 =!= 2181431069507584.00
[   21,    21] 2023101395107840.00 =!= 2322168557862912.00
[   22,    22] 2128654511374336.00 =!= 2410129488084992.00
[   23,    23] 2216615441596416.00 =!= 2515682604351488.00
[   24,    24] 2339760743907328.00 =!= 2638827906662400.00
[   25,    25] 2357352929951744.00 =!= 2691604464795648.00
[   26,    26] 2445313860173824.00 =!= 2797157581062144.00
[   27,    27] 2515682604351488.00 =!= 2885118511284224.00
[   28,    28] 2621235720617984.00 =!= 2990671627550720.00
[   29,    29] 2761973208973312.00 =!= 3149001301950464.00
[   30,    30] 2761973208973312.00 =!= 3236962232172544.00
[   31,    31] 2920302883373056.00 =!= 3324923162394624.00
...and 682 further errors.
Maximum relative error:  15%

Avg NPU matmul time: 5541us.
Avg NPU gflops: 515

Min NPU matmul time: 5541us.
Max NPU gflops: 515

Max NPU matmul time: 5541us.
Min NPU gflops: 515

Error count: 714 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 4352 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x4352x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x4352x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x4352x2304_32x32x32_8c.txt ../build/aie_256x4352x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x4352x2304_32x32x32_8c.xclbin -i build/insts_256x4352x2304_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 4352 -N 2304 --b_col_maj 0

[    1,  2216] 283673999966208.00 =!= 318858372055040.00
[    2,  1902] 442003674365952.00 =!= 499178279010304.00
[    3,  1103] 606930418532352.00 =!= 690493302243328.00
[    4,  1031] 774056185954304.00 =!= 879609302220800.00
[    5,  1907] 958774139420672.00 =!= 1090715534753792.00
[    6,     6] 1108307720798208.00 =!= 1257841302175744.00
[    7,     7] 1284229581242368.00 =!= 1468947534708736.00
[    8,     8] 1424967069597696.00 =!= 1644869395152896.00
[    9,     9] 1609685023064064.00 =!= 1838383441641472.00
[   10,  1277] 1732830325374976.00 =!= 1996713116041216.00
[   11,    11] 1943936557907968.00 =!= 2225411534618624.00
[   12,  2133] 2163838883463168.00 =!= 2427721674129408.00
[   13,    13] 2286984185774080.00 =!= 2586051348529152.00
[   14,  1727] 2427721674129408.00 =!= 2761973208973312.00
[   15,  1147] 2638827906662400.00 =!= 2990671627550720.00
[   16,  1963] 2761973208973312.00 =!= 3184185674039296.00
[   17,    17] 2920302883373056.00 =!= 3377699720527872.00
[   18,    18] 3078632557772800.00 =!= 3588805953060864.00
[   19,  1545] 3254554418216960.00 =!= 3729543441416192.00
[   20,  1346] 3377699720527872.00 =!= 3835096557682688.00
[   21,    21] 3571213767016448.00 =!= 4151755906482176.00
[   22,  1993] 3799912185593856.00 =!= 4327677766926336.00
[   23,  1413] 3940649673949184.00 =!= 4486007441326080.00
[   24,    24] 4098979348348928.00 =!= 4679521487814656.00
[   25,  1664] 4310085580881920.00 =!= 4890627720347648.00
[   26,  1423] 4503599627370496.00 =!= 5136918324969472.00
[   27,  1525] 4538783999459328.00 =!= 5136918324969472.00
[   28,  1943] 4785074604081152.00 =!= 5418393301680128.00
[   29,    29] 4960996464525312.00 =!= 5664683906301952.00
[   30,    30] 5136918324969472.00 =!= 5805421394657280.00
[   31,    31] 5207287069147136.00 =!= 6051711999279104.00
[   32,  1757] 5383208929591296.00 =!= 6157265115545600.00
...and 791 further errors.
Maximum relative error:  15%

Avg NPU matmul time: 7430us.
Avg NPU gflops: 691

Min NPU matmul time: 7430us.
Max NPU gflops: 691

Max NPU matmul time: 7430us.
Min NPU gflops: 691

Error count: 823 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 4352 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x4352x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x4352x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x4352x3328_32x32x32_8c.txt ../build/aie_256x4352x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x4352x3328_32x32x32_8c.xclbin -i build/insts_256x4352x3328_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 4352 -N 3328 --b_col_maj 0

[    0,     0] 169324790677504.00 =!= 188016488349696.00
[    1,  2216] 393625162743808.00 =!= 452998790643712.00
[    2,  1902] 650910883643392.00 =!= 734473767354368.00
[    3,  2573] 897201488265216.00 =!= 1007152651042816.00
[    4,  1031] 1125899906842624.00 =!= 1257841302175744.00
[    5,  1907] 1363394418442240.00 =!= 1556908464930816.00
[    6,     6] 1600888930041856.00 =!= 1838383441641472.00
[    7,     7] 1855975627685888.00 =!= 2111062325329920.00
[    8,     8] 2102266232307712.00 =!= 2392537302040576.00
[    9,     9] 2269391999729664.00 =!= 2603643534573568.00
[   10,  1277] 2550866976440320.00 =!= 2937895069417472.00
[   11,    11] 2797157581062144.00 =!= 3236962232172544.00
[   12,  2989] 3078632557772800.00 =!= 3500845022838784.00
[   13,    13] 3166593487994880.00 =!= 3711951255371776.00
[   14,  1727] 3536029394927616.00 =!= 3993426232082432.00
[   15,  1147] 3764727813505024.00 =!= 4362862139015168.00
[   16,  2665] 3887873115815936.00 =!= 4503599627370496.00
[   17,    17] 4310085580881920.00 =!= 4890627720347648.00
[   18,    18] 4450823069237248.00 =!= 5066549580791808.00
[   19,  1545] 4609152743636992.00 =!= 5277655813324800.00
[   20,  3279] 5066549580791808.00 =!= 5770237022568448.00
[   21,  2742] 5277655813324800.00 =!= 5910974510923776.00
[   22,  1993] 5453577673768960.00 =!= 6192449487634432.00
[   23,  1413] 5594315162124288.00 =!= 6438740092256256.00
[   24,    24] 5770237022568448.00 =!= 6720215068966912.00
[   25,  1664] 6262818231812096.00 =!= 7247980650299392.00
[   26,  3131] 6473924464345088.00 =!= 7459086882832384.00
[   27,  2485] 6720215068966912.00 =!= 7564639999098880.00
[   28,  1943] 6825768185233408.00 =!= 7810930603720704.00
[   29,    29] 7247980650299392.00 =!= 8233143068786688.00
[   30,    30] 7459086882832384.00 =!= 8444249301319680.00
[   31,  3204] 7529455627010048.00 =!= 8584986789675008.00
...and 832 further errors.
Maximum relative error:  15%

Avg NPU matmul time: 8270us.
Avg NPU gflops: 897

Min NPU matmul time: 8270us.
Max NPU gflops: 897

Max NPU matmul time: 8270us.
Min NPU gflops: 897

Error count: 864 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 256 -K 4352 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_256x4352x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_256x4352x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_256x4352x4352_32x32x32_8c.txt ../build/aie_256x4352x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_256x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_256x4352x4352_32x32x32_8c.xclbin -i build/insts_256x4352x4352_32x32x32_8c.txt -k MLIR_AIE -M 256 -K 4352 -N 4352 --b_col_maj 0

[    0,     0] 215504279044096.00 =!= 241892558110720.00
[    1,  2216] 536561674354688.00 =!= 598134325510144.00
[    2,  1902] 840026883620864.00 =!= 949978046398464.00
[    3,  2573] 1178676464975872.00 =!= 1328210046353408.00
[    4,  4162] 1477743627730944.00 =!= 1680053767241728.00
[    5,  4032] 1803199069552640.00 =!= 2049489674174464.00
[    6,     6] 2084674046263296.00 =!= 2357352929951744.00
[    7,     7] 2427721674129408.00 =!= 2761973208973312.00
[    8,  3901] 2726788836884480.00 =!= 3096224743817216.00
[    9,     9] 2955487255461888.00 =!= 3448068464705536.00
[   10,  1277] 3307330976350208.00 =!= 3835096557682688.00
[   11,    11] 3676766883282944.00 =!= 4151755906482176.00
[   12,  3619] 4063794976260096.00 =!= 4609152743636992.00
[   13,  4028] 4292493394837504.00 =!= 4890627720347648.00
[   14,  1727] 4644337115725824.00 =!= 5242471441235968.00
[   15,  1147] 4855443348258816.00 =!= 5664683906301952.00
[   16,  2665] 5101733952880640.00 =!= 5805421394657280.00
[   17,  4063] 5594315162124288.00 =!= 6403555720167424.00
[   18,    18] 5840605766746112.00 =!= 6755399441055744.00
[   19,  1545] 6051711999279104.00 =!= 7036874417766400.00
[   20,  3279] 6544293208522752.00 =!= 7423902510743552.00
[   21,  2742] 6720215068966912.00 =!= 7775746231631872.00
[   22,  1993] 7036874417766400.00 =!= 8162774324609024.00
[   23,  4083] 7564639999098880.00 =!= 8514618045497344.00
[   24,  3773] 7951668092076032.00 =!= 8972014882652160.00
[   25,  1664] 7951668092076032.00 =!= 9147936743096320.00
[   26,  3131] 8444249301319680.00 =!= 9640517952339968.00
[   27,  2485] 8866461766385664.00 =!= 10062730417405952.00
[   28,  1943] 9077567998918656.00 =!= 10344205394116608.00
[   29,  4076] 9288674231451648.00 =!= 10484942882471936.00
[   30,    30] 9781255440695296.00 =!= 11118261580070912.00
[   31,  3204] 9851624184872960.00 =!= 11399736556781568.00
...and 802 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 9266us.
Avg NPU gflops: 1047

Min NPU matmul time: 9266us.
Max NPU gflops: 1047

Max NPU matmul time: 9266us.
Min NPU gflops: 1047

Error count: 834 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 256 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x256x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x256x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x256x256_32x32x32_8c.txt ../build/aie_1280x256x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x256x256_32x32x32_8c.xclbin -i build/insts_1280x256x256_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 256 -N 256 --b_col_maj 0

Avg NPU matmul time: 4289us.
Avg NPU gflops: 39.1168

Min NPU matmul time: 4289us.
Max NPU gflops: 39.1168

Max NPU matmul time: 4289us.
Min NPU gflops: 39.1168

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 256 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x256x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x256x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x256x1280_32x32x32_8c.txt ../build/aie_1280x256x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x256x1280_32x32x32_8c.xclbin -i build/insts_1280x256x1280_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 256 -N 1280 --b_col_maj 0

Avg NPU matmul time: 4149us.
Avg NPU gflops: 202.184

Min NPU matmul time: 4149us.
Max NPU gflops: 202.184

Max NPU matmul time: 4149us.
Min NPU gflops: 202.184

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 256 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x256x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x256x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x256x2304_32x32x32_8c.txt ../build/aie_1280x256x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x256x2304_32x32x32_8c.xclbin -i build/insts_1280x256x2304_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 256 -N 2304 --b_col_maj 0

Avg NPU matmul time: 4707us.
Avg NPU gflops: 320.788

Min NPU matmul time: 4707us.
Max NPU gflops: 320.788

Max NPU matmul time: 4707us.
Min NPU gflops: 320.788

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 256 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x256x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x256x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x256x3328_32x32x32_8c.txt ../build/aie_1280x256x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x256x3328_32x32x32_8c.xclbin -i build/insts_1280x256x3328_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 256 -N 3328 --b_col_maj 0


Avg NPU matmul time: 5471us.
Avg NPU gflops: 398.654

Min NPU matmul time: 5471us.
Max NPU gflops: 398.654

Max NPU matmul time: 5471us.
Min NPU gflops: 398.654

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 256 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x256x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x256x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x256x4352_32x32x32_8c.txt ../build/aie_1280x256x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x256x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x256x4352_32x32x32_8c.xclbin -i build/insts_1280x256x4352_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 256 -N 4352 --b_col_maj 0


Avg NPU matmul time: 4661us.
Avg NPU gflops: 611.913

Min NPU matmul time: 4661us.
Max NPU gflops: 611.913

Max NPU matmul time: 4661us.
Min NPU gflops: 611.913

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 1280 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x1280x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x1280x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x1280x256_32x32x32_8c.txt ../build/aie_1280x1280x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x1280x256_32x32x32_8c.xclbin -i build/insts_1280x1280x256_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 1280 -N 256 --b_col_maj 0

Avg NPU matmul time: 3559us.
Avg NPU gflops: 235.701

Min NPU matmul time: 3559us.
Max NPU gflops: 235.701

Max NPU matmul time: 3559us.
Min NPU gflops: 235.701

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 1280 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x1280x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x1280x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x1280x1280_32x32x32_8c.txt ../build/aie_1280x1280x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x1280x1280_32x32x32_8c.xclbin -i build/insts_1280x1280x1280_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 1280 -N 1280 --b_col_maj 0


Avg NPU matmul time: 5429us.
Avg NPU gflops: 772.574

Min NPU matmul time: 5429us.
Max NPU gflops: 772.574

Max NPU matmul time: 5429us.
Min NPU gflops: 772.574

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 1280 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x1280x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x1280x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x1280x2304_32x32x32_8c.txt ../build/aie_1280x1280x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x1280x2304_32x32x32_8c.xclbin -i build/insts_1280x1280x2304_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 1280 -N 2304 --b_col_maj 0


Avg NPU matmul time: 8916us.
Avg NPU gflops: 846.764

Min NPU matmul time: 8916us.
Max NPU gflops: 846.764

Max NPU matmul time: 8916us.
Min NPU gflops: 846.764

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 1280 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x1280x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x1280x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x1280x3328_32x32x32_8c.txt ../build/aie_1280x1280x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x1280x3328_32x32x32_8c.xclbin -i build/insts_1280x1280x3328_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 1280 -N 3328 --b_col_maj 0


Avg NPU matmul time: 9600us.
Avg NPU gflops: 1135.96

Min NPU matmul time: 9600us.
Max NPU gflops: 1135.96

Max NPU matmul time: 9600us.
Min NPU gflops: 1135.96

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 1280 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x1280x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x1280x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x1280x4352_32x32x32_8c.txt ../build/aie_1280x1280x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x1280x4352_32x32x32_8c.xclbin -i build/insts_1280x1280x4352_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 1280 -N 4352 --b_col_maj 0


Avg NPU matmul time: 13591us.
Avg NPU gflops: 1049.27

Min NPU matmul time: 13591us.
Max NPU gflops: 1049.27

Max NPU matmul time: 13591us.
Min NPU gflops: 1049.27

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 2304 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x2304x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x2304x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x2304x256_32x32x32_8c.txt ../build/aie_1280x2304x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x2304x256_32x32x32_8c.xclbin -i build/insts_1280x2304x256_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 2304 -N 256 --b_col_maj 0
[    9,    32] 27075473833984.00 =!= 29961691856896.00
[   14,    82] 41781441855488.00 =!= 46179488366592.00
[   32,    67] 90159953477632.00 =!= 100055558127616.00
[   36,   143] 102254581383168.00 =!= 113799453474816.00
[   38,    32] 108301895335936.00 =!= 119846767427584.00
[   57,   210] 163827232538624.00 =!= 181419418583040.00
[   57,   243] 166026255794176.00 =!= 183618441838592.00
[   58,    82] 167125767421952.00 =!= 184717953466368.00
[   60,   104] 172623325560832.00 =!= 191315023233024.00
[   61,   191] 177021372071936.00 =!= 195713069744128.00
[   62,    32] 175921860444160.00 =!= 194613558116352.00
[   62,   106] 174822348816384.00 =!= 193514046488576.00
[   62,   136] 177021372071936.00 =!= 195713069744128.00
[   66,    49] 186916976721920.00 =!= 206708186021888.00
[   69,    37] 194613558116352.00 =!= 215504279044096.00
[   69,   244] 197912092999680.00 =!= 218802813927424.00
[   73,   143] 205608674394112.00 =!= 228698418577408.00
[   73,   249] 208907209277440.00 =!= 230897441832960.00
[   77,    32] 217703302299648.00 =!= 240793046482944.00
[   78,    32] 218802813927424.00 =!= 244091581366272.00
[  114,    78] 327654465077248.00 =!= 362838837166080.00
[  115,   243] 334251534843904.00 =!= 369435906932736.00
[  116,    58] 334251534843904.00 =!= 369435906932736.00
[  116,    82] 332052511588352.00 =!= 367236883677184.00
[  116,   210] 332052511588352.00 =!= 367236883677184.00
[  116,   241] 327654465077248.00 =!= 362838837166080.00
[  116,   243] 334251534843904.00 =!= 371634930188288.00
[  119,    24] 347445674377216.00 =!= 384829069721600.00
[  121,    12] 354042744143872.00 =!= 391426139488256.00
[  121,   161] 334251534843904.00 =!= 369435906932736.00
[  123,    80] 349644697632768.00 =!= 387028092977152.00
[  123,   103] 349644697632768.00 =!= 387028092977152.00
...and 726 further errors.
Maximum relative error:  11%

Reference:
  2104533975040.00    2130303778816.00    2061584302080.00    2104533975040.00    2070174236672.00   ...   2121713844224.00    2044404432896.00    2095944040448.00    2044404432896.00    2095944040448.00  
  5257039970304.00    5325759447040.00    5153960755200.00    5257039970304.00    5188320493568.00   ...   5291399708672.00    5119601016832.00    5222680231936.00    5119601016832.00    5257039970304.00  
  8418135900160.00    8486855376896.00    8280696946688.00    8383776161792.00    8315056685056.00   ...   8452495638528.00    8211977469952.00    8383776161792.00    8177617731584.00    8383776161792.00  
 11544872091648.00   11682311045120.00   11338713661440.00   11544872091648.00   11407433138176.00   ...  11613591568384.00   11269994184704.00   11544872091648.00   11269994184704.00   11544872091648.00  
 14705968021504.00   14843406974976.00   14499809591296.00   14705968021504.00   14568529068032.00   ...  14843406974976.00   14362370637824.00   14637248544768.00   14362370637824.00   14705968021504.00  
              ...                 ...                 ...                 ...                 ...    ...               ...                 ...                 ...                 ...                 ...   
4011018418126848.00  4046202790215680.00  3958241859993600.00  4011018418126848.00  3975834046038016.00   ... 4046202790215680.00  3923057487904768.00  3993426232082432.00  3905465301860352.00  4011018418126848.00  
4028610604171264.00  4063794976260096.00  3975834046038016.00  4028610604171264.00  3993426232082432.00   ... 4063794976260096.00  3940649673949184.00  4011018418126848.00  3923057487904768.00  4028610604171264.00  
4046202790215680.00  4081387162304512.00  3975834046038016.00  4028610604171264.00  3993426232082432.00   ... 4063794976260096.00  3940649673949184.00  4028610604171264.00  3923057487904768.00  4028610604171264.00  
4046202790215680.00  4081387162304512.00  3975834046038016.00  4028610604171264.00  3993426232082432.00   ... 4063794976260096.00  3940649673949184.00  4028610604171264.00  3923057487904768.00  4028610604171264.00  
4046202790215680.00  4081387162304512.00  3975834046038016.00  4028610604171264.00  3993426232082432.00   ... 4063794976260096.00  3940649673949184.00  4028610604171264.00  3923057487904768.00  4028610604171264.00  

Output:
  1975684956160.00    2010044694528.00    1941325217792.00    1967095021568.00    1958505086976.00   ...   2010044694528.00    1915555414016.00    1975684956160.00    1915555414016.00    1975684956160.00  
  4913442586624.00    4947802324992.00    4810363371520.00    4913442586624.00    4844723109888.00   ...   4982162063360.00    4741643894784.00    4810363371520.00    4776003633152.00    4879082848256.00  
  7834020347904.00    7868380086272.00    7627861917696.00    7730941132800.00    7730941132800.00   ...   7937099563008.00    7627861917696.00    7765300871168.00    7662221656064.00    7799660609536.00  
 10651518894080.00   10720238370816.00   10445360463872.00   10720238370816.00   10651518894080.00   ...  10651518894080.00   10514079940608.00   10582799417344.00   10514079940608.00   10720238370816.00  
 13537736916992.00   13675175870464.00   13400297963520.00   13606456393728.00   13469017440256.00   ...  13881334300672.00   13331578486784.00   13812614823936.00   13400297963520.00   13606456393728.00  
              ...                 ...                 ...                 ...                 ...    ...               ...                 ...                 ...                 ...                 ...   
3694359069327360.00  3747135627460608.00  3606398139105280.00  3694359069327360.00  3659174697238528.00   ... 3729543441416192.00  3588805953060864.00  3729543441416192.00  3606398139105280.00  3711951255371776.00  
3711951255371776.00  3764727813505024.00  3676766883282944.00  3711951255371776.00  3659174697238528.00   ... 3747135627460608.00  3641582511194112.00  3729543441416192.00  3641582511194112.00  3747135627460608.00  
3711951255371776.00  3764727813505024.00  3694359069327360.00  3729543441416192.00  3676766883282944.00   ... 3747135627460608.00  3641582511194112.00  3729543441416192.00  3641582511194112.00  3764727813505024.00  
3711951255371776.00  3764727813505024.00  3694359069327360.00  3729543441416192.00  3676766883282944.00   ... 3747135627460608.00  3641582511194112.00  3729543441416192.00  3641582511194112.00  3764727813505024.00  
3711951255371776.00  3764727813505024.00  3694359069327360.00  3729543441416192.00  3676766883282944.00   ... 3747135627460608.00  3641582511194112.00  3729543441416192.00  3641582511194112.00  3764727813505024.00  

Avg NPU matmul time: 4471.00us.
Avg NPU gflops: 337.72

Min NPU matmul time: 4471.00us.
Max NPU gflops: 337.72

Max NPU matmul time: 4471.00us.
Min NPU gflops: 337.72

Error count: 758


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 2304 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x2304x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x2304x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x2304x1280_32x32x32_8c.txt ../build/aie_1280x2304x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x2304x1280_32x32x32_8c.xclbin -i build/insts_1280x2304x1280_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 2304 -N 1280 --b_col_maj 0

[   94,    94] 1328210046353408.00 =!= 1468947534708736.00
Maximum relative error:  10%

Avg NPU matmul time: 8484us.
Avg NPU gflops: 890

Min NPU matmul time: 8484us.
Max NPU gflops: 890

Max NPU matmul time: 8484us.
Min NPU gflops: 890

Error count: 1 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 2304 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x2304x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x2304x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x2304x2304_32x32x32_8c.txt ../build/aie_1280x2304x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x2304x2304_32x32x32_8c.xclbin -i build/insts_1280x2304x2304_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 2304 -N 2304 --b_col_maj 0

[  107,   107] 2797157581062144.00 =!= 3096224743817216.00
[ 1116,  1818] 28288235159420928.00 =!= 31384459903238144.00
Maximum relative error:  10%

Avg NPU matmul time: 12819us.
Avg NPU gflops: 1060

Min NPU matmul time: 12819us.
Max NPU gflops: 1060

Max NPU matmul time: 12819us.
Min NPU gflops: 1060

Error count: 2 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 2304 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x2304x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x2304x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x2304x3328_32x32x32_8c.txt ../build/aie_1280x2304x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x2304x3328_32x32x32_8c.xclbin -i build/insts_1280x2304x3328_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 2304 -N 3328 --b_col_maj 0

[  123,  2105] 4609152743636992.00 =!= 5101733952880640.00
[ 1100,  1176] 41376821576466432.00 =!= 45880421203836928.00
[ 1232,   663] 45317471250415616.00 =!= 50102545854496768.00
Maximum relative error:  10%

Avg NPU matmul time: 15941us.
Avg NPU gflops: 1231

Min NPU matmul time: 15941us.
Max NPU gflops: 1231

Max NPU matmul time: 15941us.
Min NPU gflops: 1231

Error count: 3 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 2304 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x2304x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x2304x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x2304x4352_32x32x32_8c.txt ../build/aie_1280x2304x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x2304x4352_32x32x32_8c.xclbin -i build/insts_1280x2304x4352_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 2304 -N 4352 --b_col_maj 0

[ 1202,   955] 58265320179105792.00 =!= 64457769666740224.00
[  971,  2396] 47006321110679552.00 =!= 52072870691471360.00
Maximum relative error:  10%

Avg NPU matmul time: 20007us.
Avg NPU gflops: 1283

Min NPU matmul time: 20007us.
Max NPU gflops: 1283

Max NPU matmul time: 20007us.
Min NPU gflops: 1283

Error count: 2 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 3328 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x3328x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x3328x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x3328x256_32x32x32_8c.txt ../build/aie_1280x3328x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x3328x256_32x32x32_8c.xclbin -i build/insts_1280x3328x256_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 3328 -N 256 --b_col_maj 0

[    1,     1] 14224931684352.00 =!= 15736760172544.00
[ 1031,     4] 8725724278030336.00 =!= 9710886696517632.00
[ 1244,     5] 10273836649938944.00 =!= 11470105300959232.00
[    6,     6] 57174604644352.00 =!= 63496796504064.00
[    7,     7] 64321430224896.00 =!= 72018011619328.00
[    9,     9] 82463372083200.00 =!= 91809220919296.00
[ 1277,    10] 10907155347537920.00 =!= 12173792742735872.00
[   11,    11] 97306779058176.00 =!= 109401406963712.00
[   12,    12] 108301895335936.00 =!= 120396523241472.00
[   13,    13] 117097988358144.00 =!= 130292127891456.00
[ 1147,    15] 9781255440695296.00 =!= 10907155347537920.00
[   16,    16] 141836999983104.00 =!= 158329674399744.00
[   17,    17] 148434069749760.00 =!= 164926744166400.00
[   18,    18] 155031139516416.00 =!= 173722837188608.00
[ 1119,    19] 9570149208162304.00 =!= 10696049115004928.00
[   20,    20] 172623325560832.00 =!= 193514046488576.00
[   21,    21] 183618441838592.00 =!= 204509162766336.00
[   22,    22] 195713069744128.00 =!= 216603790671872.00
[   23,    23] 197912092999680.00 =!= 222101348810752.00
[   24,    24] 211106232532992.00 =!= 236394999971840.00
[   26,    26] 221001837182976.00 =!= 245191092994048.00
[   27,    27] 234195976716288.00 =!= 261683767410688.00
[   28,    28] 244091581366272.00 =!= 272678883688448.00
[   29,    29] 246290604621824.00 =!= 274877906944000.00
[   31,    31] 271579372060672.00 =!= 301266186010624.00
[ 1062,    33] 9147936743096320.00 =!= 10133099161583616.00
[   34,    34] 288072046477312.00 =!= 323256418566144.00
[   35,    35] 305664232521728.00 =!= 338649581355008.00
[   36,    36] 312261302288384.00 =!= 345246651121664.00
[ 1078,    37] 8936830510563328.00 =!= 9921992929050624.00
[   38,    38] 323256418566144.00 =!= 365037860421632.00
[   40,    40] 336450558099456.00 =!= 378231999954944.00
...and 769 further errors.
Maximum relative error:  13%

Avg NPU matmul time: 5097us.
Avg NPU gflops: 428

Min NPU matmul time: 5097us.
Max NPU gflops: 428

Max NPU matmul time: 5097us.
Min NPU gflops: 428

Error count: 801 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 3328 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x3328x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x3328x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x3328x1280_32x32x32_8c.txt ../build/aie_1280x3328x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x3328x1280_32x32x32_8c.xclbin -i build/insts_1280x3328x1280_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 3328 -N 1280 --b_col_maj 0

[ 1103,     3] 47850746040811520.00 =!= 53198770598313984.00
[ 1031,     4] 44191571343572992.00 =!= 48976645947654144.00
[ 1244,     5] 51509920738050048.00 =!= 57702370225684480.00
[    6,     6] 280375465082880.00 =!= 312261302288384.00
[    9,     9] 406819302277120.00 =!= 452998790643712.00
[ 1277,    10] 54887620458577920.00 =!= 60798594969501696.00
[   11,    11] 501377302265856.00 =!= 556352883654656.00
[   13,    13] 580542139465728.00 =!= 642114790621184.00
[ 1196,    14] 50946970784628736.00 =!= 57139420272263168.00
[ 1147,  1265] 47850746040811520.00 =!= 53480245575024640.00
[   16,  1066] 712483534798848.00 =!= 791648371998720.00
[   17,    17] 752065953398784.00 =!= 840026883620864.00
[   18,  1133] 791648371998720.00 =!= 879609302220800.00
[ 1119,    19] 47569271064100864.00 =!= 52917295621603328.00
[   20,    20] 875211255709696.00 =!= 971968278953984.00
[   21,  1143] 910395627798528.00 =!= 1020346790576128.00
[   22,  1245] 954376092909568.00 =!= 1064327255687168.00
[   23,    23] 993958511509504.00 =!= 1108307720798208.00
[   24,    24] 1055531162664960.00 =!= 1169880371953664.00
[   25,    25] 1103909674287104.00 =!= 1222656930086912.00
[   27,    27] 1169880371953664.00 =!= 1293025674264576.00
[   28,    28] 1187472557998080.00 =!= 1328210046353408.00
[   29,    29] 1257841302175744.00 =!= 1407374883553280.00
[   30,    30] 1275433488220160.00 =!= 1416170976575488.00
[   31,    31] 1345802232397824.00 =!= 1495335813775360.00
[   32,    32] 1354598325420032.00 =!= 1521724092841984.00
[ 1062,    33] 45598946227126272.00 =!= 50665495807918080.00
[   34,  1037] 1442559255642112.00 =!= 1618481116086272.00
[   35,  1206] 1512927999819776.00 =!= 1697645953286144.00
[   36,    36] 1530520185864192.00 =!= 1697645953286144.00
[ 1078,    37] 45035996273704960.00 =!= 50384020831207424.00
[   38,    38] 1644869395152896.00 =!= 1820791255597056.00
...and 783 further errors.
Maximum relative error:  13%

Avg NPU matmul time: 10847us.
Avg NPU gflops: 1005

Min NPU matmul time: 10847us.
Max NPU gflops: 1005

Max NPU matmul time: 10847us.
Min NPU gflops: 1005

Error count: 815 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 3328 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x3328x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x3328x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x3328x2304_32x32x32_8c.txt ../build/aie_1280x3328x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x3328x2304_32x32x32_8c.xclbin -i build/insts_1280x3328x2304_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 3328 -N 2304 --b_col_maj 0

[    2,  1263] 207807697649664.00 =!= 230897441832960.00
[ 1244,     5] 94575592174780416.00 =!= 105271641289785344.00
[    8,     8] 659706976665600.00 =!= 738871813865472.00
[ 1277,  1614] 97390341941886976.00 =!= 108649341010313216.00
[   11,  1853] 892803441754112.00 =!= 1002754604531712.00
[   12,  1447] 976366325465088.00 =!= 1090715534753792.00
[   13,    13] 1037938976620544.00 =!= 1161084278931456.00
[ 1196,  1683] 90634942500831232.00 =!= 101330991615836160.00
[ 1147,  1265] 86131342873460736.00 =!= 96264442035044352.00
[   16,  1066] 1257841302175744.00 =!= 1398578790531072.00
[   17,    17] 1337006139375616.00 =!= 1504131906797568.00
[   18,  1133] 1407374883553280.00 =!= 1574500650975232.00
[   20,    20] 1565704557953024.00 =!= 1759218604441600.00
[   21,  1384] 1627277209108480.00 =!= 1811995162574848.00
[   22,  1245] 1732830325374976.00 =!= 1943936557907968.00
[   23,  2262] 1768014697463808.00 =!= 1987917023019008.00
[   24,  2205] 1891159999774720.00 =!= 2111062325329920.00
[   25,    25] 1987917023019008.00 =!= 2225411534618624.00
[   28,    28] 2225411534618624.00 =!= 2480498232262656.00
[ 1062,  1988] 81064793292668928.00 =!= 90071992547409920.00
[   34,  1945] 2656420092706816.00 =!= 2955487255461888.00
[   35,  1830] 2674012278751232.00 =!= 3008263813595136.00
[   36,    36] 2779565395017728.00 =!= 3096224743817216.00
[ 1078,  1306] 83879543059775488.00 =!= 92886742314516480.00
[   38,    38] 2955487255461888.00 =!= 3307330976350208.00
[ 1087,  1280] 81064793292668928.00 =!= 90634942500831232.00
[   40,    40] 3061040371728384.00 =!= 3412884092616704.00
[   41,  1013] 3201777860083712.00 =!= 3588805953060864.00
[ 1245,    42] 94575592174780416.00 =!= 105271641289785344.00
[   43,  2223] 3272146604261376.00 =!= 3711951255371776.00
[   44,    44] 3395291906572288.00 =!= 3782319999549440.00
[   46,  1440] 3606398139105280.00 =!= 4011018418126848.00
...and 769 further errors.
Maximum relative error:  13%

Avg NPU matmul time: 15963us.
Avg NPU gflops: 1230

Min NPU matmul time: 15963us.
Max NPU gflops: 1230

Max NPU matmul time: 15963us.
Min NPU gflops: 1230

Error count: 801 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 3328 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x3328x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x3328x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x3328x3328_32x32x32_8c.txt ../build/aie_1280x3328x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x3328x3328_32x32x32_8c.xclbin -i build/insts_1280x3328x3328_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 3328 -N 3328 --b_col_maj 0

[    2,  1263] 290271069732864.00 =!= 323256418566144.00
[ 1103,  2293] 123286039799267328.00 =!= 136796838681378816.00
[ 1031,  1627] 112589990684262400.00 =!= 125537839612952576.00
[ 1244,     5] 135670938774536192.00 =!= 151996487423754240.00
[    6,     6] 743269860376576.00 =!= 826832744087552.00
[    7,     7] 848822976643072.00 =!= 941181953376256.00
[    8,     8] 954376092909568.00 =!= 1059929209176064.00
[    9,     9] 1024744837087232.00 =!= 1152288185909248.00
[   12,  3065] 1407374883553280.00 =!= 1556908464930816.00
[   13,    13] 1486539720753152.00 =!= 1653665488175104.00
[ 1196,  2385] 130604389193744384.00 =!= 145241087982698496.00
[ 1147,  1265] 125537839612952576.00 =!= 140737488355328000.00
[   16,  1066] 1785606883508224.00 =!= 1996713116041216.00
[   17,    17] 1952732650930176.00 =!= 2172634976485376.00
[   18,  1133] 2049489674174464.00 =!= 2269391999729664.00
[   21,  1384] 2392537302040576.00 =!= 2691604464795648.00
[   22,  1245] 2427721674129408.00 =!= 2726788836884480.00
[   23,  2387] 2603643534573568.00 =!= 2902710697328640.00
[   24,  2851] 2744381022928896.00 =!= 3061040371728384.00
[   25,    25] 2902710697328640.00 =!= 3236962232172544.00
[   26,  1477] 2955487255461888.00 =!= 3324923162394624.00
[   27,    27] 3025855999639552.00 =!= 3377699720527872.00
[   28,  2924] 3131409115906048.00 =!= 3500845022838784.00
[   29,  2210] 3254554418216960.00 =!= 3641582511194112.00
[   30,  3301] 3395291906572288.00 =!= 3782319999549440.00
[   31,    31] 3465660650749952.00 =!= 3887873115815936.00
[ 1062,  1988] 117656540265054208.00 =!= 131167339147165696.00
[   34,  1945] 3747135627460608.00 =!= 4222124650659840.00
[   36,    36] 4046202790215680.00 =!= 4503599627370496.00
[ 1078,  1306] 117093590311632896.00 =!= 130041439240323072.00
[   38,    38] 4310085580881920.00 =!= 4785074604081152.00
[ 1087,  1280] 119345390125318144.00 =!= 133419138960850944.00
...and 777 further errors.
Maximum relative error:  13%

Avg NPU matmul time: 20130us.
Avg NPU gflops: 1409

Min NPU matmul time: 20130us.
Max NPU gflops: 1409

Max NPU matmul time: 20130us.
Min NPU gflops: 1409

Error count: 809 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 3328 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x3328x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x3328x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x3328x4352_32x32x32_8c.txt ../build/aie_1280x3328x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x3328x4352_32x32x32_8c.xclbin -i build/insts_1280x3328x4352_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 3328 -N 4352 --b_col_maj 0

[    2,  1263] 380431023210496.00 =!= 422212465065984.00
[ 1103,  2293] 157625986957967360.00 =!= 175640385467449344.00
[ 1031,  3882] 148618787703226368.00 =!= 166633186212708352.00
[ 1244,     5] 181269885001662464.00 =!= 202661983231672320.00
[    6,     6] 949978046398464.00 =!= 1055531162664960.00
[    8,  3621] 1275433488220160.00 =!= 1416170976575488.00
[    9,     9] 1398578790531072.00 =!= 1556908464930816.00
[ 1277,  4287] 180143985094819840.00 =!= 201536083324829696.00
[   11,  3339] 1688849860263936.00 =!= 1899956092796928.00
[   12,  3748] 1820791255597056.00 =!= 2031897488130048.00
[   13,    13] 1908752185819136.00 =!= 2146246697418752.00
[ 1196,  2385] 174514485560606720.00 =!= 194780683883773952.00
[ 1147,  1265] 164381386399023104.00 =!= 183521684815347712.00
[   17,    17] 2533274790395904.00 =!= 2832341953150976.00
[   18,  1133] 2726788836884480.00 =!= 3025855999639552.00
[ 1119,  2999] 156500087051124736.00 =!= 175640385467449344.00
[   20,    20] 2920302883373056.00 =!= 3272146604261376.00
[   21,  3421] 3149001301950464.00 =!= 3500845022838784.00
[   22,  3803] 3201777860083712.00 =!= 3588805953060864.00
[   23,  2387] 3430476278661120.00 =!= 3799912185593856.00
[   24,  2851] 3606398139105280.00 =!= 4046202790215680.00
[   26,  1477] 3817504371638272.00 =!= 4239716836704256.00
[   27,  3796] 4011018418126848.00 =!= 4468415255281664.00
[   28,  2924] 4116571534393344.00 =!= 4573968371548160.00
[   29,  2210] 4310085580881920.00 =!= 4785074604081152.00
[   30,  3301] 4450823069237248.00 =!= 4925812092436480.00
[ 1062,  1988] 150870587516911616.00 =!= 168884986026393600.00
[   34,  3453] 5031365208702976.00 =!= 5594315162124288.00
[   35,  1830] 5101733952880640.00 =!= 5699868278390784.00
[   36,    36] 5172102697058304.00 =!= 5805421394657280.00
[ 1078,  3951] 151996487423754240.00 =!= 168884986026393600.00
[   38,  3928] 5594315162124288.00 =!= 6227633859723264.00
...and 747 further errors.
Maximum relative error:  13%

Avg NPU matmul time: 24770us.
Avg NPU gflops: 1497

Min NPU matmul time: 24770us.
Max NPU gflops: 1497

Max NPU matmul time: 24770us.
Min NPU gflops: 1497

Error count: 779 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 4352 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x4352x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x4352x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x4352x256_32x32x32_8c.txt ../build/aie_1280x4352x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x4352x256_32x32x32_8c.xclbin -i build/insts_1280x4352x256_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 4352 -N 256 --b_col_maj 0

[    0,     0] 12506944765952.00 =!= 14156212207616.00
[    1,     1] 31061203484672.00 =!= 35046933135360.00
[    2,     2] 50852412784640.00 =!= 56624848830464.00
[ 1103,     3] 20688410788233216.00 =!= 23784635532050432.00
[ 1031,     4] 19140298416324608.00 =!= 21955048183431168.00
[ 1244,     5] 22377260648497152.00 =!= 25895697857380352.00
[    6,     6] 124244813938688.00 =!= 141836999983104.00
[    7,     7] 144036023238656.00 =!= 161628209283072.00
[    8,     8] 159429186027520.00 =!= 181419418583040.00
[    9,     9] 173722837188608.00 =!= 203409651138560.00
[ 1277,    10] 23362423066984448.00 =!= 27303072740933632.00
[   11,    11] 218802813927424.00 =!= 247390116249600.00
[   12,    12] 235295488344064.00 =!= 270479860432896.00
[   13,    13] 258385232527360.00 =!= 292470092988416.00
[ 1196,    14] 22377260648497152.00 =!= 25473485392314368.00
[ 1147,    15] 20829148276588544.00 =!= 23784635532050432.00
[   16,    16] 310062279032832.00 =!= 351843720888320.00
[   17,    17] 325455441821696.00 =!= 376032976699392.00
[   18,    18] 343047627866112.00 =!= 391426139488256.00
[ 1119,    19] 20547673299877888.00 =!= 23784635532050432.00
[   20,    20] 384829069721600.00 =!= 442003674365952.00
[   21,    21] 402421255766016.00 =!= 459595860410368.00
[   22,    22] 415615395299328.00 =!= 483785116221440.00
[   23,    23] 431008558088192.00 =!= 494780232499200.00
[   24,    24] 461794883665920.00 =!= 527765581332480.00
[   25,    25] 483785116221440.00 =!= 556352883654656.00
[   26,    26] 483785116221440.00 =!= 551954837143552.00
[   27,    27] 501377302265856.00 =!= 576144092954624.00
[   28,    28] 534362651099136.00 =!= 606930418532352.00
[   29,    29] 538760697610240.00 =!= 615726511554560.00
[   30,    30] 567347999932416.00 =!= 646512837132288.00
[   31,    31] 589338232487936.00 =!= 668503069687808.00
...and 968 further errors.
Maximum relative error:  15%

Avg NPU matmul time: 4969us.
Avg NPU gflops: 574

Min NPU matmul time: 4969us.
Max NPU gflops: 574

Max NPU matmul time: 4969us.
Min NPU gflops: 574

Error count: 1000 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 4352 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x4352x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x4352x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x4352x1280_32x32x32_8c.txt ../build/aie_1280x4352x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x4352x1280_32x32x32_8c.xclbin -i build/insts_1280x4352x1280_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 4352 -N 1280 --b_col_maj 0

[    0,     0] 64871186038784.00 =!= 72018011619328.00
[    1,     1] 153931627888640.00 =!= 175921860444160.00
[    2,  1263] 244091581366272.00 =!= 277076930199552.00
[ 1103,     3] 103019841476100096.00 =!= 118219490218475520.00
[ 1031,     4] 93449692267937792.00 =!= 109775240917155840.00
[ 1244,     5] 109775240917155840.00 =!= 128915539333480448.00
[    6,     6] 624522604576768.00 =!= 712483534798848.00
[    7,     7] 703687441776640.00 =!= 813638604554240.00
[    8,     8] 804842511532032.00 =!= 919191720820736.00
[    9,     9] 892803441754112.00 =!= 1015948744065024.00
[ 1277,    10] 119908340078739456.00 =!= 136796838681378816.00
[   11,    11] 1059929209176064.00 =!= 1213860837064704.00
[   12,    12] 1161084278931456.00 =!= 1328210046353408.00
[   13,    13] 1249045209153536.00 =!= 1424967069597696.00
[ 1196,    14] 108086391056891904.00 =!= 126663739519795200.00
[ 1147,  1265] 108086391056891904.00 =!= 121597189939003392.00
[   16,  1066] 1495335813775360.00 =!= 1759218604441600.00
[   17,    17] 1636073302130688.00 =!= 1891159999774720.00
[   18,  1133] 1706442046308352.00 =!= 1961528743952384.00
[ 1119,    19] 101893941569257472.00 =!= 118219490218475520.00
[   20,    20] 1908752185819136.00 =!= 2181431069507584.00
[   21,  1143] 1996713116041216.00 =!= 2269391999729664.00
[   22,  1245] 2111062325329920.00 =!= 2392537302040576.00
[   23,    23] 2216615441596416.00 =!= 2515682604351488.00
[   24,    24] 2339760743907328.00 =!= 2638827906662400.00
[   25,    25] 2357352929951744.00 =!= 2691604464795648.00
[   26,    26] 2445313860173824.00 =!= 2797157581062144.00
[   27,    27] 2515682604351488.00 =!= 2885118511284224.00
[   28,    28] 2621235720617984.00 =!= 2990671627550720.00
[   29,    29] 2761973208973312.00 =!= 3149001301950464.00
[   30,    30] 2761973208973312.00 =!= 3236962232172544.00
[   31,    31] 2920302883373056.00 =!= 3324923162394624.00
...and 968 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 12784us.
Avg NPU gflops: 1116

Min NPU matmul time: 12784us.
Max NPU gflops: 1116

Max NPU matmul time: 12784us.
Min NPU gflops: 1116

Error count: 1000 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 4352 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x4352x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x4352x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x4352x2304_32x32x32_8c.txt ../build/aie_1280x4352x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x4352x2304_32x32x32_8c.xclbin -i build/insts_1280x4352x2304_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 4352 -N 2304 --b_col_maj 0

[    1,  1936] 277076930199552.00 =!= 314460325543936.00
[    2,  1263] 450799767388160.00 =!= 512372418543616.00
[ 1103,  2293] 184647584722190336.00 =!= 212795082393255936.00
[ 1031,  1627] 168884986026393600.00 =!= 195906583790616576.00
[ 1244,     5] 202661983231672320.00 =!= 233061280716423168.00
[    6,     6] 1108307720798208.00 =!= 1257841302175744.00
[    7,     7] 1284229581242368.00 =!= 1468947534708736.00
[    8,     8] 1424967069597696.00 =!= 1644869395152896.00
[    9,     9] 1609685023064064.00 =!= 1838383441641472.00
[ 1277,  1614] 215046882206941184.00 =!= 244320279784849408.00
[   11,  1853] 1952732650930176.00 =!= 2216615441596416.00
[   12,  1447] 2128654511374336.00 =!= 2427721674129408.00
[   13,    13] 2286984185774080.00 =!= 2586051348529152.00
[ 1196,  1683] 194780683883773952.00 =!= 226305881275367424.00
[ 1147,  1265] 191402984163246080.00 =!= 218424581927469056.00
[   16,  1066] 2726788836884480.00 =!= 3131409115906048.00
[   17,    17] 2920302883373056.00 =!= 3377699720527872.00
[   18,  1133] 3061040371728384.00 =!= 3518437208883200.00
[ 1119,  1713] 184647584722190336.00 =!= 213920982300098560.00
[   20,    20] 3377699720527872.00 =!= 3905465301860352.00
[   21,  1384] 3571213767016448.00 =!= 4046202790215680.00
[   22,  1245] 3782319999549440.00 =!= 4327677766926336.00
[   23,  2262] 3870280929771520.00 =!= 4503599627370496.00
[   24,  2205] 4204532464615424.00 =!= 4749890231992320.00
[   25,    25] 4398046511104000.00 =!= 4925812092436480.00
[   26,  1477] 4450823069237248.00 =!= 5031365208702976.00
[   27,    27] 4679521487814656.00 =!= 5348024557502464.00
[   28,    28] 4960996464525312.00 =!= 5559130790035456.00
[   29,  2210] 4960996464525312.00 =!= 5629499534213120.00
[   30,    30] 5136918324969472.00 =!= 5805421394657280.00
[   31,    31] 5207287069147136.00 =!= 6051711999279104.00
[   32,    32] 5418393301680128.00 =!= 6262818231812096.00
...and 967 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 21231us.
Avg NPU gflops: 1209

Min NPU matmul time: 21231us.
Max NPU gflops: 1209

Max NPU matmul time: 21231us.
Min NPU gflops: 1209

Error count: 999 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 4352 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x4352x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x4352x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x4352x3328_32x32x32_8c.txt ../build/aie_1280x4352x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x4352x3328_32x32x32_8c.xclbin -i build/insts_1280x4352x3328_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 4352 -N 3328 --b_col_maj 0

[    0,     0] 169324790677504.00 =!= 188016488349696.00
[    1,  1936] 402421255766016.00 =!= 457396837154816.00
[    2,  1263] 642114790621184.00 =!= 725677674332160.00
[ 1103,  2293] 267964177828544512.00 =!= 306244774661193728.00
[ 1031,  1627] 248823879412219904.00 =!= 281474976710656000.00
[ 1244,     5] 299489375220137984.00 =!= 342273571680157696.00
[    6,     6] 1600888930041856.00 =!= 1838383441641472.00
[    7,     7] 1855975627685888.00 =!= 2111062325329920.00
[    8,     8] 2102266232307712.00 =!= 2392537302040576.00
[    9,     9] 2269391999729664.00 =!= 2603643534573568.00
[ 1277,  1614] 308496574474878976.00 =!= 346777171307528192.00
[   11,  2709] 2832341953150976.00 =!= 3236962232172544.00
[   12,  3065] 3061040371728384.00 =!= 3483252836794368.00
[   13,    13] 3166593487994880.00 =!= 3711951255371776.00
[ 1196,  2385] 285978576338026496.00 =!= 324259173170675712.00
[ 1147,  1265] 279223176896970752.00 =!= 319755573543305216.00
[   16,  1066] 3975834046038016.00 =!= 4503599627370496.00
[   17,    17] 4310085580881920.00 =!= 4890627720347648.00
[   18,  1133] 4433230883192832.00 =!= 5031365208702976.00
[ 1119,  2999] 263460578201174016.00 =!= 301741175033823232.00
[   20,    20] 4960996464525312.00 =!= 5594315162124288.00
[   21,  1384] 5277655813324800.00 =!= 6016527627190272.00
[   22,  1245] 5348024557502464.00 =!= 6157265115545600.00
[   23,  2387] 5664683906301952.00 =!= 6509108836433920.00
[   24,  2851] 5840605766746112.00 =!= 6755399441055744.00
[   25,    25] 6227633859723264.00 =!= 7142427534032896.00
[   26,  1477] 6403555720167424.00 =!= 7353533766565888.00
[   27,    27] 6544293208522752.00 =!= 7599824371187712.00
[   28,  2924] 6720215068966912.00 =!= 7810930603720704.00
[   29,  2210] 7072058789855232.00 =!= 8057221208342528.00
[   30,  3301] 7177611906121728.00 =!= 8373880557142016.00
[   31,    31] 7494271254921216.00 =!= 8549802417586176.00
...and 968 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 25755us.
Avg NPU gflops: 1440

Min NPU matmul time: 25755us.
Max NPU gflops: 1440

Max NPU matmul time: 25755us.
Min NPU gflops: 1440

Error count: 1000 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 1280 -K 4352 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_1280x4352x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_1280x4352x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_1280x4352x4352_32x32x32_8c.txt ../build/aie_1280x4352x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_1280x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_1280x4352x4352_32x32x32_8c.xclbin -i build/insts_1280x4352x4352_32x32x32_8c.txt -k MLIR_AIE -M 1280 -K 4352 -N 4352 --b_col_maj 0

[    0,     0] 215504279044096.00 =!= 241892558110720.00
[    1,  1936] 523367534821376.00 =!= 589338232487936.00
[    2,  1263] 853221023154176.00 =!= 963172185931776.00
[ 1103,  2293] 340021771866472448.00 =!= 394064967394918400.00
[ 1031,  3882] 324259173170675712.00 =!= 371546969258065920.00
[ 1244,     5] 387309567953862656.00 =!= 448108162923364352.00
[    6,     6] 2084674046263296.00 =!= 2357352929951744.00
[    7,     7] 2427721674129408.00 =!= 2761973208973312.00
[    8,  3621] 2761973208973312.00 =!= 3184185674039296.00
[    9,     9] 2955487255461888.00 =!= 3448068464705536.00
[ 1277,  4287] 403072166649659392.00 =!= 454863562364420096.00
[   11,  3339] 3711951255371776.00 =!= 4186940278571008.00
[   12,  3748] 3975834046038016.00 =!= 4538783999459328.00
[   13,    13] 4186940278571008.00 =!= 4785074604081152.00
[ 1196,  2385] 376050568885436416.00 =!= 432345564227567616.00
[ 1147,  1265] 360287970189639680.00 =!= 407575766277029888.00
[   16,  3783] 5207287069147136.00 =!= 5981343255101440.00
[   17,    17] 5523946417946624.00 =!= 6333186975989760.00
[   18,  1133] 5735052650479616.00 =!= 6790583813144576.00
[ 1119,  2999] 349028971121213440.00 =!= 400820366835974144.00
[   20,    20] 6403555720167424.00 =!= 7388718138654720.00
[   21,  3421] 6825768185233408.00 =!= 7846114975809536.00
[   22,  3803] 7036874417766400.00 =!= 8057221208342528.00
[   23,  2387] 7423902510743552.00 =!= 8479433673408512.00
[   24,  2851] 7986852464164864.00 =!= 8972014882652160.00
[   25,    25] 8057221208342528.00 =!= 9218305487273984.00
[   26,  1477] 8338696185053184.00 =!= 9570149208162304.00
[   27,  3796] 8760908650119168.00 =!= 9992361673228288.00
[   28,  2924] 8972014882652160.00 =!= 10203467905761280.00
[   29,  2210] 9429411719806976.00 =!= 10696049115004928.00
[   30,  3301] 9570149208162304.00 =!= 10907155347537920.00
[   31,    31] 9781255440695296.00 =!= 11118261580070912.00
...and 968 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 31591us.
Avg NPU gflops: 1535

Min NPU matmul time: 31591us.
Max NPU gflops: 1535

Max NPU matmul time: 31591us.
Min NPU gflops: 1535

Error count: 1000 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 256 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x256x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x256x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x256x256_32x32x32_8c.txt ../build/aie_2304x256x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x256x256_32x32x32_8c.xclbin -i build/insts_2304x256x256_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 256 -N 256 --b_col_maj 0

Avg NPU matmul time: 2828us.
Avg NPU gflops: 106.786

Min NPU matmul time: 2828us.
Max NPU gflops: 106.786

Max NPU matmul time: 2828us.
Min NPU gflops: 106.786

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 256 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x256x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x256x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x256x1280_32x32x32_8c.txt ../build/aie_2304x256x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x256x1280_32x32x32_8c.xclbin -i build/insts_2304x256x1280_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 256 -N 1280 --b_col_maj 0

Avg NPU matmul time: 3560us.
Avg NPU gflops: 424.143

Min NPU matmul time: 3560us.
Max NPU gflops: 424.143

Max NPU matmul time: 3560us.
Min NPU gflops: 424.143

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.4s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 256 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x256x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x256x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x256x2304_32x32x32_8c.txt ../build/aie_2304x256x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x256x2304_32x32x32_8c.xclbin -i build/insts_2304x256x2304_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 256 -N 2304 --b_col_maj 0


Avg NPU matmul time: 4821us.
Avg NPU gflops: 563.765

Min NPU matmul time: 4821us.
Max NPU gflops: 563.765

Max NPU matmul time: 4821us.
Min NPU gflops: 563.765

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 256 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x256x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x256x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x256x3328_32x32x32_8c.txt ../build/aie_2304x256x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x256x3328_32x32x32_8c.xclbin -i build/insts_2304x256x3328_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 256 -N 3328 --b_col_maj 0


Avg NPU matmul time: 5801us.
Avg NPU gflops: 676.757

Min NPU matmul time: 5801us.
Max NPU gflops: 676.757

Max NPU matmul time: 5801us.
Min NPU gflops: 676.757

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 256 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x256x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x256x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x256x4352_32x32x32_8c.txt ../build/aie_2304x256x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x256x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x256x4352_32x32x32_8c.xclbin -i build/insts_2304x256x4352_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 256 -N 4352 --b_col_maj 0


Avg NPU matmul time: 5687us.
Avg NPU gflops: 902.73

Min NPU matmul time: 5687us.
Max NPU gflops: 902.73

Max NPU matmul time: 5687us.
Min NPU gflops: 902.73

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 1280 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x1280x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x1280x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x1280x256_32x32x32_8c.txt ../build/aie_2304x1280x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x1280x256_32x32x32_8c.xclbin -i build/insts_2304x1280x256_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 1280 -N 256 --b_col_maj 0

Avg NPU matmul time: 4281us.
Avg NPU gflops: 352.71

Min NPU matmul time: 4281us.
Max NPU gflops: 352.71

Max NPU matmul time: 4281us.
Min NPU gflops: 352.71

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 1280 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x1280x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x1280x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x1280x1280_32x32x32_8c.txt ../build/aie_2304x1280x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x1280x1280_32x32x32_8c.xclbin -i build/insts_2304x1280x1280_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 1280 -N 1280 --b_col_maj 0


Avg NPU matmul time: 7164us.
Avg NPU gflops: 1053.85

Min NPU matmul time: 7164us.
Max NPU gflops: 1053.85

Max NPU matmul time: 7164us.
Min NPU gflops: 1053.85

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 1280 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x1280x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x1280x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x1280x2304_32x32x32_8c.txt ../build/aie_2304x1280x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x1280x2304_32x32x32_8c.xclbin -i build/insts_2304x1280x2304_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 1280 -N 2304 --b_col_maj 0


Avg NPU matmul time: 12238us.
Avg NPU gflops: 1110.44

Min NPU matmul time: 12238us.
Max NPU gflops: 1110.44

Max NPU matmul time: 12238us.
Min NPU gflops: 1110.44

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 1280 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x1280x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x1280x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x1280x3328_32x32x32_8c.txt ../build/aie_2304x1280x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x1280x3328_32x32x32_8c.xclbin -i build/insts_2304x1280x3328_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 1280 -N 3328 --b_col_maj 0


Avg NPU matmul time: 16122us.
Avg NPU gflops: 1217.55

Min NPU matmul time: 16122us.
Max NPU gflops: 1217.55

Max NPU matmul time: 16122us.
Min NPU gflops: 1217.55

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 1280 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x1280x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x1280x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x1280x4352_32x32x32_8c.txt ../build/aie_2304x1280x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x1280x4352_32x32x32_8c.xclbin -i build/insts_2304x1280x4352_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 1280 -N 4352 --b_col_maj 0


Avg NPU matmul time: 20573us.
Avg NPU gflops: 1247.71

Min NPU matmul time: 20573us.
Max NPU gflops: 1247.71

Max NPU matmul time: 20573us.
Min NPU gflops: 1247.71

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 2304 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x2304x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x2304x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x2304x256_32x32x32_8c.txt ../build/aie_2304x2304x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x2304x256_32x32x32_8c.xclbin -i build/insts_2304x2304x256_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 2304 -N 256 --b_col_maj 0

[  253,   253] 721279627821056.00 =!= 800444465020928.00
[  524,     0] 1504131906797568.00 =!= 1662461581197312.00
Maximum relative error:  10%

Avg NPU matmul time: 4494us.
Avg NPU gflops: 605

Min NPU matmul time: 4494us.
Max NPU gflops: 605

Max NPU matmul time: 4494us.
Min NPU gflops: 605

Error count: 2 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 2304 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x2304x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x2304x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x2304x1280_32x32x32_8c.txt ../build/aie_2304x2304x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x2304x1280_32x32x32_8c.xclbin -i build/insts_2304x2304x1280_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 2304 -N 1280 --b_col_maj 0

[   94,    94] 1328210046353408.00 =!= 1468947534708736.00
Maximum relative error:  10%

Avg NPU matmul time: 12477us.
Avg NPU gflops: 1089

Min NPU matmul time: 12477us.
Max NPU gflops: 1089

Max NPU matmul time: 12477us.
Min NPU gflops: 1089

Error count: 1 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 2304 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x2304x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x2304x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x2304x2304_32x32x32_8c.txt ../build/aie_2304x2304x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x2304x2304_32x32x32_8c.xclbin -i build/insts_2304x2304x2304_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 2304 -N 2304 --b_col_maj 0

[ 1977,  1520] 50384020831207424.00 =!= 55732045388709888.00
Maximum relative error:  10%

Avg NPU matmul time: 19628us.
Avg NPU gflops: 1246

Min NPU matmul time: 19628us.
Max NPU gflops: 1246

Max NPU matmul time: 19628us.
Min NPU gflops: 1246

Error count: 1 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 2304 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x2304x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x2304x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x2304x3328_32x32x32_8c.txt ../build/aie_2304x2304x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x2304x3328_32x32x32_8c.xclbin -i build/insts_2304x2304x3328_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 2304 -N 3328 --b_col_maj 0

[ 1073,  1228] 39969446692913152.00 =!= 44191571343572992.00
[ 1558,  2222] 57420895248973824.00 =!= 63613344736608256.00
[  679,   679] 25192010415603712.00 =!= 27866022694354944.00
Maximum relative error:  10%

Avg NPU matmul time: 24889us.
Avg NPU gflops: 1420

Min NPU matmul time: 24889us.
Max NPU gflops: 1420

Max NPU matmul time: 24889us.
Min NPU gflops: 1420

Error count: 3 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 2304 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x2304x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x2304x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x2304x4352_32x32x32_8c.txt ../build/aie_2304x2304x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x2304x4352_32x32x32_8c.xclbin -i build/insts_2304x2304x4352_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 2304 -N 4352 --b_col_maj 0

[  229,  4096] 11118261580070912.00 =!= 12314530231091200.00
[ 1831,  3157] 88946092640567296.00 =!= 98516241848729600.00
Maximum relative error:  10%

Avg NPU matmul time: 29961us.
Avg NPU gflops: 1542

Min NPU matmul time: 29961us.
Max NPU gflops: 1542

Max NPU matmul time: 29961us.
Min NPU gflops: 1542

Error count: 2 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 3328 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x3328x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x3328x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x3328x256_32x32x32_8c.txt ../build/aie_2304x3328x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x3328x256_32x32x32_8c.xclbin -i build/insts_2304x3328x256_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 3328 -N 256 --b_col_maj 0

[ 2216,     1] 18718085951258624.00 =!= 20969885764943872.00
[ 1031,     4] 8725724278030336.00 =!= 9710886696517632.00
[    6,     6] 57174604644352.00 =!= 63496796504064.00
[    7,     7] 64321430224896.00 =!= 72018011619328.00
[    9,     9] 82463372083200.00 =!= 91809220919296.00
[ 1277,    10] 10907155347537920.00 =!= 12173792742735872.00
[   11,    11] 97306779058176.00 =!= 109401406963712.00
[ 2133,    12] 18295873486192640.00 =!= 20266198323167232.00
[   13,    13] 117097988358144.00 =!= 130292127891456.00
[ 1727,    14] 14636698788954112.00 =!= 16325548649218048.00
[ 1147,    15] 9781255440695296.00 =!= 10907155347537920.00
[ 1963,    16] 16747761114284032.00 =!= 18577348462903296.00
[   17,    17] 148434069749760.00 =!= 164926744166400.00
[   18,    18] 155031139516416.00 =!= 173722837188608.00
[ 1545,    19] 13018217672867840.00 =!= 14777436277309440.00
[ 1346,    20] 11188630324248576.00 =!= 12596005207801856.00
[   21,    21] 183618441838592.00 =!= 204509162766336.00
[ 1993,    22] 17029236090994688.00 =!= 18999560927969280.00
[ 1413,    23] 12033055254380544.00 =!= 13299692649578496.00
[   24,    24] 211106232532992.00 =!= 236394999971840.00
[ 1664,    25] 14355223812243456.00 =!= 15903336184152064.00
[ 1525,    27] 12877480184512512.00 =!= 14425592556421120.00
[ 1943,    28] 16607023625928704.00 =!= 18436610974547968.00
[   29,    29] 246290604621824.00 =!= 274877906944000.00
[   31,    31] 271579372060672.00 =!= 301266186010624.00
[ 1757,    32] 14777436277309440.00 =!= 16536654881751040.00
[ 1062,    33] 9147936743096320.00 =!= 10133099161583616.00
[   34,    34] 288072046477312.00 =!= 323256418566144.00
[   35,    35] 305664232521728.00 =!= 338649581355008.00
[   36,    36] 312261302288384.00 =!= 345246651121664.00
[ 1078,    37] 8936830510563328.00 =!= 9921992929050624.00
[ 2268,    38] 19281035904679936.00 =!= 21392098230009856.00
...and 752 further errors.
Maximum relative error:  12%

Avg NPU matmul time: 5503us.
Avg NPU gflops: 713

Min NPU matmul time: 5503us.
Max NPU gflops: 713

Max NPU matmul time: 5503us.
Min NPU gflops: 713

Error count: 784 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 3328 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x3328x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x3328x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x3328x1280_32x32x32_8c.txt ../build/aie_2304x3328x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x3328x1280_32x32x32_8c.xclbin -i build/insts_2304x3328x1280_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 3328 -N 1280 --b_col_maj 0

[ 2216,  1269] 93449692267937792.00 =!= 104708691336364032.00
[ 1902,     2] 79375943432404992.00 =!= 89509042593988608.00
[ 1103,     3] 47850746040811520.00 =!= 53198770598313984.00
[ 1031,     4] 44191571343572992.00 =!= 48976645947654144.00
[ 1907,     5] 79938893385826304.00 =!= 88383142687145984.00
[    6,     6] 280375465082880.00 =!= 312261302288384.00
[    9,     9] 406819302277120.00 =!= 452998790643712.00
[ 1277,    10] 54887620458577920.00 =!= 60798594969501696.00
[   11,    11] 501377302265856.00 =!= 556352883654656.00
[   13,  1181] 580542139465728.00 =!= 642114790621184.00
[ 1727,    14] 74309393851613184.00 =!= 82190693199511552.00
[ 1147,  1186] 47569271064100864.00 =!= 52917295621603328.00
[ 1963,    16] 82753643152932864.00 =!= 91760842407673856.00
[   17,    17] 752065953398784.00 =!= 840026883620864.00
[   18,    18] 787250325487616.00 =!= 879609302220800.00
[ 1545,    19] 65865144550293504.00 =!= 73183493944770560.00
[ 1346,    20] 56576470318841856.00 =!= 63331869759897600.00
[   21,    21] 919191720820736.00 =!= 1033540930109440.00
[ 1413,  1199] 59672695062659072.00 =!= 66146619527004160.00
[   24,    24] 1055531162664960.00 =!= 1169880371953664.00
[ 1423,    26] 60517119992791040.00 =!= 67553994410557440.00
[ 1943,    28] 79938893385826304.00 =!= 90071992547409920.00
[   29,  1059] 1266637395197952.00 =!= 1416170976575488.00
[   30,    30] 1275433488220160.00 =!= 1416170976575488.00
[   31,    31] 1345802232397824.00 =!= 1495335813775360.00
[ 1757,    32] 73746443898191872.00 =!= 82190693199511552.00
[ 1062,  1078] 43347146413441024.00 =!= 48976645947654144.00
[   34,    34] 1477743627730944.00 =!= 1653665488175104.00
[   35,    35] 1512927999819776.00 =!= 1688849860263936.00
[   36,    36] 1530520185864192.00 =!= 1697645953286144.00
[ 1078,    37] 45035996273704960.00 =!= 50384020831207424.00
[ 2268,    38] 94575592174780416.00 =!= 106397541196627968.00
...and 755 further errors.
Maximum relative error:  13%

Avg NPU matmul time: 16783us.
Avg NPU gflops: 1170

Min NPU matmul time: 16783us.
Max NPU gflops: 1170

Max NPU matmul time: 16783us.
Min NPU gflops: 1170

Error count: 787 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 3328 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x3328x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x3328x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x3328x2304_32x32x32_8c.txt ../build/aie_2304x3328x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x3328x2304_32x32x32_8c.xclbin -i build/insts_2304x3328x2304_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 3328 -N 2304 --b_col_maj 0

[ 1103,     3] 83879543059775488.00 =!= 93449692267937792.00
[ 1031,     4] 76561193665298432.00 =!= 86694292826882048.00
[ 1907,     5] 145241087982698496.00 =!= 161003686678495232.00
[    6,  1685] 521168511565824.00 =!= 576144092954624.00
[    8,  2041] 650910883643392.00 =!= 725677674332160.00
[   11,  1438] 879609302220800.00 =!= 985162418487296.00
[ 2133,  1975] 163255486492180480.00 =!= 182395784908505088.00
[   13,  1363] 1037938976620544.00 =!= 1152288185909248.00
[ 1727,    14] 133419138960850944.00 =!= 148618787703226368.00
[ 1147,  1827] 86694292826882048.00 =!= 96264442035044352.00
[ 1963,    16] 147492887796383744.00 =!= 165507286305865728.00
[   17,    17] 1337006139375616.00 =!= 1504131906797568.00
[ 1545,    19] 118782440171896832.00 =!= 131730289100587008.00
[ 1346,    20] 101893941569257472.00 =!= 114841790497947648.00
[   21,  2277] 1653665488175104.00 =!= 1838383441641472.00
[ 1993,    22] 153122387330596864.00 =!= 171136785840078848.00
[ 1413,  1199] 108649341010313216.00 =!= 121597189939003392.00
[   24,  1461] 1908752185819136.00 =!= 2111062325329920.00
[ 1664,    25] 128352589380059136.00 =!= 144115188075855872.00
[ 1423,    26] 107523441103470592.00 =!= 121034239985582080.00
[ 1525,  1095] 114841790497947648.00 =!= 129478489286901760.00
[ 1943,  1637] 150870587516911616.00 =!= 167759086119550976.00
[   30,  1683] 2322168557862912.00 =!= 2586051348529152.00
[ 1757,  1802] 135670938774536192.00 =!= 150870587516911616.00
[   34,  1729] 2603643534573568.00 =!= 2885118511284224.00
[   36,    36] 2779565395017728.00 =!= 3096224743817216.00
[ 1078,    37] 79938893385826304.00 =!= 89509042593988608.00
[ 1087,    39] 83316593106354176.00 =!= 92886742314516480.00
[ 2110,    41] 159877786771652608.00 =!= 176766285374291968.00
[ 1245,  2131] 94012642221359104.00 =!= 104708691336364032.00
[ 1486,  1712] 112027040730841088.00 =!= 126100789566373888.00
[   44,    44] 3395291906572288.00 =!= 3782319999549440.00
...and 760 further errors.
Maximum relative error:  13%

Avg NPU matmul time: 25394us.
Avg NPU gflops: 1391

Min NPU matmul time: 25394us.
Max NPU gflops: 1391

Max NPU matmul time: 25394us.
Min NPU gflops: 1391

Error count: 792 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 3328 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x3328x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x3328x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x3328x3328_32x32x32_8c.txt ../build/aie_2304x3328x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x3328x3328_32x32x32_8c.xclbin -i build/insts_2304x3328x3328_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 3328 -N 3328 --b_col_maj 0

[ 2216,  1269] 242068479971164160.00 =!= 270215977642229760.00
[ 1902,     2] 210543282579570688.00 =!= 236438980436951040.00
[ 1103,  2858] 123848989752688640.00 =!= 137922738588221440.00
[ 1031,     4] 114278840544526336.00 =!= 127226689473216512.00
[ 1907,  2597] 211669182486413312.00 =!= 234187180623265792.00
[    6,  1685] 730075720843264.00 =!= 809240558043136.00
[    7,  2315] 844424930131968.00 =!= 945579999887360.00
[    8,  3263] 945579999887360.00 =!= 1059929209176064.00
[    9,  2724] 1081919441731584.00 =!= 1196268651020288.00
[ 1277,    10] 142426338215591936.00 =!= 157625986957967360.00
[   11,  2759] 1266637395197952.00 =!= 1424967069597696.00
[ 2133,  2620] 237564880343793664.00 =!= 263460578201174016.00
[   13,  1363] 1477743627730944.00 =!= 1662461581197312.00
[ 1727,    14] 190277084256403456.00 =!= 211669182486413312.00
[ 1147,  2397] 125537839612952576.00 =!= 140174538401906688.00
[   17,    17] 1952732650930176.00 =!= 2172634976485376.00
[ 1545,    19] 172262685746921472.00 =!= 191402984163246080.00
[ 1346,  2772] 147492887796383744.00 =!= 164381386399023104.00
[ 1993,    22] 215046882206941184.00 =!= 240942580064321536.00
[ 1413,  1199] 155374187144282112.00 =!= 173388585653764096.00
[   24,  2429] 2656420092706816.00 =!= 3008263813595136.00
[ 1664,    25] 189151184349560832.00 =!= 209417382672728064.00
[ 1423,    26] 156500087051124736.00 =!= 175640385467449344.00
[ 1525,  2927] 165507286305865728.00 =!= 186899384535875584.00
[ 1943,  2904] 213920982300098560.00 =!= 238690780250636288.00
[   29,  1059] 3254554418216960.00 =!= 3623990325149696.00
[   30,  1683] 3448068464705536.00 =!= 3835096557682688.00
[   31,    31] 3465660650749952.00 =!= 3887873115815936.00
[ 1757,  2980] 194780683883773952.00 =!= 216172782113783808.00
[ 1062,  1636] 115967690404790272.00 =!= 129478489286901760.00
[   34,  1729] 3729543441416192.00 =!= 4134163720437760.00
[   35,    35] 3993426232082432.00 =!= 4450823069237248.00
...and 816 further errors.
Maximum relative error:  12%

Avg NPU matmul time: 32265us.
Avg NPU gflops: 1582

Min NPU matmul time: 32265us.
Max NPU gflops: 1582

Max NPU matmul time: 32265us.
Min NPU gflops: 1582

Error count: 848 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 3328 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x3328x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x3328x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x3328x4352_32x32x32_8c.txt ../build/aie_2304x3328x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x3328x4352_32x32x32_8c.xclbin -i build/insts_2304x3328x4352_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 3328 -N 4352 --b_col_maj 0

[ 2216,  3642] 315251973915934720.00 =!= 353532570748583936.00
[ 1103,  2858] 157625986957967360.00 =!= 175640385467449344.00
[ 1031,  3366] 147492887796383744.00 =!= 164381386399023104.00
[    6,  1685] 958774139420672.00 =!= 1059929209176064.00
[    7,  2315] 1099511627776000.00 =!= 1222656930086912.00
[    9,  2724] 1389782697508864.00 =!= 1539316278886400.00
[   11,  2759] 1653665488175104.00 =!= 1847179534663680.00
[ 2133,  2620] 301741175033823232.00 =!= 337769972052787200.00
[   13,  1363] 1979120929996800.00 =!= 2190227162529792.00
[ 1727,    14] 248823879412219904.00 =!= 280349076803813376.00
[ 1147,  2397] 161003686678495232.00 =!= 181269885001662464.00
[ 1963,  2779] 280349076803813376.00 =!= 315251973915934720.00
[   17,    17] 2533274790395904.00 =!= 2832341953150976.00
[   18,  1900] 2656420092706816.00 =!= 2973079441506304.00
[ 1545,    19] 220676381741154304.00 =!= 247697979505377280.00
[ 1346,  2772] 192528884070088704.00 =!= 215046882206941184.00
[   21,  3748] 3061040371728384.00 =!= 3465660650749952.00
[ 1993,    22] 288230376151711744.00 =!= 319755573543305216.00
[ 1413,  1199] 199284283511144448.00 =!= 221802281647996928.00
[   24,  2429] 3571213767016448.00 =!= 3975834046038016.00
[ 1664,    25] 242068479971164160.00 =!= 269090077735387136.00
[ 1423,    26] 202661983231672320.00 =!= 226305881275367424.00
[ 1525,  2927] 218424581927469056.00 =!= 243194379878006784.00
[   29,  3376] 4327677766926336.00 =!= 4785074604081152.00
[   30,  1683] 4398046511104000.00 =!= 4890627720347648.00
[   31,  3360] 4609152743636992.00 =!= 5136918324969472.00
[ 1757,  2980] 254453378946433024.00 =!= 283726776524341248.00
[   34,  1729] 4960996464525312.00 =!= 5488762045857792.00
[   36,    36] 5172102697058304.00 =!= 5805421394657280.00
[ 1078,    37] 153122387330596864.00 =!= 170010885933236224.00
[ 2268,  1758] 324259173170675712.00 =!= 360287970189639680.00
[ 1087,    39] 158751886864809984.00 =!= 176766285374291968.00
...and 754 further errors.
Maximum relative error:  13%

Avg NPU matmul time: 40159us.
Avg NPU gflops: 1662

Min NPU matmul time: 40159us.
Max NPU gflops: 1662

Max NPU matmul time: 40159us.
Min NPU gflops: 1662

Error count: 786 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 4352 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x4352x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x4352x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x4352x256_32x32x32_8c.txt ../build/aie_2304x4352x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x4352x256_32x32x32_8c.xclbin -i build/insts_2304x4352x256_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 4352 -N 256 --b_col_maj 0

[    0,     0] 12506944765952.00 =!= 14156212207616.00
[ 2216,     1] 40813871623045120.00 =!= 46724846133968896.00
[ 1902,     2] 36028797018963968.00 =!= 40532396646334464.00
[ 1103,     3] 20688410788233216.00 =!= 23784635532050432.00
[ 1031,     4] 19140298416324608.00 =!= 21955048183431168.00
[ 1907,     5] 34762159623766016.00 =!= 39687971716202496.00
[    6,     6] 124244813938688.00 =!= 141836999983104.00
[    7,     7] 144036023238656.00 =!= 161628209283072.00
[    8,     8] 159429186027520.00 =!= 181419418583040.00
[    9,     9] 173722837188608.00 =!= 203409651138560.00
[ 1277,    10] 23362423066984448.00 =!= 27303072740933632.00
[   11,    11] 218802813927424.00 =!= 247390116249600.00
[ 2133,    12] 39687971716202496.00 =!= 45598946227126272.00
[   13,    13] 258385232527360.00 =!= 292470092988416.00
[ 1727,    14] 32088147345014784.00 =!= 36591746972385280.00
[ 1147,    15] 20829148276588544.00 =!= 23784635532050432.00
[ 1963,    16] 36591746972385280.00 =!= 41376821576466432.00
[   17,    17] 325455441821696.00 =!= 376032976699392.00
[   18,    18] 343047627866112.00 =!= 391426139488256.00
[ 1545,    19] 28006760182710272.00 =!= 32651097298436096.00
[ 1346,    20] 24910535438893056.00 =!= 28710447624486912.00
[   21,    21] 402421255766016.00 =!= 459595860410368.00
[ 1993,    22] 37154696925806592.00 =!= 42502721483309056.00
[ 1413,    23] 25895697857380352.00 =!= 29554872554618880.00
[   24,    24] 461794883665920.00 =!= 527765581332480.00
[ 1664,    25] 31384459903238144.00 =!= 36028797018963968.00
[ 1423,    26] 25332747903959040.00 =!= 29414135066263552.00
[ 1525,    27] 27584547717644288.00 =!= 31806672368304128.00
[ 1943,    28] 36028797018963968.00 =!= 41095346599755776.00
[   29,    29] 538760697610240.00 =!= 615726511554560.00
[   30,    30] 567347999932416.00 =!= 646512837132288.00
[   31,    31] 589338232487936.00 =!= 668503069687808.00
...and 968 further errors.
Maximum relative error:  15%

Avg NPU matmul time: 6124us.
Avg NPU gflops: 838

Min NPU matmul time: 6124us.
Max NPU gflops: 838

Max NPU matmul time: 6124us.
Min NPU gflops: 838

Error count: 1000 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 4352 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x4352x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x4352x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x4352x1280_32x32x32_8c.txt ../build/aie_2304x4352x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x4352x1280_32x32x32_8c.xclbin -i build/insts_2304x4352x1280_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 4352 -N 1280 --b_col_maj 0

[    0,     0] 64871186038784.00 =!= 72018011619328.00
[ 2216,  1269] 201536083324829696.00 =!= 233061280716423168.00
[ 1902,     2] 170010885933236224.00 =!= 198158383604301824.00
[ 1103,     3] 103019841476100096.00 =!= 118219490218475520.00
[ 1031,     4] 93449692267937792.00 =!= 109775240917155840.00
[ 1907,     5] 171136785840078848.00 =!= 197032483697459200.00
[    6,     6] 624522604576768.00 =!= 712483534798848.00
[    7,     7] 703687441776640.00 =!= 813638604554240.00
[    8,     8] 804842511532032.00 =!= 919191720820736.00
[    9,     9] 892803441754112.00 =!= 1015948744065024.00
[ 1277,    10] 119908340078739456.00 =!= 136796838681378816.00
[   11,    11] 1059929209176064.00 =!= 1213860837064704.00
[ 2133,  1238] 197032483697459200.00 =!= 226305881275367424.00
[   13,  1181] 1249045209153536.00 =!= 1424967069597696.00
[ 1727,    14] 159877786771652608.00 =!= 182395784908505088.00
[ 1147,  1186] 103582791429521408.00 =!= 119345390125318144.00
[ 1963,    16] 179018085187977216.00 =!= 206039682952200192.00
[   17,    17] 1636073302130688.00 =!= 1891159999774720.00
[   18,    18] 1759218604441600.00 =!= 1979120929996800.00
[ 1545,    19] 144115188075855872.00 =!= 163255486492180480.00
[ 1346,    20] 123848989752688640.00 =!= 141863388262170624.00
[   21,    21] 2023101395107840.00 =!= 2322168557862912.00
[ 1993,    22] 183521684815347712.00 =!= 210543282579570688.00
[ 1413,  1199] 128352589380059136.00 =!= 147492887796383744.00
[   24,    24] 2339760743907328.00 =!= 2638827906662400.00
[ 1664,    25] 153122387330596864.00 =!= 174514485560606720.00
[ 1423,    26] 131730289100587008.00 =!= 149744687610068992.00
[ 1525,  1095] 141863388262170624.00 =!= 162129586585337856.00
[ 1943,    28] 176766285374291968.00 =!= 202661983231672320.00
[   29,  1059] 2797157581062144.00 =!= 3131409115906048.00
[   30,    30] 2761973208973312.00 =!= 3236962232172544.00
[   31,    31] 2920302883373056.00 =!= 3324923162394624.00
...and 968 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 19038us.
Avg NPU gflops: 1348

Min NPU matmul time: 19038us.
Max NPU gflops: 1348

Max NPU matmul time: 19038us.
Min NPU gflops: 1348

Error count: 1000 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 4352 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x4352x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x4352x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x4352x2304_32x32x32_8c.txt ../build/aie_2304x4352x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x4352x2304_32x32x32_8c.xclbin -i build/insts_2304x4352x2304_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 4352 -N 2304 --b_col_maj 0

[ 2216,  1269] 369295169444380672.00 =!= 423338364972826624.00
[ 1902,     2] 319755573543305216.00 =!= 364791569817010176.00
[ 1103,     3] 179018085187977216.00 =!= 207165582859042816.00
[ 1031,     4] 170010885933236224.00 =!= 195906583790616576.00
[ 1907,     5] 315251973915934720.00 =!= 358036170375954432.00
[    6,  1685] 1125899906842624.00 =!= 1266637395197952.00
[    7,     7] 1284229581242368.00 =!= 1468947534708736.00
[    8,  2041] 1389782697508864.00 =!= 1636073302130688.00
[    9,     9] 1609685023064064.00 =!= 1838383441641472.00
[ 1277,    10] 212795082393255936.00 =!= 243194379878006784.00
[   11,  1438] 1935140464885760.00 =!= 2181431069507584.00
[ 2133,  1975] 351280770934898688.00 =!= 405323966463344640.00
[   13,  1363] 2243003720663040.00 =!= 2568459162484736.00
[ 1727,    14] 292733975779082240.00 =!= 328762772798046208.00
[ 1147,  1827] 191402984163246080.00 =!= 219550481834311680.00
[ 1963,    16] 328762772798046208.00 =!= 373798769071751168.00
[   17,    17] 2920302883373056.00 =!= 3377699720527872.00
[   18,  1900] 3149001301950464.00 =!= 3571213767016448.00
[ 1545,    19] 254453378946433024.00 =!= 290482175965396992.00
[ 1346,    20] 219550481834311680.00 =!= 255579278853275648.00
[   21,  2277] 3553621580972032.00 =!= 4098979348348928.00
[ 1993,    22] 335518172239101952.00 =!= 380554168512806912.00
[ 1413,  1199] 234187180623265792.00 =!= 269090077735387136.00
[   24,  1461] 4186940278571008.00 =!= 4714705859903488.00
[ 1664,    25] 284852676431183872.00 =!= 319755573543305216.00
[ 1423,    26] 234187180623265792.00 =!= 269090077735387136.00
[ 1525,  1095] 251075679225905152.00 =!= 290482175965396992.00
[ 1943,  1637] 322007373356990464.00 =!= 369295169444380672.00
[   29,  1059] 4960996464525312.00 =!= 5629499534213120.00
[   30,  1683] 5101733952880640.00 =!= 5805421394657280.00
[   31,    31] 5207287069147136.00 =!= 6051711999279104.00
[ 1757,  1802] 288230376151711744.00 =!= 333266372425416704.00
...and 967 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 30755us.
Avg NPU gflops: 1502

Min NPU matmul time: 30755us.
Max NPU gflops: 1502

Max NPU matmul time: 30755us.
Min NPU gflops: 1502

Error count: 999 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 4352 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x4352x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x4352x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x4352x3328_32x32x32_8c.txt ../build/aie_2304x4352x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x4352x3328_32x32x32_8c.xclbin -i build/insts_2304x4352x3328_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 4352 -N 3328 --b_col_maj 0

[    0,     0] 169324790677504.00 =!= 188016488349696.00
[ 2216,  1269] 520165756961292288.00 =!= 598978750440275968.00
[ 1902,     2] 459367161991790592.00 =!= 526921156402348032.00
[ 1103,  2858] 270215977642229760.00 =!= 308496574474878976.00
[ 1031,     4] 244320279784849408.00 =!= 282600876617498624.00
[ 1907,  2597] 459367161991790592.00 =!= 520165756961292288.00
[    6,  1685] 1583296743997440.00 =!= 1829587348619264.00
[    7,  2315] 1864771720708096.00 =!= 2111062325329920.00
[    8,  3263] 2093470139285504.00 =!= 2392537302040576.00
[    9,  2724] 2357352929951744.00 =!= 2638827906662400.00
[ 1277,    10] 313000174102249472.00 =!= 355784370562269184.00
[   11,  2759] 2797157581062144.00 =!= 3201777860083712.00
[ 2133,  2620] 506654958079180800.00 =!= 576460752303423488.00
[   13,  1363] 3219370046128128.00 =!= 3747135627460608.00
[ 1727,    14] 414331165718085632.00 =!= 477381560501272576.00
[ 1147,  2397] 272467777455915008.00 =!= 313000174102249472.00
[ 1963,  2779] 479633360314957824.00 =!= 542683755098144768.00
[   17,    17] 4310085580881920.00 =!= 4890627720347648.00
[   18,  1900] 4468415255281664.00 =!= 5136918324969472.00
[ 1545,    19] 362539770003324928.00 =!= 425590164786511872.00
[ 1346,  2772] 322007373356990464.00 =!= 364791569817010176.00
[   21,  2277] 5207287069147136.00 =!= 5946158883012608.00
[ 1993,    22] 477381560501272576.00 =!= 540431955284459520.00
[ 1413,  1199] 342273571680157696.00 =!= 389561367767547904.00
[   24,  2429] 5840605766746112.00 =!= 6755399441055744.00
[ 1664,    25] 400820366835974144.00 =!= 463870761619161088.00
[ 1423,    26] 337769972052787200.00 =!= 391813167581233152.00
[ 1525,  2927] 367043369630695424.00 =!= 416582965531770880.00
[ 1943,  2904] 457115362178105344.00 =!= 529172956216033280.00
[   29,  1059] 7001690045677568.00 =!= 8057221208342528.00
[   30,  1683] 7353533766565888.00 =!= 8409064929230848.00
[   31,    31] 7494271254921216.00 =!= 8549802417586176.00
...and 968 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 41716us.
Avg NPU gflops: 1600

Min NPU matmul time: 41716us.
Max NPU gflops: 1600

Max NPU matmul time: 41716us.
Min NPU gflops: 1600

Error count: 1000 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 2304 -K 4352 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_2304x4352x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_2304x4352x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_2304x4352x4352_32x32x32_8c.txt ../build/aie_2304x4352x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_2304x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_2304x4352x4352_32x32x32_8c.xclbin -i build/insts_2304x4352x4352_32x32x32_8c.txt -k MLIR_AIE -M 2304 -K 4352 -N 4352 --b_col_maj 0

[    0,     0] 215504279044096.00 =!= 241892558110720.00
[ 2216,  3642] 684547143360315392.00 =!= 797137134044577792.00
[ 1902,  3663] 589971551185534976.00 =!= 675539944105574400.00
[ 1103,  2858] 340021771866472448.00 =!= 391813167581233152.00
[ 1031,  3366] 315251973915934720.00 =!= 364791569817010176.00
[ 1907,  3781] 594475150812905472.00 =!= 680043543732944896.00
[    6,  1685] 2119858418352128.00 =!= 2410129488084992.00
[    7,  2315] 2427721674129408.00 =!= 2744381022928896.00
[    8,  3263] 2674012278751232.00 =!= 3078632557772800.00
[    9,  2724] 3043448185683968.00 =!= 3483252836794368.00
[ 1277,    10] 391813167581233152.00 =!= 452611762550734848.00
[   11,  2759] 3659174697238528.00 =!= 4151755906482176.00
[ 2133,  2620] 671036344478203904.00 =!= 756604737398243328.00
[   13,  1363] 4468415255281664.00 =!= 4996180836614144.00
[ 1727,    14] 547187354725515264.00 =!= 616993148949757952.00
[ 1147,  2397] 353532570748583936.00 =!= 403072166649659392.00
[ 1963,  2779] 607985949695016960.00 =!= 693554342615056384.00
[   17,    17] 5523946417946624.00 =!= 6333186975989760.00
[   18,  1900] 5664683906301952.00 =!= 6579477580611584.00
[ 1545,    19] 479633360314957824.00 =!= 553942754166571008.00
[ 1346,  2772] 414331165718085632.00 =!= 477381560501272576.00
[   21,  3748] 6685030696878080.00 =!= 7775746231631872.00
[ 1993,    22] 635007547459239936.00 =!= 716072340751908864.00
[ 1413,  1199] 432345564227567616.00 =!= 497647758824439808.00
[   24,  2429] 7846114975809536.00 =!= 8866461766385664.00
[ 1664,    25] 520165756961292288.00 =!= 598978750440275968.00
[ 1423,    26] 441352763482308608.00 =!= 508906757892866048.00
[ 1525,  2927] 463870761619161088.00 =!= 540431955284459520.00
[ 1943,  2904] 616993148949757952.00 =!= 698057942242426880.00
[   29,  3376] 9288674231451648.00 =!= 10625680370827264.00
[   30,  1683] 9781255440695296.00 =!= 11047892835893248.00
[   31,  3360] 9992361673228288.00 =!= 11470105300959232.00
...and 968 further errors.
Maximum relative error:  15%

Avg NPU matmul time: 51526us.
Avg NPU gflops: 1694

Min NPU matmul time: 51526us.
Max NPU gflops: 1694

Max NPU matmul time: 51526us.
Min NPU gflops: 1694

Error count: 1000 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 256 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x256x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x256x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x256x256_32x32x32_8c.txt ../build/aie_3328x256x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x256x256_32x32x32_8c.xclbin -i build/insts_3328x256x256_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 256 -N 256 --b_col_maj 0

Avg NPU matmul time: 3111us.
Avg NPU gflops: 140.215

Min NPU matmul time: 3111us.
Max NPU gflops: 140.215

Max NPU matmul time: 3111us.
Min NPU gflops: 140.215

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 256 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x256x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x256x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x256x1280_32x32x32_8c.txt ../build/aie_3328x256x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x256x1280_32x32x32_8c.xclbin -i build/insts_3328x256x1280_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 256 -N 1280 --b_col_maj 0


Avg NPU matmul time: 5055us.
Avg NPU gflops: 431.462

Min NPU matmul time: 5055us.
Max NPU gflops: 431.462

Max NPU matmul time: 5055us.
Min NPU gflops: 431.462

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 256 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x256x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x256x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x256x2304_32x32x32_8c.txt ../build/aie_3328x256x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x256x2304_32x32x32_8c.xclbin -i build/insts_3328x256x2304_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 256 -N 2304 --b_col_maj 0


Avg NPU matmul time: 5375us.
Avg NPU gflops: 730.394

Min NPU matmul time: 5375us.
Max NPU gflops: 730.394

Max NPU matmul time: 5375us.
Min NPU gflops: 730.394

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 256 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x256x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x256x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x256x3328_32x32x32_8c.txt ../build/aie_3328x256x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x256x3328_32x32x32_8c.xclbin -i build/insts_3328x256x3328_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 256 -N 3328 --b_col_maj 0


Avg NPU matmul time: 6552us.
Avg NPU gflops: 865.491

Min NPU matmul time: 6552us.
Max NPU gflops: 865.491

Max NPU matmul time: 6552us.
Min NPU gflops: 865.491

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 256 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x256x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x256x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x256x4352_32x32x32_8c.txt ../build/aie_3328x256x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x256x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x256x4352_32x32x32_8c.xclbin -i build/insts_3328x256x4352_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 256 -N 4352 --b_col_maj 0


Avg NPU matmul time: 7168us.
Avg NPU gflops: 1034.53

Min NPU matmul time: 7168us.
Max NPU gflops: 1034.53

Max NPU matmul time: 7168us.
Min NPU gflops: 1034.53

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 1280 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x1280x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x1280x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x1280x256_32x32x32_8c.txt ../build/aie_3328x1280x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x1280x256_32x32x32_8c.xclbin -i build/insts_3328x1280x256_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 1280 -N 256 --b_col_maj 0


Avg NPU matmul time: 4677us.
Avg NPU gflops: 466.333

Min NPU matmul time: 4677us.
Max NPU gflops: 466.333

Max NPU matmul time: 4677us.
Min NPU gflops: 466.333

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 1280 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x1280x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x1280x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x1280x1280_32x32x32_8c.txt ../build/aie_3328x1280x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x1280x1280_32x32x32_8c.xclbin -i build/insts_3328x1280x1280_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 1280 -N 1280 --b_col_maj 0


Avg NPU matmul time: 8741us.
Avg NPU gflops: 1247.59

Min NPU matmul time: 8741us.
Max NPU gflops: 1247.59

Max NPU matmul time: 8741us.
Min NPU gflops: 1247.59

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 1280 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x1280x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x1280x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x1280x2304_32x32x32_8c.txt ../build/aie_3328x1280x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x1280x2304_32x32x32_8c.xclbin -i build/insts_3328x1280x2304_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 1280 -N 2304 --b_col_maj 0


Avg NPU matmul time: 16211us.
Avg NPU gflops: 1210.87

Min NPU matmul time: 16211us.
Max NPU gflops: 1210.87

Max NPU matmul time: 16211us.
Min NPU gflops: 1210.87

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 1280 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x1280x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x1280x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x1280x3328_32x32x32_8c.txt ../build/aie_3328x1280x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x1280x3328_32x32x32_8c.xclbin -i build/insts_3328x1280x3328_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 1280 -N 3328 --b_col_maj 0


Avg NPU matmul time: 20880us.
Avg NPU gflops: 1357.93

Min NPU matmul time: 20880us.
Max NPU gflops: 1357.93

Max NPU matmul time: 20880us.
Min NPU gflops: 1357.93

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 1280 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x1280x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x1280x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x1280x4352_32x32x32_8c.txt ../build/aie_3328x1280x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x1280x4352_32x32x32_8c.xclbin -i build/insts_3328x1280x4352_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 1280 -N 4352 --b_col_maj 0


Avg NPU matmul time: 26523us.
Avg NPU gflops: 1397.94

Min NPU matmul time: 26523us.
Max NPU gflops: 1397.94

Max NPU matmul time: 26523us.
Min NPU gflops: 1397.94

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 2304 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x2304x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x2304x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x2304x256_32x32x32_8c.txt ../build/aie_3328x2304x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x2304x256_32x32x32_8c.xclbin -i build/insts_3328x2304x256_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 2304 -N 256 --b_col_maj 0

[  524,     0] 1504131906797568.00 =!= 1662461581197312.00
Maximum relative error:  10%

Avg NPU matmul time: 5817us.
Avg NPU gflops: 675

Min NPU matmul time: 5817us.
Max NPU gflops: 675

Max NPU matmul time: 5817us.
Min NPU gflops: 675

Error count: 1 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 2304 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x2304x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x2304x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x2304x1280_32x32x32_8c.txt ../build/aie_3328x2304x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x2304x1280_32x32x32_8c.xclbin -i build/insts_3328x2304x1280_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 2304 -N 1280 --b_col_maj 0

[   94,    94] 1328210046353408.00 =!= 1468947534708736.00
[  189,  1045] 2761973208973312.00 =!= 3061040371728384.00
Maximum relative error:  10%

Avg NPU matmul time: 16419us.
Avg NPU gflops: 1196

Min NPU matmul time: 16419us.
Max NPU gflops: 1196

Max NPU matmul time: 16419us.
Min NPU gflops: 1196

Error count: 2 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 2304 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x2304x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x2304x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x2304x2304_32x32x32_8c.txt ../build/aie_3328x2304x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x2304x2304_32x32x32_8c.xclbin -i build/insts_3328x2304x2304_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 2304 -N 2304 --b_col_maj 0

[ 1832,   973] 47287796087390208.00 =!= 52354345668182016.00
Maximum relative error:  10%

Avg NPU matmul time: 25352us.
Avg NPU gflops: 1394

Min NPU matmul time: 25352us.
Max NPU gflops: 1394

Max NPU matmul time: 25352us.
Min NPU gflops: 1394

Error count: 1 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 2304 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x2304x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x2304x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x2304x3328_32x32x32_8c.txt ../build/aie_3328x2304x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x2304x3328_32x32x32_8c.xclbin -i build/insts_3328x2304x3328_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 2304 -N 3328 --b_col_maj 0

[ 2198,  1968] 79938893385826304.00 =!= 88383142687145984.00
[ 1329,  1056] 48413695994232832.00 =!= 53761720551735296.00
[  364,  2532] 13370061393756160.00 =!= 14777436277309440.00
[ 2381,  2317] 85568392920039424.00 =!= 94575592174780416.00
[ 2571,  2391] 94012642221359104.00 =!= 104145741382942720.00
Maximum relative error:  10%

Avg NPU matmul time: 33474us.
Avg NPU gflops: 1525

Min NPU matmul time: 33474us.
Max NPU gflops: 1525

Max NPU matmul time: 33474us.
Min NPU gflops: 1525

Error count: 5 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 2304 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x2304x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x2304x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x2304x4352_32x32x32_8c.txt ../build/aie_3328x2304x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x2304x4352_32x32x32_8c.xclbin -i build/insts_3328x2304x4352_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 2304 -N 4352 --b_col_maj 0

[ 1944,  3838] 92323792361095168.00 =!= 103019841476100096.00
[ 1034,  2983] 48132221017522176.00 =!= 53198770598313984.00
Maximum relative error:  10%

Avg NPU matmul time: 42279us.
Avg NPU gflops: 1579

Min NPU matmul time: 42279us.
Max NPU gflops: 1579

Max NPU matmul time: 42279us.
Min NPU gflops: 1579

Error count: 2 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 3328 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x3328x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x3328x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x3328x256_32x32x32_8c.txt ../build/aie_3328x3328x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x3328x256_32x32x32_8c.xclbin -i build/insts_3328x3328x256_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 3328 -N 256 --b_col_maj 0

[ 2216,     1] 18718085951258624.00 =!= 20969885764943872.00
[ 2573,     3] 22236523160141824.00 =!= 24910535438893056.00
[ 1031,     4] 8725724278030336.00 =!= 9710886696517632.00
[    6,     6] 57174604644352.00 =!= 63496796504064.00
[    7,     7] 64321430224896.00 =!= 72018011619328.00
[    9,     9] 82463372083200.00 =!= 91809220919296.00
[ 1277,    10] 10907155347537920.00 =!= 12173792742735872.00
[   11,    11] 97306779058176.00 =!= 109401406963712.00
[ 2989,    12] 25332747903959040.00 =!= 28428972647776256.00
[   13,    13] 117097988358144.00 =!= 130292127891456.00
[ 1727,    14] 14636698788954112.00 =!= 16325548649218048.00
[ 1147,    15] 9781255440695296.00 =!= 10907155347537920.00
[ 2665,    16] 22658735625207808.00 =!= 25192010415603712.00
[   17,    17] 148434069749760.00 =!= 164926744166400.00
[   18,    18] 155031139516416.00 =!= 173722837188608.00
[ 1545,    19] 13018217672867840.00 =!= 14777436277309440.00
[ 3279,    20] 27162335252578304.00 =!= 30680772461461504.00
[ 2742,    21] 23221685578629120.00 =!= 25895697857380352.00
[ 1993,    22] 17029236090994688.00 =!= 18999560927969280.00
[ 1413,    23] 12033055254380544.00 =!= 13299692649578496.00
[   24,    24] 211106232532992.00 =!= 236394999971840.00
[ 1664,    25] 14355223812243456.00 =!= 15903336184152064.00
[ 3131,    26] 25332747903959040.00 =!= 28710447624486912.00
[ 2485,    27] 21251360741654528.00 =!= 23503160555339776.00
[ 1943,    28] 16607023625928704.00 =!= 18436610974547968.00
[   29,    29] 246290604621824.00 =!= 274877906944000.00
[ 3204,    31] 27303072740933632.00 =!= 30540034973106176.00
[ 1757,    32] 14777436277309440.00 =!= 16536654881751040.00
[   34,    34] 288072046477312.00 =!= 323256418566144.00
[   35,    35] 305664232521728.00 =!= 338649581355008.00
[   36,    36] 312261302288384.00 =!= 345246651121664.00
[ 1078,    37] 8936830510563328.00 =!= 9921992929050624.00
...and 776 further errors.
Maximum relative error:  12%

Avg NPU matmul time: 6275us.
Avg NPU gflops: 904

Min NPU matmul time: 6275us.
Max NPU gflops: 904

Max NPU matmul time: 6275us.
Min NPU gflops: 904

Error count: 808 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 3328 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x3328x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x3328x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x3328x1280_32x32x32_8c.txt ../build/aie_3328x3328x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x3328x1280_32x32x32_8c.xclbin -i build/insts_3328x3328x1280_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 3328 -N 1280 --b_col_maj 0

[ 2216,     1] 92323792361095168.00 =!= 103019841476100096.00
[ 1902,     2] 79375943432404992.00 =!= 89509042593988608.00
[ 2573,     3] 112027040730841088.00 =!= 124411939706109952.00
[ 1031,  1017] 44191571343572992.00 =!= 48976645947654144.00
[ 1907,     5] 79938893385826304.00 =!= 88383142687145984.00
[    6,     6] 280375465082880.00 =!= 312261302288384.00
[    9,     9] 406819302277120.00 =!= 452998790643712.00
[ 1277,    10] 54887620458577920.00 =!= 60798594969501696.00
[   11,  1253] 492581209243648.00 =!= 551954837143552.00
[ 2989,    12] 124411939706109952.00 =!= 140174538401906688.00
[   13,    13] 580542139465728.00 =!= 642114790621184.00
[ 1727,    14] 74309393851613184.00 =!= 82190693199511552.00
[ 1147,    15] 48132221017522176.00 =!= 53480245575024640.00
[   17,    17] 752065953398784.00 =!= 840026883620864.00
[   18,    18] 787250325487616.00 =!= 879609302220800.00
[ 1545,    19] 65865144550293504.00 =!= 73183493944770560.00
[ 1993,  1107] 84442493013196800.00 =!= 93449692267937792.00
[   24,    24] 1055531162664960.00 =!= 1169880371953664.00
[ 1664,  1241] 70087269200953344.00 =!= 77687093572141056.00
[ 3131,  1212] 132856189007429632.00 =!= 148618787703226368.00
[ 2485,    27] 103582791429521408.00 =!= 115967690404790272.00
[ 1943,    28] 79938893385826304.00 =!= 90071992547409920.00
[   30,    30] 1275433488220160.00 =!= 1416170976575488.00
[ 3204,    31] 136233888727957504.00 =!= 151996487423754240.00
[ 1757,  1240] 74872343805034496.00 =!= 83316593106354176.00
[   34,    34] 1477743627730944.00 =!= 1653665488175104.00
[   35,    35] 1512927999819776.00 =!= 1688849860263936.00
[   36,    36] 1530520185864192.00 =!= 1697645953286144.00
[ 1078,    37] 45035996273704960.00 =!= 50384020831207424.00
[ 2268,    38] 94575592174780416.00 =!= 106397541196627968.00
[ 1087,    39] 47006321110679552.00 =!= 52072870691471360.00
[ 1245,    42] 52354345668182016.00 =!= 58546795155816448.00
...and 738 further errors.
Maximum relative error:  13%

Avg NPU matmul time: 20438us.
Avg NPU gflops: 1387

Min NPU matmul time: 20438us.
Max NPU gflops: 1387

Max NPU matmul time: 20438us.
Min NPU gflops: 1387

Error count: 770 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 3328 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x3328x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x3328x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x3328x2304_32x32x32_8c.txt ../build/aie_3328x3328x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x3328x2304_32x32x32_8c.xclbin -i build/insts_3328x3328x2304_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 3328 -N 2304 --b_col_maj 0

[ 2573,  1573] 199284283511144448.00 =!= 222928181554839552.00
[ 1031,  1291] 79375943432404992.00 =!= 88946092640567296.00
[ 1907,  2239] 144115188075855872.00 =!= 159877786771652608.00
[    7,  1735] 584940185976832.00 =!= 655308930154496.00
[    8,  1373] 672901116198912.00 =!= 747667906887680.00
[    9,  1445] 716881581309952.00 =!= 800444465020928.00
[   13,    13] 1037938976620544.00 =!= 1161084278931456.00
[ 1727,  1405] 133982088914272256.00 =!= 148618787703226368.00
[ 1147,    15] 87257242780303360.00 =!= 98516241848729600.00
[ 2665,  1565] 204913783045357568.00 =!= 229683580995895296.00
[   17,  1903] 1319413953331200.00 =!= 1486539720753152.00
[   18,  1880] 1416170976575488.00 =!= 1574500650975232.00
[ 1545,    19] 118782440171896832.00 =!= 131730289100587008.00
[ 3279,    20] 247697979505377280.00 =!= 280349076803813376.00
[ 2742,  1956] 207165582859042816.00 =!= 235313080530108416.00
[ 1664,  1364] 127226689473216512.00 =!= 141863388262170624.00
[ 3131,  1639] 239816680157478912.00 =!= 270215977642229760.00
[ 1943,    28] 150870587516911616.00 =!= 167759086119550976.00
[   29,  1893] 2286984185774080.00 =!= 2533274790395904.00
[ 3204,  1819] 242068479971164160.00 =!= 273593677362757632.00
[ 1757,  1305] 133982088914272256.00 =!= 149744687610068992.00
[ 2490,    33] 193654783976931328.00 =!= 215046882206941184.00
[ 1078,  2254] 81627743246090240.00 =!= 91760842407673856.00
[ 2268,  1575] 173388585653764096.00 =!= 192528884070088704.00
[ 1087,    39] 83316593106354176.00 =!= 92886742314516480.00
[ 2110,    41] 159877786771652608.00 =!= 176766285374291968.00
[ 1245,    42] 94575592174780416.00 =!= 105271641289785344.00
[   44,    44] 3395291906572288.00 =!= 3782319999549440.00
[ 2765,  1738] 218424581927469056.00 =!= 242068479971164160.00
[   46,    46] 3518437208883200.00 =!= 3958241859993600.00
[ 1560,  1892] 117093590311632896.00 =!= 130604389193744384.00
[ 2503,    48] 191402984163246080.00 =!= 216172782113783808.00
...and 763 further errors.
Maximum relative error:  12%

Avg NPU matmul time: 32431us.
Avg NPU gflops: 1574

Min NPU matmul time: 32431us.
Max NPU gflops: 1574

Max NPU matmul time: 32431us.
Min NPU gflops: 1574

Error count: 795 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 3328 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x3328x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x3328x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x3328x3328_32x32x32_8c.txt ../build/aie_3328x3328x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x3328x3328_32x32x32_8c.xclbin -i build/insts_3328x3328x3328_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 3328 -N 3328 --b_col_maj 0

[ 2216,  2639] 243194379878006784.00 =!= 271341877549072384.00
[ 1902,  1834] 212795082393255936.00 =!= 235313080530108416.00
[ 2573,  2342] 280349076803813376.00 =!= 310748374288564224.00
[ 1031,  2757] 113152940637683712.00 =!= 126100789566373888.00
[    6,     6] 743269860376576.00 =!= 826832744087552.00
[    7,  1735] 853221023154176.00 =!= 949978046398464.00
[   13,    13] 1486539720753152.00 =!= 1653665488175104.00
[ 1727,  1405] 188025284442718208.00 =!= 212795082393255936.00
[ 1147,  2724] 126663739519795200.00 =!= 141863388262170624.00
[ 2665,  1565] 292733975779082240.00 =!= 324259173170675712.00
[   17,  1903] 1899956092796928.00 =!= 2119858418352128.00
[ 1545,    19] 172262685746921472.00 =!= 191402984163246080.00
[ 3279,  2352] 371546969258065920.00 =!= 412079365904400384.00
[ 2742,  2336] 303992974847508480.00 =!= 337769972052787200.00
[ 1413,    23] 157625986957967360.00 =!= 175640385467449344.00
[   24,  1546] 2726788836884480.00 =!= 3043448185683968.00
[ 1664,  1364] 180143985094819840.00 =!= 202661983231672320.00
[ 3131,  1639] 342273571680157696.00 =!= 387309567953862656.00
[ 1943,    28] 211669182486413312.00 =!= 236438980436951040.00
[   29,  1893] 3272146604261376.00 =!= 3641582511194112.00
[   30,  1572] 3342515348439040.00 =!= 3729543441416192.00
[ 3204,  1819] 351280770934898688.00 =!= 389561367767547904.00
[ 1757,  1305] 194780683883773952.00 =!= 216172782113783808.00
[ 2490,    33] 278097276990128128.00 =!= 308496574474878976.00
[   35,    35] 3993426232082432.00 =!= 4450823069237248.00
[ 1078,  2254] 121034239985582080.00 =!= 133982088914272256.00
[ 1087,    39] 120471290032160768.00 =!= 135670938774536192.00
[ 1790,    40] 195906583790616576.00 =!= 217298682020626432.00
[ 2110,    41] 233061280716423168.00 =!= 258956978573803520.00
[ 1245,    42] 134545038867693568.00 =!= 150870587516911616.00
[ 1486,  3054] 164381386399023104.00 =!= 185773484629032960.00
[   44,    44] 4890627720347648.00 =!= 5453577673768960.00
...and 755 further errors.
Maximum relative error:  13%

Avg NPU matmul time: 45664us.
Avg NPU gflops: 1614

Min NPU matmul time: 45664us.
Max NPU gflops: 1614

Max NPU matmul time: 45664us.
Min NPU gflops: 1614

Error count: 787 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 3328 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x3328x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x3328x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x3328x4352_32x32x32_8c.txt ../build/aie_3328x3328x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x3328x4352_32x32x32_8c.xclbin -i build/insts_3328x3328x4352_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 3328 -N 4352 --b_col_maj 0

[ 2216,  2639] 310748374288564224.00 =!= 346777171307528192.00
[ 1902,  3408] 273593677362757632.00 =!= 303992974847508480.00
[ 2573,  2342] 371546969258065920.00 =!= 416582965531770880.00
[ 1031,  2757] 149744687610068992.00 =!= 165507286305865728.00
[ 1907,  3696] 274719577269600256.00 =!= 303992974847508480.00
[    6,     6] 949978046398464.00 =!= 1055531162664960.00
[    7,  1735] 1103909674287104.00 =!= 1222656930086912.00
[ 1277,  1755] 183521684815347712.00 =!= 206039682952200192.00
[   11,  3698] 1644869395152896.00 =!= 1838383441641472.00
[ 1147,  2724] 163255486492180480.00 =!= 182395784908505088.00
[   17,  1903] 2515682604351488.00 =!= 2814749767106560.00
[ 1545,    19] 220676381741154304.00 =!= 247697979505377280.00
[ 3279,  3630] 472877960873902080.00 =!= 531424756029718528.00
[ 2742,  3813] 389561367767547904.00 =!= 434597364041252864.00
[ 1993,  1107] 284852676431183872.00 =!= 315251973915934720.00
[   24,  1546] 3588805953060864.00 =!= 3993426232082432.00
[ 1664,  1364] 237564880343793664.00 =!= 265712378014859264.00
[ 3131,  1639] 457115362178105344.00 =!= 508906757892866048.00
[ 1943,    28] 284852676431183872.00 =!= 315251973915934720.00
[   30,  3713] 4486007441326080.00 =!= 5031365208702976.00
[ 3204,  1819] 452611762550734848.00 =!= 504403158265495552.00
[ 1757,  1305] 252201579132747776.00 =!= 282600876617498624.00
[ 2490,    33] 360287970189639680.00 =!= 400820366835974144.00
[   34,  3830] 4996180836614144.00 =!= 5523946417946624.00
[   36,  1745] 5207287069147136.00 =!= 5840605766746112.00
[ 1078,  2254] 157625986957967360.00 =!= 177892185281134592.00
[ 2268,  3816] 322007373356990464.00 =!= 360287970189639680.00
[ 1087,    39] 158751886864809984.00 =!= 176766285374291968.00
[ 1790,  3447] 257831078666960896.00 =!= 288230376151711744.00
[ 1486,  3054] 217298682020626432.00 =!= 240942580064321536.00
[   44,    44] 6473924464345088.00 =!= 7318349394477056.00
[ 2765,  2353] 396316767208603648.00 =!= 443604563295993856.00
...and 767 further errors.
Maximum relative error:  12%

Avg NPU matmul time: 58375us.
Avg NPU gflops: 1651

Min NPU matmul time: 58375us.
Max NPU gflops: 1651

Max NPU matmul time: 58375us.
Min NPU gflops: 1651

Error count: 799 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 4352 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x4352x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x4352x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x4352x256_32x32x32_8c.txt ../build/aie_3328x4352x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x4352x256_32x32x32_8c.xclbin -i build/insts_3328x4352x256_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 4352 -N 256 --b_col_maj 0

[    0,     0] 12506944765952.00 =!= 14156212207616.00
[ 2216,     1] 40813871623045120.00 =!= 46724846133968896.00
[ 1902,     2] 36028797018963968.00 =!= 40532396646334464.00
[ 2573,     3] 47569271064100864.00 =!= 55450570411999232.00
[ 1031,     4] 19140298416324608.00 =!= 21955048183431168.00
[ 1907,     5] 34762159623766016.00 =!= 39687971716202496.00
[    6,     6] 124244813938688.00 =!= 141836999983104.00
[    7,     7] 144036023238656.00 =!= 161628209283072.00
[    8,     8] 159429186027520.00 =!= 181419418583040.00
[    9,     9] 173722837188608.00 =!= 203409651138560.00
[ 1277,    10] 23362423066984448.00 =!= 27303072740933632.00
[   11,    11] 218802813927424.00 =!= 247390116249600.00
[ 2989,    12] 55169095435288576.00 =!= 64176294690029568.00
[   13,    13] 258385232527360.00 =!= 292470092988416.00
[ 1727,    14] 32088147345014784.00 =!= 36591746972385280.00
[ 1147,    15] 20829148276588544.00 =!= 23784635532050432.00
[ 2665,    16] 47850746040811520.00 =!= 56294995342131200.00
[   17,    17] 325455441821696.00 =!= 376032976699392.00
[   18,    18] 343047627866112.00 =!= 391426139488256.00
[ 1545,    19] 28006760182710272.00 =!= 32651097298436096.00
[ 3279,    20] 61643019899633664.00 =!= 70087269200953344.00
[ 2742,    21] 50946970784628736.00 =!= 57983845202395136.00
[ 1993,    22] 37154696925806592.00 =!= 42502721483309056.00
[ 1413,    23] 25895697857380352.00 =!= 29554872554618880.00
[   24,    24] 461794883665920.00 =!= 527765581332480.00
[ 1664,    25] 31384459903238144.00 =!= 36028797018963968.00
[ 3131,    26] 57420895248973824.00 =!= 64739244643450880.00
[ 2485,    27] 44754521296994304.00 =!= 51791395714760704.00
[ 1943,    28] 36028797018963968.00 =!= 41095346599755776.00
[   29,    29] 538760697610240.00 =!= 615726511554560.00
[   30,    30] 567347999932416.00 =!= 646512837132288.00
[ 3204,    31] 58828270132527104.00 =!= 67835469387268096.00
...and 968 further errors.
Maximum relative error:  15%

Avg NPU matmul time: 7076us.
Avg NPU gflops: 1048

Min NPU matmul time: 7076us.
Max NPU gflops: 1048

Max NPU matmul time: 7076us.
Min NPU gflops: 1048

Error count: 1000 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 4352 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x4352x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x4352x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x4352x1280_32x32x32_8c.txt ../build/aie_3328x4352x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x4352x1280_32x32x32_8c.xclbin -i build/insts_3328x4352x1280_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 4352 -N 1280 --b_col_maj 0

[    0,     0] 64871186038784.00 =!= 72018011619328.00
[ 2216,     1] 200410183417987072.00 =!= 233061280716423168.00
[ 1902,     2] 170010885933236224.00 =!= 198158383604301824.00
[ 2573,     3] 239816680157478912.00 =!= 275845477176442880.00
[ 1031,  1017] 94012642221359104.00 =!= 108649341010313216.00
[ 1907,     5] 171136785840078848.00 =!= 197032483697459200.00
[    6,     6] 624522604576768.00 =!= 712483534798848.00
[    7,     7] 703687441776640.00 =!= 813638604554240.00
[    8,     8] 804842511532032.00 =!= 919191720820736.00
[    9,     9] 892803441754112.00 =!= 1015948744065024.00
[ 1277,    10] 119908340078739456.00 =!= 136796838681378816.00
[   11,  1253] 1099511627776000.00 =!= 1249045209153536.00
[ 2989,    12] 276971377083285504.00 =!= 315251973915934720.00
[   13,    13] 1249045209153536.00 =!= 1424967069597696.00
[ 1727,    14] 159877786771652608.00 =!= 182395784908505088.00
[ 1147,    15] 105834591243206656.00 =!= 121597189939003392.00
[ 2665,    16] 245446179691692032.00 =!= 280349076803813376.00
[   17,    17] 1636073302130688.00 =!= 1891159999774720.00
[   18,    18] 1759218604441600.00 =!= 1979120929996800.00
[ 1545,    19] 144115188075855872.00 =!= 163255486492180480.00
[ 3279,    20] 299489375220137984.00 =!= 346777171307528192.00
[ 2742,  1102] 255579278853275648.00 =!= 292733975779082240.00
[ 1993,  1107] 183521684815347712.00 =!= 208291482765885440.00
[ 1413,    23] 132293239054008320.00 =!= 150870587516911616.00
[   24,    24] 2339760743907328.00 =!= 2638827906662400.00
[ 1664,  1241] 154248287237439488.00 =!= 176766285374291968.00
[ 3131,  1212] 292733975779082240.00 =!= 328762772798046208.00
[ 2485,    27] 222928181554839552.00 =!= 260082878480646144.00
[ 1943,    28] 176766285374291968.00 =!= 202661983231672320.00
[   29,  1081] 2779565395017728.00 =!= 3149001301950464.00
[   30,    30] 2761973208973312.00 =!= 3236962232172544.00
[ 3204,    31] 297237575406452736.00 =!= 337769972052787200.00
...and 968 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 26283us.
Avg NPU gflops: 1411

Min NPU matmul time: 26283us.
Max NPU gflops: 1411

Max NPU matmul time: 26283us.
Min NPU gflops: 1411

Error count: 1000 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 4352 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x4352x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x4352x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x4352x2304_32x32x32_8c.txt ../build/aie_3328x4352x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x4352x2304_32x32x32_8c.xclbin -i build/insts_3328x4352x2304_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 4352 -N 2304 --b_col_maj 0

[ 2216,     1] 364791569817010176.00 =!= 423338364972826624.00
[ 1902,  1834] 315251973915934720.00 =!= 362539770003324928.00
[ 2573,  1573] 434597364041252864.00 =!= 497647758824439808.00
[ 1031,  1291] 171136785840078848.00 =!= 198158383604301824.00
[ 1907,  2239] 310748374288564224.00 =!= 355784370562269184.00
[    6,     6] 1108307720798208.00 =!= 1257841302175744.00
[    7,  1735] 1266637395197952.00 =!= 1460151441686528.00
[    8,  1373] 1433763162619904.00 =!= 1644869395152896.00
[    9,  1445] 1556908464930816.00 =!= 1803199069552640.00
[ 1277,  1755] 210543282579570688.00 =!= 240942580064321536.00
[   11,  1253] 1961528743952384.00 =!= 2216615441596416.00
[ 2989,  1748] 493144159197069312.00 =!= 565201753234997248.00
[   13,    13] 2286984185774080.00 =!= 2586051348529152.00
[ 1727,  1405] 290482175965396992.00 =!= 331014572611731456.00
[ 1147,    15] 188025284442718208.00 =!= 219550481834311680.00
[ 2665,  1565] 436849163854938112.00 =!= 508906757892866048.00
[   17,  1903] 2885118511284224.00 =!= 3324923162394624.00
[   18,  1880] 3113816929861632.00 =!= 3536029394927616.00
[ 1545,    19] 254453378946433024.00 =!= 290482175965396992.00
[ 3279,    20] 553942754166571008.00 =!= 621496748577128448.00
[ 2742,  1956] 454863562364420096.00 =!= 522417556774977536.00
[ 1993,  1107] 333266372425416704.00 =!= 382805968326492160.00
[ 1413,    23] 228557681089052672.00 =!= 266838277921701888.00
[   24,  1546] 4134163720437760.00 =!= 4714705859903488.00
[ 1664,  1364] 274719577269600256.00 =!= 315251973915934720.00
[ 3131,  1639] 526921156402348032.00 =!= 603482350067646464.00
[ 2485,    27] 412079365904400384.00 =!= 479633360314957824.00
[ 1943,    28] 331014572611731456.00 =!= 376050568885436416.00
[   29,  1893] 5066549580791808.00 =!= 5735052650479616.00
[   30,  1572] 5207287069147136.00 =!= 5910974510923776.00
[ 3204,  1819] 542683755098144768.00 =!= 612489549322387456.00
[ 1757,  1305] 290482175965396992.00 =!= 331014572611731456.00
...and 967 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 42533us.
Avg NPU gflops: 1569

Min NPU matmul time: 42533us.
Max NPU gflops: 1569

Max NPU matmul time: 42533us.
Min NPU gflops: 1569

Error count: 999 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 4352 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x4352x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x4352x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x4352x3328_32x32x32_8c.txt ../build/aie_3328x4352x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x4352x3328_32x32x32_8c.xclbin -i build/insts_3328x4352x3328_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 4352 -N 3328 --b_col_maj 0

[ 2216,  2639] 531424756029718528.00 =!= 603482350067646464.00
[ 1902,  1834] 457115362178105344.00 =!= 522417556774977536.00
[ 2573,  2342] 616993148949757952.00 =!= 698057942242426880.00
[ 1031,  2757] 245446179691692032.00 =!= 283726776524341248.00
[ 1907,  2239] 439100963668623360.00 =!= 506654958079180800.00
[    6,     6] 1600888930041856.00 =!= 1838383441641472.00
[    7,  1735] 1855975627685888.00 =!= 2119858418352128.00
[    8,  1373] 2128654511374336.00 =!= 2392537302040576.00
[    9,  1445] 2339760743907328.00 =!= 2656420092706816.00
[ 1277,  1755] 308496574474878976.00 =!= 349028971121213440.00
[   11,  1253] 2709196650840064.00 =!= 3149001301950464.00
[ 2989,  1748] 707065141497167872.00 =!= 824158731808800768.00
[   13,    13] 3166593487994880.00 =!= 3711951255371776.00
[ 1727,  1405] 409827566090715136.00 =!= 475129760687587328.00
[ 1147,  2724] 278097276990128128.00 =!= 313000174102249472.00
[ 2665,  1565] 644014746713980928.00 =!= 729583139634020352.00
[   17,  1903] 4186940278571008.00 =!= 4785074604081152.00
[   18,  1880] 4415638697148416.00 =!= 5031365208702976.00
[ 1545,    19] 362539770003324928.00 =!= 425590164786511872.00
[ 3279,  2352] 788129934789836800.00 =!= 909727124728840192.00
[ 2742,  2336] 671036344478203904.00 =!= 761108337025613824.00
[ 1993,  1107] 470626161060216832.00 =!= 531424756029718528.00
[ 1413,    23] 342273571680157696.00 =!= 391813167581233152.00
[   24,  1546] 6051711999279104.00 =!= 6790583813144576.00
[ 1664,  1364] 394064967394918400.00 =!= 450359962737049600.00
[ 3131,  1639] 747597538143502336.00 =!= 860187528827764736.00
[ 2485,    27] 589971551185534976.00 =!= 680043543732944896.00
[ 1943,    28] 459367161991790592.00 =!= 535928355657089024.00
[   29,  1893] 7072058789855232.00 =!= 8127589952520192.00
[   30,  1572] 7212796278210560.00 =!= 8268327440875520.00
[ 3204,  1819] 765611936652984320.00 =!= 882705526964617216.00
[ 1757,  1305] 418834765345456128.00 =!= 479633360314957824.00
...and 967 further errors.
Maximum relative error:  15%

Avg NPU matmul time: 56655us.
Avg NPU gflops: 1702

Min NPU matmul time: 56655us.
Max NPU gflops: 1702

Max NPU matmul time: 56655us.
Min NPU gflops: 1702

Error count: 999 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 3328 -K 4352 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_3328x4352x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_3328x4352x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_3328x4352x4352_32x32x32_8c.txt ../build/aie_3328x4352x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_3328x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_3328x4352x4352_32x32x32_8c.xclbin -i build/insts_3328x4352x4352_32x32x32_8c.txt -k MLIR_AIE -M 3328 -K 4352 -N 4352 --b_col_maj 0

[ 2216,  2639] 680043543732944896.00 =!= 783626335162466304.00
[ 1902,  3408] 607985949695016960.00 =!= 684547143360315392.00
[ 2573,  2342] 788129934789836800.00 =!= 914230724356210688.00
[ 1031,  2757] 328762772798046208.00 =!= 373798769071751168.00
[ 1907,  3696] 589971551185534976.00 =!= 671036344478203904.00
[    6,     6] 2084674046263296.00 =!= 2357352929951744.00
[    7,  1735] 2427721674129408.00 =!= 2726788836884480.00
[    8,  4351] 2709196650840064.00 =!= 3096224743817216.00
[    9,  1445] 2937895069417472.00 =!= 3448068464705536.00
[ 1277,  1755] 400820366835974144.00 =!= 457115362178105344.00
[   11,  3698] 3588805953060864.00 =!= 4081387162304512.00
[ 2989,  1748] 950259521375174656.00 =!= 1076360310941548544.00
[   13,  3337] 4345269952970752.00 =!= 4925812092436480.00
[ 1727,  1405] 540431955284459520.00 =!= 616993148949757952.00
[ 1147,  2724] 362539770003324928.00 =!= 412079365904400384.00
[ 2665,  1565] 810647932926689280.00 =!= 945755921747804160.00
[   17,  1903] 5559130790035456.00 =!= 6298002603900928.00
[   18,  4190] 5805421394657280.00 =!= 6685030696878080.00
[ 1545,    19] 479633360314957824.00 =!= 553942754166571008.00
[ 3279,  3630] 1026820715040473088.00 =!= 1170935903116328960.00
[ 2742,  3813] 869194728082505728.00 =!= 990791918021509120.00
[ 1993,  1107] 621496748577128448.00 =!= 707065141497167872.00
[ 1413,    23] 436849163854938112.00 =!= 504403158265495552.00
[   24,  1546] 7705377487454208.00 =!= 8796093022208000.00
[ 1664,  1364] 511158557706551296.00 =!= 594475150812905472.00
[ 3131,  1639] 990791918021509120.00 =!= 1125899906842624000.00
[ 2485,    27] 779122735535095808.00 =!= 900719925474099200.00
[ 1943,    28] 616993148949757952.00 =!= 711568741124538368.00
[   29,  1893] 9429411719806976.00 =!= 10625680370827264.00
[   30,  3713] 9921992929050624.00 =!= 11188630324248576.00
[ 3204,  1819] 990791918021509120.00 =!= 1130403506469994496.00
[ 1757,  1305] 553942754166571008.00 =!= 626000348204498944.00
...and 967 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 73884us.
Avg NPU gflops: 1706

Min NPU matmul time: 73884us.
Max NPU gflops: 1706

Max NPU matmul time: 73884us.
Min NPU gflops: 1706

Error count: 999 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 256 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x256x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x256x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x256x256_32x32x32_8c.txt ../build/aie_4352x256x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x256x256_32x32x32_8c.xclbin -i build/insts_4352x256x256_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 256 -N 256 --b_col_maj 0

Avg NPU matmul time: 3064us.
Avg NPU gflops: 186.17

Min NPU matmul time: 3064us.
Max NPU gflops: 186.17

Max NPU matmul time: 3064us.
Min NPU gflops: 186.17

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 256 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x256x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x256x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x256x1280_32x32x32_8c.txt ../build/aie_4352x256x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x256x1280_32x32x32_8c.xclbin -i build/insts_4352x256x1280_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 256 -N 1280 --b_col_maj 0


Avg NPU matmul time: 5142us.
Avg NPU gflops: 554.673

Min NPU matmul time: 5142us.
Max NPU gflops: 554.673

Max NPU matmul time: 5142us.
Min NPU gflops: 554.673

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 256 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x256x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x256x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x256x2304_32x32x32_8c.txt ../build/aie_4352x256x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x256x2304_32x32x32_8c.xclbin -i build/insts_4352x256x2304_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 256 -N 2304 --b_col_maj 0


Avg NPU matmul time: 6199us.
Avg NPU gflops: 828.17

Min NPU matmul time: 6199us.
Max NPU gflops: 828.17

Max NPU matmul time: 6199us.
Min NPU gflops: 828.17

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 256 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x256x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x256x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x256x3328_32x32x32_8c.txt ../build/aie_4352x256x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x256x3328_32x32x32_8c.xclbin -i build/insts_4352x256x3328_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 256 -N 3328 --b_col_maj 0


Avg NPU matmul time: 6204us.
Avg NPU gflops: 1195.28

Min NPU matmul time: 6204us.
Max NPU gflops: 1195.28

Max NPU matmul time: 6204us.
Min NPU gflops: 1195.28

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 256 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x256x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x256x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x256x4352_32x32x32_8c.txt ../build/aie_4352x256x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x256x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x256x4352_32x32x32_8c.xclbin -i build/insts_4352x256x4352_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 256 -N 4352 --b_col_maj 0


Avg NPU matmul time: 8430us.
Avg NPU gflops: 1150.32

Min NPU matmul time: 8430us.
Max NPU gflops: 1150.32

Max NPU matmul time: 8430us.
Min NPU gflops: 1150.32

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 1280 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x1280x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x1280x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x1280x256_32x32x32_8c.txt ../build/aie_4352x1280x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x1280x256_32x32x32_8c.xclbin -i build/insts_4352x1280x256_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 1280 -N 256 --b_col_maj 0


Avg NPU matmul time: 5075us.
Avg NPU gflops: 561.995

Min NPU matmul time: 5075us.
Max NPU gflops: 561.995

Max NPU matmul time: 5075us.
Min NPU gflops: 561.995

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 1280 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x1280x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x1280x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x1280x1280_32x32x32_8c.txt ../build/aie_4352x1280x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x1280x1280_32x32x32_8c.xclbin -i build/insts_4352x1280x1280_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 1280 -N 1280 --b_col_maj 0


Avg NPU matmul time: 10782us.
Avg NPU gflops: 1322.63

Min NPU matmul time: 10782us.
Max NPU gflops: 1322.63

Max NPU matmul time: 10782us.
Min NPU gflops: 1322.63

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 1280 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x1280x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x1280x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x1280x2304_32x32x32_8c.txt ../build/aie_4352x1280x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x1280x2304_32x32x32_8c.xclbin -i build/insts_4352x1280x2304_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 1280 -N 2304 --b_col_maj 0


Avg NPU matmul time: 20315us.
Avg NPU gflops: 1263.56

Min NPU matmul time: 20315us.
Max NPU gflops: 1263.56

Max NPU matmul time: 20315us.
Min NPU gflops: 1263.56

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 1280 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x1280x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x1280x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x1280x3328_32x32x32_8c.txt ../build/aie_4352x1280x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x1280x3328_32x32x32_8c.xclbin -i build/insts_4352x1280x3328_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 1280 -N 3328 --b_col_maj 0


Avg NPU matmul time: 25700us.
Avg NPU gflops: 1442.71

Min NPU matmul time: 25700us.
Max NPU gflops: 1442.71

Max NPU matmul time: 25700us.
Min NPU gflops: 1442.71

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.2s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 1280 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x1280x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x1280x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x1280x4352_32x32x32_8c.txt ../build/aie_4352x1280x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x1280x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x1280x4352_32x32x32_8c.xclbin -i build/insts_4352x1280x4352_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 1280 -N 4352 --b_col_maj 0


Avg NPU matmul time: 31444us.
Avg NPU gflops: 1541.98

Min NPU matmul time: 31444us.
Max NPU gflops: 1541.98

Max NPU matmul time: 31444us.
Min NPU gflops: 1541.98

PASS!

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 2304 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x2304x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x2304x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x2304x256_32x32x32_8c.txt ../build/aie_4352x2304x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x2304x256_32x32x32_8c.xclbin -i build/insts_4352x2304x256_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 2304 -N 256 --b_col_maj 0

[ 3773,    24] 10977524091715584.00 =!= 12173792742735872.00
[  524,     0] 1504131906797568.00 =!= 1662461581197312.00
Maximum relative error:  10%

Avg NPU matmul time: 6154us.
Avg NPU gflops: 834

Min NPU matmul time: 6154us.
Max NPU gflops: 834

Max NPU matmul time: 6154us.
Min NPU gflops: 834

Error count: 2 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 2304 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x2304x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x2304x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x2304x1280_32x32x32_8c.txt ../build/aie_4352x2304x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x2304x1280_32x32x32_8c.xclbin -i build/insts_4352x2304x1280_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 2304 -N 1280 --b_col_maj 0

[ 1946,  1273] 27725285205999616.00 =!= 30680772461461504.00
Maximum relative error:  10%

Avg NPU matmul time: 19622us.
Avg NPU gflops: 1308

Min NPU matmul time: 19622us.
Max NPU gflops: 1308

Max NPU matmul time: 19622us.
Min NPU gflops: 1308

Error count: 1 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 2304 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x2304x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x2304x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x2304x2304_32x32x32_8c.txt ../build/aie_4352x2304x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x2304x2304_32x32x32_8c.xclbin -i build/insts_4352x2304x2304_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 2304 -N 2304 --b_col_maj 0

[  264,  2144] 6544293208522752.00 =!= 7247980650299392.00
[  406,  1749] 10344205394116608.00 =!= 11470105300959232.00
[ 1913,  1336] 49258120924364800.00 =!= 54606145481867264.00
[ 1832,   973] 47287796087390208.00 =!= 52354345668182016.00
Maximum relative error:  10%

Avg NPU matmul time: 34024us.
Avg NPU gflops: 1358

Min NPU matmul time: 34024us.
Max NPU gflops: 1358

Max NPU matmul time: 34024us.
Min NPU gflops: 1358

Error count: 4 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 2304 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x2304x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x2304x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x2304x3328_32x32x32_8c.txt ../build/aie_4352x2304x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x2304x3328_32x32x32_8c.xclbin -i build/insts_4352x2304x3328_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 2304 -N 3328 --b_col_maj 0

[ 2199,  1968] 79938893385826304.00 =!= 88383142687145984.00
[  679,   679] 25192010415603712.00 =!= 27866022694354944.00
Maximum relative error:  10%

Avg NPU matmul time: 41386us.
Avg NPU gflops: 1613

Min NPU matmul time: 41386us.
Max NPU gflops: 1613

Max NPU matmul time: 41386us.
Min NPU gflops: 1613

Error count: 2 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 2304 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x2304x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x2304x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x2304x4352_32x32x32_8c.txt ../build/aie_4352x2304x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x2304x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x2304x4352_32x32x32_8c.xclbin -i build/insts_4352x2304x4352_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 2304 -N 4352 --b_col_maj 0

[ 4147,    71] 200410183417987072.00 =!= 221802281647996928.00
[ 2203,   375] 105834591243206656.00 =!= 117093590311632896.00
[ 3738,  2168] 173388585653764096.00 =!= 192528884070088704.00
[ 2227,  3907] 105834591243206656.00 =!= 117093590311632896.00
Maximum relative error:  10%

Avg NPU matmul time: 54318us.
Avg NPU gflops: 1607

Min NPU matmul time: 54318us.
Max NPU gflops: 1607

Max NPU matmul time: 54318us.
Min NPU gflops: 1607

Error count: 4 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 3328 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x3328x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x3328x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x3328x256_32x32x32_8c.txt ../build/aie_4352x3328x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x3328x256_32x32x32_8c.xclbin -i build/insts_4352x3328x256_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 3328 -N 256 --b_col_maj 0

[ 2216,     1] 18718085951258624.00 =!= 20969885764943872.00
[ 2573,     3] 22236523160141824.00 =!= 24910535438893056.00
[ 4162,     4] 34902897112121344.00 =!= 39125021762781184.00
[ 4032,     5] 33214047251857408.00 =!= 37154696925806592.00
[    6,     6] 57174604644352.00 =!= 63496796504064.00
[    7,     7] 64321430224896.00 =!= 72018011619328.00
[ 3901,     8] 32510359810080768.00 =!= 36310271995674624.00
[    9,     9] 82463372083200.00 =!= 91809220919296.00
[ 1277,    10] 10907155347537920.00 =!= 12173792742735872.00
[   11,    11] 97306779058176.00 =!= 109401406963712.00
[ 3619,    12] 31102984926527488.00 =!= 34480684647055360.00
[ 4028,    13] 34621422135410688.00 =!= 38562071809359872.00
[ 1727,    14] 14636698788954112.00 =!= 16325548649218048.00
[ 1147,    15] 9781255440695296.00 =!= 10907155347537920.00
[ 2665,    16] 22658735625207808.00 =!= 25192010415603712.00
[ 4063,    17] 34199209670344704.00 =!= 37999121855938560.00
[   18,    18] 155031139516416.00 =!= 173722837188608.00
[ 1545,    19] 13018217672867840.00 =!= 14777436277309440.00
[ 3279,    20] 27162335252578304.00 =!= 30680772461461504.00
[ 2742,    21] 23221685578629120.00 =!= 25895697857380352.00
[ 1993,    22] 17029236090994688.00 =!= 18999560927969280.00
[ 4083,    23] 34480684647055360.00 =!= 38280596832649216.00
[ 3773,    24] 32791834786791424.00 =!= 36310271995674624.00
[ 1664,    25] 14355223812243456.00 =!= 15903336184152064.00
[ 3131,    26] 25332747903959040.00 =!= 28710447624486912.00
[ 2485,    27] 21251360741654528.00 =!= 23503160555339776.00
[ 1943,    28] 16607023625928704.00 =!= 18436610974547968.00
[ 4076,    29] 33776997205278720.00 =!= 37717646879227904.00
[ 3204,    31] 27303072740933632.00 =!= 30540034973106176.00
[ 1757,    32] 14777436277309440.00 =!= 16536654881751040.00
[ 3581,    33] 30680772461461504.00 =!= 34058472181989376.00
[   34,    34] 288072046477312.00 =!= 323256418566144.00
...and 782 further errors.
Maximum relative error:  12%

Avg NPU matmul time: 7099us.
Avg NPU gflops: 1045

Min NPU matmul time: 7099us.
Max NPU gflops: 1045

Max NPU matmul time: 7099us.
Min NPU gflops: 1045

Error count: 814 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 3328 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x3328x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x3328x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x3328x1280_32x32x32_8c.txt ../build/aie_4352x3328x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x3328x1280_32x32x32_8c.xclbin -i build/insts_4352x3328x1280_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 3328 -N 1280 --b_col_maj 0

[ 2216,     1] 92323792361095168.00 =!= 103019841476100096.00
[ 1902,     2] 79375943432404992.00 =!= 89509042593988608.00
[ 2573,  1215] 110901140823998464.00 =!= 122723089845846016.00
[ 4162,     4] 176766285374291968.00 =!= 197032483697459200.00
[ 4032,     5] 166633186212708352.00 =!= 186899384535875584.00
[    6,     6] 280375465082880.00 =!= 312261302288384.00
[ 3901,     8] 165507286305865728.00 =!= 183521684815347712.00
[    9,     9] 406819302277120.00 =!= 452998790643712.00
[ 1277,    10] 54887620458577920.00 =!= 60798594969501696.00
[   11,    11] 501377302265856.00 =!= 556352883654656.00
[ 3619,    12] 150870587516911616.00 =!= 168884986026393600.00
[ 4028,    13] 170010885933236224.00 =!= 190277084256403456.00
[ 1727,    14] 74309393851613184.00 =!= 82190693199511552.00
[ 1147,    15] 48132221017522176.00 =!= 53480245575024640.00
[ 4063,    17] 173388585653764096.00 =!= 193654783976931328.00
[   18,    18] 787250325487616.00 =!= 879609302220800.00
[ 1545,    19] 65865144550293504.00 =!= 73183493944770560.00
[ 2742,    21] 116530640358211584.00 =!= 130604389193744384.00
[ 4083,    23] 170010885933236224.00 =!= 190277084256403456.00
[ 3773,    24] 159877786771652608.00 =!= 179018085187977216.00
[ 3131,    26] 132293239054008320.00 =!= 147492887796383744.00
[ 2485,  1253] 104708691336364032.00 =!= 117656540265054208.00
[ 1943,    28] 79938893385826304.00 =!= 90071992547409920.00
[   30,    30] 1275433488220160.00 =!= 1416170976575488.00
[ 3204,    31] 136233888727957504.00 =!= 151996487423754240.00
[ 1757,  1213] 74872343805034496.00 =!= 83879543059775488.00
[   34,    34] 1477743627730944.00 =!= 1653665488175104.00
[   35,    35] 1512927999819776.00 =!= 1688849860263936.00
[   36,  1092] 1548112371908608.00 =!= 1715238139330560.00
[ 3733,    37] 157625986957967360.00 =!= 175640385467449344.00
[ 2268,    38] 94575592174780416.00 =!= 106397541196627968.00
[ 3821,    42] 161003686678495232.00 =!= 180143985094819840.00
...and 748 further errors.
Maximum relative error:  13%

Avg NPU matmul time: 26555us.
Avg NPU gflops: 1396

Min NPU matmul time: 26555us.
Max NPU gflops: 1396

Max NPU matmul time: 26555us.
Min NPU gflops: 1396

Error count: 780 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 3328 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x3328x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x3328x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x3328x2304_32x32x32_8c.txt ../build/aie_4352x3328x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x3328x2304_32x32x32_8c.xclbin -i build/insts_4352x3328x2304_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 3328 -N 2304 --b_col_maj 0

[ 2216,  1615] 170010885933236224.00 =!= 190277084256403456.00
[ 1902,  1733] 146366987889541120.00 =!= 163255486492180480.00
[ 2573,  1215] 197032483697459200.00 =!= 219550481834311680.00
[ 4162,     4] 306244774661193728.00 =!= 349028971121213440.00
[ 4032,     5] 306244774661193728.00 =!= 340021771866472448.00
[    9,  1700] 747667906887680.00 =!= 826832744087552.00
[   11,  1328] 905997581287424.00 =!= 1007152651042816.00
[ 3619,  1312] 272467777455915008.00 =!= 303992974847508480.00
[ 4028,    13] 308496574474878976.00 =!= 342273571680157696.00
[ 1727,    14] 133419138960850944.00 =!= 148618787703226368.00
[ 1147,    15] 87257242780303360.00 =!= 98516241848729600.00
[ 2665,    16] 201536083324829696.00 =!= 224054081461682176.00
[   18,    18] 1424967069597696.00 =!= 1583296743997440.00
[ 1545,    19] 118782440171896832.00 =!= 131730289100587008.00
[ 2742,    21] 210543282579570688.00 =!= 233061280716423168.00
[ 1993,    22] 153122387330596864.00 =!= 171136785840078848.00
[ 4083,    23] 306244774661193728.00 =!= 346777171307528192.00
[ 3773,    24] 288230376151711744.00 =!= 319755573543305216.00
[ 1664,  1329] 125537839612952576.00 =!= 140174538401906688.00
[ 3131,    26] 238690780250636288.00 =!= 265712378014859264.00
[ 1943,    28] 150870587516911616.00 =!= 167759086119550976.00
[ 4076,  2030] 308496574474878976.00 =!= 346777171307528192.00
[ 3204,    31] 246572079598534656.00 =!= 274719577269600256.00
[ 3581,  1865] 278097276990128128.00 =!= 308496574474878976.00
[   34,  2014] 2603643534573568.00 =!= 2920302883373056.00
[   36,  2169] 2797157581062144.00 =!= 3149001301950464.00
[ 2268,    38] 174514485560606720.00 =!= 193654783976931328.00
[ 4231,    39] 324259173170675712.00 =!= 360287970189639680.00
[ 1790,  1320] 139048638495064064.00 =!= 154248287237439488.00
[ 4208,  1638] 331014572611731456.00 =!= 369295169444380672.00
[ 3821,    42] 292733975779082240.00 =!= 324259173170675712.00
[   44,  2268] 3324923162394624.00 =!= 3711951255371776.00
...and 762 further errors.
Maximum relative error:  13%

Avg NPU matmul time: 40927us.
Avg NPU gflops: 1631

Min NPU matmul time: 40927us.
Max NPU gflops: 1631

Max NPU matmul time: 40927us.
Min NPU gflops: 1631

Error count: 794 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 3328 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x3328x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x3328x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x3328x3328_32x32x32_8c.txt ../build/aie_4352x3328x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x3328x3328_32x32x32_8c.xclbin -i build/insts_4352x3328x3328_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 3328 -N 3328 --b_col_maj 0

[ 2216,  2384] 245446179691692032.00 =!= 272467777455915008.00
[ 1902,  1733] 206039682952200192.00 =!= 229683580995895296.00
[ 2573,  2672] 290482175965396992.00 =!= 322007373356990464.00
[ 4162,     4] 457115362178105344.00 =!= 511158557706551296.00
[ 4032,     5] 441352763482308608.00 =!= 490892359383384064.00
[    6,  3327] 734473767354368.00 =!= 818036651065344.00
[    7,     7] 848822976643072.00 =!= 941181953376256.00
[ 3901,  2674] 434597364041252864.00 =!= 481885160128643072.00
[ 1277,    10] 142426338215591936.00 =!= 157625986957967360.00
[   11,  1328] 1284229581242368.00 =!= 1433763162619904.00
[ 3619,  1312] 394064967394918400.00 =!= 439100963668623360.00
[ 4028,  3166] 434597364041252864.00 =!= 484136959942328320.00
[ 1727,  2606] 190277084256403456.00 =!= 211669182486413312.00
[ 1147,  2789] 126663739519795200.00 =!= 140174538401906688.00
[ 2665,    16] 287104476244869120.00 =!= 319755573543305216.00
[   18,    18] 2023101395107840.00 =!= 2269391999729664.00
[ 1545,    19] 172262685746921472.00 =!= 191402984163246080.00
[ 3279,  1230] 360287970189639680.00 =!= 405323966463344640.00
[ 2742,  2689] 297237575406452736.00 =!= 333266372425416704.00
[ 1993,    22] 215046882206941184.00 =!= 240942580064321536.00
[ 1664,  2806] 182395784908505088.00 =!= 203787883138514944.00
[ 3131,    26] 344525371493842944.00 =!= 385057768140177408.00
[ 2485,  1289] 275845477176442880.00 =!= 306244774661193728.00
[ 1943,  2792] 208291482765885440.00 =!= 233061280716423168.00
[ 4076,  2030] 432345564227567616.00 =!= 490892359383384064.00
[   30,    30] 3395291906572288.00 =!= 3764727813505024.00
[ 3204,    31] 351280770934898688.00 =!= 394064967394918400.00
[ 1757,  1377] 192528884070088704.00 =!= 213920982300098560.00
[ 3581,  1865] 398568567022288896.00 =!= 443604563295993856.00
[   34,  2014] 3923057487904768.00 =!= 4362862139015168.00
[ 2268,    38] 252201579132747776.00 =!= 281474976710656000.00
[ 4231,  2772] 463870761619161088.00 =!= 515662157333921792.00
...and 774 further errors.
Maximum relative error:  12%

Avg NPU matmul time: 58760us.
Avg NPU gflops: 1641

Min NPU matmul time: 58760us.
Max NPU gflops: 1641

Max NPU matmul time: 58760us.
Min NPU gflops: 1641

Error count: 806 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 3328 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x3328x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x3328x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x3328x4352_32x32x32_8c.txt ../build/aie_4352x3328x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x3328x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x3328x4352_32x32x32_8c.xclbin -i build/insts_4352x3328x4352_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 3328 -N 4352 --b_col_maj 0

[ 2216,  2384] 317503773729619968.00 =!= 353532570748583936.00
[ 1902,  1733] 275845477176442880.00 =!= 306244774661193728.00
[ 2573,  3394] 367043369630695424.00 =!= 412079365904400384.00
[ 4162,     4] 598978750440275968.00 =!= 666532744850833408.00
[ 4032,     5] 585467951558164480.00 =!= 657525545596092416.00
[    6,  3327] 971968278953984.00 =!= 1090715534753792.00
[    7,  4273] 1125899906842624.00 =!= 1249045209153536.00
[ 3901,  2674] 576460752303423488.00 =!= 639511147086610432.00
[    9,  2313] 1345802232397824.00 =!= 1504131906797568.00
[ 1277,  3751] 186899384535875584.00 =!= 207165582859042816.00
[   11,  1328] 1671257674219520.00 =!= 1864771720708096.00
[ 3619,  4095] 529172956216033280.00 =!= 585467951558164480.00
[ 4028,  3166] 580964351930793984.00 =!= 648518346341351424.00
[ 1727,  2606] 251075679225905152.00 =!= 278097276990128128.00
[ 1147,  3463] 162129586585337856.00 =!= 181269885001662464.00
[ 1545,    19] 220676381741154304.00 =!= 247697979505377280.00
[ 3279,  1230] 468374361246531584.00 =!= 526921156402348032.00
[ 2742,  2689] 385057768140177408.00 =!= 434597364041252864.00
[ 1993,    22] 288230376151711744.00 =!= 319755573543305216.00
[ 4083,  3806] 594475150812905472.00 =!= 657525545596092416.00
[ 1664,  2806] 239816680157478912.00 =!= 266838277921701888.00
[ 3131,    26] 445856363109679104.00 =!= 497647758824439808.00
[ 2485,  1289] 358036170375954432.00 =!= 398568567022288896.00
[ 1943,  2792] 282600876617498624.00 =!= 313000174102249472.00
[ 4076,  3922] 580964351930793984.00 =!= 653021945968721920.00
[ 3204,    31] 457115362178105344.00 =!= 511158557706551296.00
[ 1757,  1377] 252201579132747776.00 =!= 281474976710656000.00
[ 3581,  1865] 520165756961292288.00 =!= 580964351930793984.00
[   34,  2014] 4960996464525312.00 =!= 5523946417946624.00
[   35,  1823] 5207287069147136.00 =!= 5805421394657280.00
[   36,  2169] 5242471441235968.00 =!= 5840605766746112.00
[ 2268,    38] 324259173170675712.00 =!= 367043369630695424.00
...and 758 further errors.
Maximum relative error:  13%

Avg NPU matmul time: 74082us.
Avg NPU gflops: 1702

Min NPU matmul time: 74082us.
Max NPU gflops: 1702

Max NPU matmul time: 74082us.
Min NPU gflops: 1702

Error count: 790 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 4352 -N 256 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x4352x256_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x4352x256_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x4352x256_32x32x32_8c.txt ../build/aie_4352x4352x256_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x256_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x256_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x256_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x4352x256_32x32x32_8c.xclbin -i build/insts_4352x4352x256_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 4352 -N 256 --b_col_maj 0

[    0,     0] 12506944765952.00 =!= 14156212207616.00
[ 2216,     1] 40813871623045120.00 =!= 46724846133968896.00
[ 1902,     2] 36028797018963968.00 =!= 40532396646334464.00
[ 2573,     3] 47569271064100864.00 =!= 55450570411999232.00
[ 4162,     4] 77687093572141056.00 =!= 88383142687145984.00
[ 4032,     5] 73746443898191872.00 =!= 83879543059775488.00
[    6,     6] 124244813938688.00 =!= 141836999983104.00
[    7,     7] 144036023238656.00 =!= 161628209283072.00
[ 3901,     8] 72057594037927936.00 =!= 81627743246090240.00
[    9,     9] 173722837188608.00 =!= 203409651138560.00
[ 1277,    10] 23362423066984448.00 =!= 27303072740933632.00
[   11,    11] 218802813927424.00 =!= 247390116249600.00
[ 3619,    12] 68398419340689408.00 =!= 77124143618719744.00
[ 4028,    13] 77124143618719744.00 =!= 86694292826882048.00
[ 1727,    14] 32088147345014784.00 =!= 36591746972385280.00
[ 1147,    15] 20829148276588544.00 =!= 23784635532050432.00
[ 2665,    16] 47850746040811520.00 =!= 56294995342131200.00
[ 4063,    17] 75435293758455808.00 =!= 86694292826882048.00
[   18,    18] 343047627866112.00 =!= 391426139488256.00
[ 1545,    19] 28006760182710272.00 =!= 32651097298436096.00
[ 3279,    20] 61643019899633664.00 =!= 70087269200953344.00
[ 2742,    21] 50946970784628736.00 =!= 57983845202395136.00
[ 1993,    22] 37154696925806592.00 =!= 42502721483309056.00
[ 4083,    23] 75435293758455808.00 =!= 85568392920039424.00
[ 3773,    24] 71213169107795968.00 =!= 81064793292668928.00
[ 1664,    25] 31384459903238144.00 =!= 36028797018963968.00
[ 3131,    26] 57420895248973824.00 =!= 64739244643450880.00
[ 2485,    27] 44754521296994304.00 =!= 51791395714760704.00
[ 1943,    28] 36028797018963968.00 =!= 41095346599755776.00
[ 4076,    29] 74309393851613184.00 =!= 83879543059775488.00
[   30,    30] 567347999932416.00 =!= 646512837132288.00
[ 3204,    31] 58828270132527104.00 =!= 67835469387268096.00
...and 968 further errors.
Maximum relative error:  15%

Avg NPU matmul time: 8664us.
Avg NPU gflops: 1119

Min NPU matmul time: 8664us.
Max NPU gflops: 1119

Max NPU matmul time: 8664us.
Min NPU gflops: 1119

Error count: 1000 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 4352 -N 1280 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x4352x1280_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x4352x1280_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x4352x1280_32x32x32_8c.txt ../build/aie_4352x4352x1280_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x1280_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x4352x1280_32x32x32_8c.xclbin -i build/insts_4352x4352x1280_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 4352 -N 1280 --b_col_maj 0

[    0,     0] 64871186038784.00 =!= 72018011619328.00
[ 2216,     1] 200410183417987072.00 =!= 233061280716423168.00
[ 1902,     2] 170010885933236224.00 =!= 198158383604301824.00
[ 2573,  1215] 234187180623265792.00 =!= 270215977642229760.00
[ 4162,     4] 385057768140177408.00 =!= 443604563295993856.00
[ 4032,     5] 364791569817010176.00 =!= 418834765345456128.00
[    6,     6] 624522604576768.00 =!= 712483534798848.00
[    7,     7] 703687441776640.00 =!= 813638604554240.00
[ 3901,     8] 367043369630695424.00 =!= 416582965531770880.00
[    9,     9] 892803441754112.00 =!= 1015948744065024.00
[ 1277,    10] 119908340078739456.00 =!= 136796838681378816.00
[   11,    11] 1059929209176064.00 =!= 1213860837064704.00
[ 3619,    12] 333266372425416704.00 =!= 380554168512806912.00
[ 4028,    13] 367043369630695424.00 =!= 421086565159141376.00
[ 1727,    14] 159877786771652608.00 =!= 182395784908505088.00
[ 1147,    15] 105834591243206656.00 =!= 121597189939003392.00
[ 2665,    16] 245446179691692032.00 =!= 280349076803813376.00
[ 4063,    17] 373798769071751168.00 =!= 434597364041252864.00
[   18,    18] 1759218604441600.00 =!= 1979120929996800.00
[ 1545,    19] 144115188075855872.00 =!= 163255486492180480.00
[ 3279,  1230] 306244774661193728.00 =!= 344525371493842944.00
[ 2742,    21] 255579278853275648.00 =!= 294985775592767488.00
[ 1993,    22] 183521684815347712.00 =!= 210543282579570688.00
[ 4083,    23] 373798769071751168.00 =!= 436849163854938112.00
[ 3773,    24] 349028971121213440.00 =!= 403072166649659392.00
[ 1664,    25] 153122387330596864.00 =!= 174514485560606720.00
[ 3131,    26] 287104476244869120.00 =!= 328762772798046208.00
[ 2485,  1253] 231935380809580544.00 =!= 265712378014859264.00
[ 1943,    28] 176766285374291968.00 =!= 202661983231672320.00
[ 4076,  1019] 373798769071751168.00 =!= 430093764413882368.00
[   30,    30] 2761973208973312.00 =!= 3236962232172544.00
[ 3204,    31] 297237575406452736.00 =!= 337769972052787200.00
...and 968 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 31368us.
Avg NPU gflops: 1546

Min NPU matmul time: 31368us.
Max NPU gflops: 1546

Max NPU matmul time: 31368us.
Min NPU gflops: 1546

Error count: 1000 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 4352 -N 2304 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x4352x2304_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x4352x2304_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x4352x2304_32x32x32_8c.txt ../build/aie_4352x4352x2304_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x2304_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x4352x2304_32x32x32_8c.xclbin -i build/insts_4352x4352x2304_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 4352 -N 2304 --b_col_maj 0

[    0,  1594] 113799453474816.00 =!= 125894081380352.00
[ 2216,  1615] 367043369630695424.00 =!= 421086565159141376.00
[ 1902,  1733] 319755573543305216.00 =!= 362539770003324928.00
[ 2573,  1215] 416582965531770880.00 =!= 484136959942328320.00
[ 4162,     4] 689050742987685888.00 =!= 788129934789836800.00
[ 4032,     5] 662029145223462912.00 =!= 756604737398243328.00
[    6,     6] 1108307720798208.00 =!= 1257841302175744.00
[    7,     7] 1284229581242368.00 =!= 1468947534708736.00
[ 3901,     8] 653021945968721920.00 =!= 743093938516131840.00
[    9,  1700] 1618481116086272.00 =!= 1855975627685888.00
[ 1277,    10] 212795082393255936.00 =!= 243194379878006784.00
[   11,  1328] 1970324836974592.00 =!= 2251799813685248.00
[ 3619,  1312] 598978750440275968.00 =!= 680043543732944896.00
[ 4028,    13] 666532744850833408.00 =!= 765611936652984320.00
[ 1727,    14] 292733975779082240.00 =!= 328762772798046208.00
[ 1147,    15] 188025284442718208.00 =!= 219550481834311680.00
[ 2665,    16] 445856363109679104.00 =!= 508906757892866048.00
[ 4063,    17] 671036344478203904.00 =!= 774619135907725312.00
[   18,    18] 3078632557772800.00 =!= 3588805953060864.00
[ 1545,    19] 254453378946433024.00 =!= 290482175965396992.00
[ 3279,  1230] 540431955284459520.00 =!= 616993148949757952.00
[ 2742,    21] 459367161991790592.00 =!= 524669356588662784.00
[ 1993,    22] 335518172239101952.00 =!= 380554168512806912.00
[ 4083,    23] 666532744850833408.00 =!= 770115536280354816.00
[ 3773,    24] 621496748577128448.00 =!= 716072340751908864.00
[ 1664,  1329] 281474976710656000.00 =!= 317503773729619968.00
[ 3131,    26] 515662157333921792.00 =!= 594475150812905472.00
[ 2485,  1289] 394064967394918400.00 =!= 459367161991790592.00
[ 1943,    28] 331014572611731456.00 =!= 376050568885436416.00
[ 4076,  2030] 662029145223462912.00 =!= 770115536280354816.00
[   30,    30] 5136918324969472.00 =!= 5805421394657280.00
[ 3204,    31] 538180155470774272.00 =!= 612489549322387456.00
...and 968 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 51646us.
Avg NPU gflops: 1690

Min NPU matmul time: 51646us.
Max NPU gflops: 1690

Max NPU matmul time: 51646us.
Min NPU gflops: 1690

Error count: 1000 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 4352 -N 3328 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x4352x3328_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x4352x3328_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x4352x3328_32x32x32_8c.txt ../build/aie_4352x4352x3328_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x3328_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x4352x3328_32x32x32_8c.xclbin -i build/insts_4352x4352x3328_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 4352 -N 3328 --b_col_maj 0

[ 2216,  2384] 538180155470774272.00 =!= 607985949695016960.00
[ 1902,  1733] 441352763482308608.00 =!= 517913957147607040.00
[ 2573,  2672] 630503947831869440.00 =!= 711568741124538368.00
[ 4162,     4] 1008806316530991104.00 =!= 1139410705724735488.00
[ 4032,     5] 995295517648879616.00 =!= 1112389107960512512.00
[    6,  3327] 1583296743997440.00 =!= 1829587348619264.00
[    7,     7] 1855975627685888.00 =!= 2111062325329920.00
[ 3901,  2674] 941252322120433664.00 =!= 1076360310941548544.00
[    9,  2313] 2374945115996160.00 =!= 2691604464795648.00
[ 1277,    10] 313000174102249472.00 =!= 355784370562269184.00
[   11,  1328] 2761973208973312.00 =!= 3219370046128128.00
[ 3619,  1312] 855683929200394240.00 =!= 977281119139397632.00
[ 4028,  3166] 959266720629915648.00 =!= 1089871109823660032.00
[ 1727,  2606] 407575766277029888.00 =!= 466122561432846336.00
[ 1147,  2789] 273593677362757632.00 =!= 313000174102249472.00
[ 2665,    16] 630503947831869440.00 =!= 725079540006649856.00
[ 4063,    17] 972777519512027136.00 =!= 1130403506469994496.00
[   18,    18] 4450823069237248.00 =!= 5066549580791808.00
[ 1545,    19] 362539770003324928.00 =!= 425590164786511872.00
[ 3279,  1230] 779122735535095808.00 =!= 891712726219358208.00
[ 2742,  2689] 666532744850833408.00 =!= 747597538143502336.00
[ 1993,    22] 477381560501272576.00 =!= 540431955284459520.00
[ 4083,    23] 981784718766768128.00 =!= 1130403506469994496.00
[ 3773,    24] 896216325846728704.00 =!= 1026820715040473088.00
[ 1664,  2806] 389561367767547904.00 =!= 452611762550734848.00
[ 3131,    26] 761108337025613824.00 =!= 860187528827764736.00
[ 2485,  1289] 612489549322387456.00 =!= 684547143360315392.00
[ 1943,  2792] 459367161991790592.00 =!= 529172956216033280.00
[ 4076,  2030] 963770320257286144.00 =!= 1112389107960512512.00
[   30,    30] 7459086882832384.00 =!= 8444249301319680.00
[ 3204,    31] 756604737398243328.00 =!= 864691128455135232.00
[ 1757,  1377] 407575766277029888.00 =!= 475129760687587328.00
...and 967 further errors.
Maximum relative error:  16%

Avg NPU matmul time: 72121us.
Avg NPU gflops: 1748

Min NPU matmul time: 72121us.
Max NPU gflops: 1748

Max NPU matmul time: 72121us.
Min NPU gflops: 1748

Error count: 999 (out of 1000 random samples)


Failed.

rm -rf tmpTrace parse*.json trace*json trace.txt
rm -rf build _build whole_array.exe
rm -rf _build
mkdir -p _build
cd _build &&  cmake -E env CXXFLAGS="-std=c++23 -ggdb -DDTYPE_IN=std::bfloat16_t -DDTYPE_OUT=std::bfloat16_t -DDTYPE_ACC=float" \
	cmake `echo /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/..` -D CMAKE_C_COMPILER=gcc-13 -D CMAKE_CXX_COMPILER=g++-13 -DTARGET_NAME=whole_array -Dsubdir=whole_array
-- The C compiler identification is GNU 13.3.0
-- The CXX compiler identification is GNU 13.3.0
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/gcc-13 - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++-13 - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.3s)
-- Generating done (0.0s)
-- Build files have been written to: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build
cd _build &&  cmake --build . --config Release
gmake[1]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[2]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[3]: Entering directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[ 33%] Building CXX object CMakeFiles/whole_array.dir/scratch/luisr/mlir-aie/runtime_lib/test_lib/test_utils.cpp.o
[ 66%] Building CXX object CMakeFiles/whole_array.dir/whole_array/test.cpp.o
[100%] Linking CXX executable whole_array
gmake[3]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
[100%] Built target whole_array
gmake[2]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
gmake[1]: Leaving directory '/scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/_build'
cp _build/whole_array whole_array.exe 
mkdir -p build
python3 /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/whole_array.py -m 32 -k 32 -n 32 --n-aie-cols 8 --b-col-maj 0 --dev npu2 -M 4352 -K 4352 -N 4352 --dtype_in bf16 --dtype_out bf16 --emulate-bf16-mmul-with-bfp16 true --trace_size 0 > build/aie_4352x4352x4352_32x32x32_8c.mlir
mkdir -p build
cd build && /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie/bin/clang++ -O2 -std=c++20 --target=aie2p-none-unknown-elf -Wno-parentheses -Wno-attributes -Wno-macro-redefined -Wno-empty-body -DNDEBUG -I /scratch/luisr/mlir-aie/install/include  -Dbf16_bf16_ONLY -DDIM_M=32 -DDIM_K=32 -DDIM_N=32 -DAIE_API_EMULATE_BFLOAT16_MMUL_WITH_BFP16 -c /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/../../../../aie_kernels/aie2p/mm.cc -o mm_32x32x32.o
mkdir -p build
cd build && aiecc.py --alloc-scheme=basic-sequential --aie-generate-xclbin --no-compile-host --xclbin-name=final_4352x4352x4352_32x32x32_8c.xclbin \
			--no-xchesscc --no-xbridge --peano /scratch/luisr/mlir-aie/ironenv/lib/python3.12/site-packages/llvm-aie \
			--aie-generate-npu-insts --npu-insts-name=insts_4352x4352x4352_32x32x32_8c.txt ../build/aie_4352x4352x4352_32x32x32_8c.mlir

Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_elfs.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_init.bin
Generating: /scratch/luisr/mlir-aie/programming_examples/basic/matrix_multiplication/whole_array/build/aie_4352x4352x4352_32x32x32_8c.mlir.prj/aie_cdo_enable.bin
export XRT_HACK_UNSECURE_LOADING_XCLBIN=1 && \
 ./whole_array.exe -x build/final_4352x4352x4352_32x32x32_8c.xclbin -i build/insts_4352x4352x4352_32x32x32_8c.txt -k MLIR_AIE -M 4352 -K 4352 -N 4352 --b_col_maj 0

[    0,  1594] 213305255788544.00 =!= 237494511599616.00
[ 2216,  2384] 675539944105574400.00 =!= 779122735535095808.00
[ 1902,  1733] 598978750440275968.00 =!= 680043543732944896.00
[ 2573,  3394] 797137134044577792.00 =!= 918734323983581184.00
[ 4162,     4] 1288029493427961856.00 =!= 1486187877032263680.00
[ 4032,     5] 1279022294173220864.00 =!= 1459166279268040704.00
[    6,  3327] 2146246697418752.00 =!= 2427721674129408.00
[    7,  4273] 2445313860173824.00 =!= 2744381022928896.00
[ 3901,  2674] 1242993497154256896.00 =!= 1423137482249076736.00
[    9,  2313] 2937895069417472.00 =!= 3395291906572288.00
[ 1277,  3751] 396316767208603648.00 =!= 457115362178105344.00
[   11,  1328] 3711951255371776.00 =!= 4204532464615424.00
[ 3619,  4095] 1143914305352105984.00 =!= 1288029493427961856.00
[ 4028,  3166] 1270015094918479872.00 =!= 1432144681503817728.00
[ 1727,  2606] 553942754166571008.00 =!= 626000348204498944.00
[ 1147,  3463] 353532570748583936.00 =!= 409827566090715136.00
[ 2665,    16] 824158731808800768.00 =!= 945755921747804160.00
[ 4063,    17] 1279022294173220864.00 =!= 1459166279268040704.00
[   18,    18] 5840605766746112.00 =!= 6755399441055744.00
[ 1545,    19] 479633360314957824.00 =!= 553942754166571008.00
[ 3279,  1230] 1035827914295214080.00 =!= 1170935903116328960.00
[ 2742,  2689] 855683929200394240.00 =!= 977281119139397632.00
[ 1993,    22] 635007547459239936.00 =!= 716072340751908864.00
[ 4083,  3806] 1297036692682702848.00 =!= 1468173478522781696.00
[ 3773,  4008] 1188950301625810944.00 =!= 1360087087465889792.00
[ 1664,  2806] 524669356588662784.00 =!= 598978750440275968.00
[ 3131,    26] 995295517648879616.00 =!= 1121396307215253504.00
[ 2485,  1289] 779122735535095808.00 =!= 900719925474099200.00
[ 1943,  2792] 607985949695016960.00 =!= 698057942242426880.00
[ 4076,  3922] 1261007895663738880.00 =!= 1450159080013299712.00
[   30,    30] 9781255440695296.00 =!= 11118261580070912.00
[ 3204,    31] 977281119139397632.00 =!= 1125899906842624000.00
...and 968 further errors.
Maximum relative error:  15%

Avg NPU matmul time: 122364us.
Avg NPU gflops: 1347

Min NPU matmul time: 122364us.
Max NPU gflops: 1347

Max NPU matmul time: 122364us.
Min NPU gflops: 1347

Error count: 1000 (out of 1000 random samples)


Failed.

